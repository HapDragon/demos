define(["exports","./buildModuleUrl-9a89655b","./Cartesian2-99e64452","./Cartesian4-69ef58e5","./Cartographic-00721f3e","./Check-7b2a090c","./when-b60132fc","./EllipsoidTangentPlane-d397ceb5","./Math-119be1a3","./Plane-622eaee2"],(function(a,t,e,n,r,i,s,o,C,c){"use strict";function u(a,t){this.center=n.Cartesian3.clone(s.defaultValue(a,n.Cartesian3.ZERO)),this.halfAxes=e.Matrix3.clone(s.defaultValue(t,e.Matrix3.ZERO))}u.packedLength=n.Cartesian3.packedLength+e.Matrix3.packedLength,u.pack=function(a,t,r){return r=s.defaultValue(r,0),n.Cartesian3.pack(a.center,t,r),e.Matrix3.pack(a.halfAxes,t,r+n.Cartesian3.packedLength),t},u.unpack=function(a,t,r){return t=s.defaultValue(t,0),s.defined(r)||(r=new u),n.Cartesian3.unpack(a,t,r.center),e.Matrix3.unpack(a,t+n.Cartesian3.packedLength,r.halfAxes),r};var l=new n.Cartesian3,d=new n.Cartesian3,h=new n.Cartesian3,x=new n.Cartesian3,M=new n.Cartesian3,m=new n.Cartesian3,f=new e.Matrix3,p={unitary:new e.Matrix3,diagonal:new e.Matrix3};u.fromPoints=function(a,t){if(s.defined(t)||(t=new u),!s.defined(a)||0===a.length)return t.halfAxes=e.Matrix3.ZERO,t.center=n.Cartesian3.ZERO,t;var r,i=a.length,o=n.Cartesian3.clone(a[0],l);for(r=1;r<i;r++)n.Cartesian3.add(o,a[r],o);var C=1/i;n.Cartesian3.multiplyByScalar(o,C,o);var c,g=0,w=0,y=0,b=0,O=0,P=0;for(r=0;r<i;r++)g+=(c=n.Cartesian3.subtract(a[r],o,d)).x*c.x,w+=c.x*c.y,y+=c.x*c.z,b+=c.y*c.y,O+=c.y*c.z,P+=c.z*c.z;g*=C,w*=C,y*=C,b*=C,O*=C,P*=C;var N=f;N[0]=g,N[1]=w,N[2]=y,N[3]=w,N[4]=b,N[5]=O,N[6]=y,N[7]=O,N[8]=P;var v=e.Matrix3.computeEigenDecomposition(N,p),A=e.Matrix3.clone(v.unitary,t.halfAxes),T=e.Matrix3.getColumn(A,0,x),R=e.Matrix3.getColumn(A,1,M),I=e.Matrix3.getColumn(A,2,m),E=-Number.MAX_VALUE,L=-Number.MAX_VALUE,z=-Number.MAX_VALUE,S=Number.MAX_VALUE,U=Number.MAX_VALUE,V=Number.MAX_VALUE;for(r=0;r<i;r++)c=a[r],E=Math.max(n.Cartesian3.dot(T,c),E),L=Math.max(n.Cartesian3.dot(R,c),L),z=Math.max(n.Cartesian3.dot(I,c),z),S=Math.min(n.Cartesian3.dot(T,c),S),U=Math.min(n.Cartesian3.dot(R,c),U),V=Math.min(n.Cartesian3.dot(I,c),V);T=n.Cartesian3.multiplyByScalar(T,.5*(S+E),T),R=n.Cartesian3.multiplyByScalar(R,.5*(U+L),R),I=n.Cartesian3.multiplyByScalar(I,.5*(V+z),I);var B=n.Cartesian3.add(T,R,t.center);n.Cartesian3.add(B,I,B);var _=h;return _.x=E-S,_.y=L-U,_.z=z-V,n.Cartesian3.multiplyByScalar(_,.5,_),e.Matrix3.multiplyByScale(t.halfAxes,_,t.halfAxes),t};var g=new n.Cartesian3,w=new n.Cartesian3;function y(a,t,r,i,o,C,c,l,d,h,x){s.defined(x)||(x=new u);var M=x.halfAxes;e.Matrix3.setColumn(M,0,t,M),e.Matrix3.setColumn(M,1,r,M),e.Matrix3.setColumn(M,2,i,M);var m=g;m.x=(o+C)/2,m.y=(c+l)/2,m.z=(d+h)/2;var f=w;f.x=(C-o)/2,f.y=(l-c)/2,f.z=(h-d)/2;var p=x.center;return m=e.Matrix3.multiplyByVector(M,m,m),n.Cartesian3.add(a,m,p),e.Matrix3.multiplyByScale(M,f,M),x}var b=new r.Cartographic,O=new n.Cartesian3,P=new r.Cartographic,N=new r.Cartographic,v=new r.Cartographic,A=new r.Cartographic,T=new r.Cartographic,R=new n.Cartesian3,I=new n.Cartesian3,E=new n.Cartesian3,L=new n.Cartesian3,z=new n.Cartesian3,S=new e.Cartesian2,U=new e.Cartesian2,V=new e.Cartesian2,B=new e.Cartesian2,_=new e.Cartesian2,k=new n.Cartesian3,W=new n.Cartesian3,D=new n.Cartesian3,q=new n.Cartesian3,X=new e.Cartesian2,j=new n.Cartesian3,Z=new n.Cartesian3,G=new n.Cartesian3,F=new c.Plane(n.Cartesian3.UNIT_X,0);u.fromRectangle=function(a,e,i,u,l){var d,h,x,M,m,f,p;if(e=s.defaultValue(e,0),i=s.defaultValue(i,0),u=s.defaultValue(u,t.Ellipsoid.WGS84),a.width<=C.CesiumMath.PI){var g=t.Rectangle.center(a,b),w=u.cartographicToCartesian(g,O),Y=new o.EllipsoidTangentPlane(w,u);p=Y.plane;var H=g.longitude,J=a.south<0&&a.north>0?0:g.latitude,K=r.Cartographic.fromRadians(H,a.north,i,P),Q=r.Cartographic.fromRadians(a.west,a.north,i,N),$=r.Cartographic.fromRadians(a.west,J,i,v),aa=r.Cartographic.fromRadians(a.west,a.south,i,A),ta=r.Cartographic.fromRadians(H,a.south,i,T),ea=u.cartographicToCartesian(K,R),na=u.cartographicToCartesian(Q,I),ra=u.cartographicToCartesian($,E),ia=u.cartographicToCartesian(aa,L),sa=u.cartographicToCartesian(ta,z),oa=Y.projectPointToNearestOnPlane(ea,S),Ca=Y.projectPointToNearestOnPlane(na,U),ca=Y.projectPointToNearestOnPlane(ra,V),ua=Y.projectPointToNearestOnPlane(ia,B),la=Y.projectPointToNearestOnPlane(sa,_);return h=-(d=Math.min(Ca.x,ca.x,ua.x)),M=Math.max(Ca.y,oa.y),x=Math.min(ua.y,la.y),Q.height=aa.height=e,na=u.cartographicToCartesian(Q,I),ia=u.cartographicToCartesian(aa,L),m=Math.min(c.Plane.getPointDistance(p,na),c.Plane.getPointDistance(p,ia)),f=i,y(Y.origin,Y.xAxis,Y.yAxis,Y.zAxis,d,h,x,M,m,f,l)}var da=a.south>0,ha=a.north<0,xa=da?a.south:ha?a.north:0,Ma=t.Rectangle.center(a,b).longitude,ma=n.Cartesian3.fromRadians(Ma,xa,i,u,k);ma.z=0;var fa=Math.abs(ma.x)<C.CesiumMath.EPSILON10&&Math.abs(ma.y)<C.CesiumMath.EPSILON10?n.Cartesian3.UNIT_X:n.Cartesian3.normalize(ma,W),pa=n.Cartesian3.UNIT_Z,ga=n.Cartesian3.cross(fa,pa,D);p=c.Plane.fromPointNormal(ma,fa,F);var wa=n.Cartesian3.fromRadians(Ma+C.CesiumMath.PI_OVER_TWO,xa,i,u,q);d=-(h=n.Cartesian3.dot(c.Plane.projectPointOntoPlane(p,wa,X),ga)),M=n.Cartesian3.fromRadians(0,a.north,ha?e:i,u,j).z,x=n.Cartesian3.fromRadians(0,a.south,da?e:i,u,Z).z;var ya=n.Cartesian3.fromRadians(a.east,xa,i,u,G);return y(ma,ga,pa,fa,d,h,x,M,m=c.Plane.getPointDistance(p,ya),f=0,l)},u.clone=function(a,t){if(s.defined(a))return s.defined(t)?(n.Cartesian3.clone(a.center,t.center),e.Matrix3.clone(a.halfAxes,t.halfAxes),t):new u(a.center,a.halfAxes)},u.intersectPlane=function(a,r){var i=a.center,s=r.normal,o=a.halfAxes,C=s.x,c=s.y,u=s.z,l=Math.abs(C*o[e.Matrix3.COLUMN0ROW0]+c*o[e.Matrix3.COLUMN0ROW1]+u*o[e.Matrix3.COLUMN0ROW2])+Math.abs(C*o[e.Matrix3.COLUMN1ROW0]+c*o[e.Matrix3.COLUMN1ROW1]+u*o[e.Matrix3.COLUMN1ROW2])+Math.abs(C*o[e.Matrix3.COLUMN2ROW0]+c*o[e.Matrix3.COLUMN2ROW1]+u*o[e.Matrix3.COLUMN2ROW2]),d=n.Cartesian3.dot(s,i)+r.distance;return d<=-l?t.Intersect.OUTSIDE:d>=l?t.Intersect.INSIDE:t.Intersect.INTERSECTING};var Y=new n.Cartesian3,H=new n.Cartesian3,J=new n.Cartesian3,K=new n.Cartesian3;u.distanceSquaredTo=function(a,t){var r=n.Cartesian3.subtract(t,a.center,g),i=a.halfAxes,s=e.Matrix3.getColumn(i,0,Y),o=e.Matrix3.getColumn(i,1,H),C=e.Matrix3.getColumn(i,2,J),c=n.Cartesian3.magnitude(s),u=n.Cartesian3.magnitude(o),l=n.Cartesian3.magnitude(C);n.Cartesian3.normalize(s,s),n.Cartesian3.normalize(o,o),n.Cartesian3.normalize(C,C);var d=K;d.x=n.Cartesian3.dot(r,s),d.y=n.Cartesian3.dot(r,o),d.z=n.Cartesian3.dot(r,C);var h,x=0;return d.x<-c?x+=(h=d.x+c)*h:d.x>c&&(x+=(h=d.x-c)*h),d.y<-u?x+=(h=d.y+u)*h:d.y>u&&(x+=(h=d.y-u)*h),d.z<-l?x+=(h=d.z+l)*h:d.z>l&&(x+=(h=d.z-l)*h),x};var Q=new n.Cartesian3,$=new n.Cartesian3;u.computePlaneDistances=function(a,r,i,o){s.defined(o)||(o=new t.Interval);var C=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,u=a.center,l=a.halfAxes,d=e.Matrix3.getColumn(l,0,Y),h=e.Matrix3.getColumn(l,1,H),x=e.Matrix3.getColumn(l,2,J),M=n.Cartesian3.add(d,h,Q);n.Cartesian3.add(M,x,M),n.Cartesian3.add(M,u,M);var m=n.Cartesian3.subtract(M,r,$),f=n.Cartesian3.dot(i,m);return C=Math.min(f,C),c=Math.max(f,c),n.Cartesian3.add(u,d,M),n.Cartesian3.add(M,h,M),n.Cartesian3.subtract(M,x,M),n.Cartesian3.subtract(M,r,m),f=n.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),n.Cartesian3.add(u,d,M),n.Cartesian3.subtract(M,h,M),n.Cartesian3.add(M,x,M),n.Cartesian3.subtract(M,r,m),f=n.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),n.Cartesian3.add(u,d,M),n.Cartesian3.subtract(M,h,M),n.Cartesian3.subtract(M,x,M),n.Cartesian3.subtract(M,r,m),f=n.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),n.Cartesian3.subtract(u,d,M),n.Cartesian3.add(M,h,M),n.Cartesian3.add(M,x,M),n.Cartesian3.subtract(M,r,m),f=n.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),n.Cartesian3.subtract(u,d,M),n.Cartesian3.add(M,h,M),n.Cartesian3.subtract(M,x,M),n.Cartesian3.subtract(M,r,m),f=n.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),n.Cartesian3.subtract(u,d,M),n.Cartesian3.subtract(M,h,M),n.Cartesian3.add(M,x,M),n.Cartesian3.subtract(M,r,m),f=n.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),n.Cartesian3.subtract(u,d,M),n.Cartesian3.subtract(M,h,M),n.Cartesian3.subtract(M,x,M),n.Cartesian3.subtract(M,r,m),f=n.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),o.start=C,o.stop=c,o};var aa=new t.BoundingSphere;u.isOccluded=function(a,e){var n=t.BoundingSphere.fromOrientedBoundingBox(a,aa);return!e.isBoundingSphereVisible(n)},u.prototype.intersectPlane=function(a){return u.intersectPlane(this,a)},u.prototype.distanceSquaredTo=function(a){return u.distanceSquaredTo(this,a)},u.prototype.computePlaneDistances=function(a,t,e){return u.computePlaneDistances(this,a,t,e)},u.prototype.isOccluded=function(a){return u.isOccluded(this,a)},u.equals=function(a,t){return a===t||s.defined(a)&&s.defined(t)&&n.Cartesian3.equals(a.center,t.center)&&e.Matrix3.equals(a.halfAxes,t.halfAxes)},u.prototype.clone=function(a){return u.clone(this,a)},u.prototype.equals=function(a){return u.equals(this,a)},a.OrientedBoundingBox=u}));
