define(["exports","./when-b60132fc","./Cartesian2-99e64452","./Cartesian4-69ef58e5","./Cartographic-00721f3e","./Check-7b2a090c","./buildModuleUrl-9a89655b","./WebGLConstants-aba9fc67","./Math-119be1a3","./FeatureDetection-ab6f364c"],(function(e,a,t,n,r,i,s,o,u,l){"use strict";function d(e,t,n,r){this.x=a.defaultValue(e,0),this.y=a.defaultValue(t,0),this.z=a.defaultValue(n,0),this.w=a.defaultValue(r,0)}var c=new n.Cartesian3;d.fromAxisAngle=function(e,t,r){var i=t/2,s=Math.sin(i),o=(c=n.Cartesian3.normalize(e,c)).x*s,u=c.y*s,l=c.z*s,f=Math.cos(i);return a.defined(r)?(r.x=o,r.y=u,r.z=l,r.w=f,r):new d(o,u,l,f)};var f=[1,2,0],h=new Array(3);d.fromRotationMatrix=function(e,n){var r,i,s,o,u,l=e[t.Matrix3.COLUMN0ROW0],c=e[t.Matrix3.COLUMN1ROW1],m=e[t.Matrix3.COLUMN2ROW2],p=l+c+m;if(p>0)u=.5*(r=Math.sqrt(p+1)),r=.5/r,i=(e[t.Matrix3.COLUMN1ROW2]-e[t.Matrix3.COLUMN2ROW1])*r,s=(e[t.Matrix3.COLUMN2ROW0]-e[t.Matrix3.COLUMN0ROW2])*r,o=(e[t.Matrix3.COLUMN0ROW1]-e[t.Matrix3.COLUMN1ROW0])*r;else{var y=0;c>l&&(y=1),m>l&&m>c&&(y=2);var w=f[y],C=f[w];r=Math.sqrt(e[t.Matrix3.getElementIndex(y,y)]-e[t.Matrix3.getElementIndex(w,w)]-e[t.Matrix3.getElementIndex(C,C)]+1);var x=h;x[y]=.5*r,r=.5/r,u=(e[t.Matrix3.getElementIndex(C,w)]-e[t.Matrix3.getElementIndex(w,C)])*r,x[w]=(e[t.Matrix3.getElementIndex(w,y)]+e[t.Matrix3.getElementIndex(y,w)])*r,x[C]=(e[t.Matrix3.getElementIndex(C,y)]+e[t.Matrix3.getElementIndex(y,C)])*r,i=-x[0],s=-x[1],o=-x[2]}return a.defined(n)?(n.x=i,n.y=s,n.z=o,n.w=u,n):new d(i,s,o,u)};var m=new d,p=new d,y=new d,w=new d;d.fromHeadingPitchRoll=function(e,a){return w=d.fromAxisAngle(n.Cartesian3.UNIT_X,e.roll,m),y=d.fromAxisAngle(n.Cartesian3.UNIT_Y,-e.pitch,a),a=d.multiply(y,w,y),p=d.fromAxisAngle(n.Cartesian3.UNIT_Z,-e.heading,m),d.multiply(p,a,a)};var C=new n.Cartesian3,x=new n.Cartesian3,_=new d,M=new d,E=new d;d.packedLength=4,d.pack=function(e,t,n){return n=a.defaultValue(n,0),t[n++]=e.x,t[n++]=e.y,t[n++]=e.z,t[n]=e.w,t},d.unpack=function(e,t,n){return t=a.defaultValue(t,0),a.defined(n)||(n=new d),n.x=e[t],n.y=e[t+1],n.z=e[t+2],n.w=e[t+3],n},d.packedInterpolationLength=3,d.convertPackedArrayForInterpolation=function(e,a,t,n){d.unpack(e,4*t,E),d.conjugate(E,E);for(var r=0,i=t-a+1;r<i;r++){var s=3*r;d.unpack(e,4*(a+r),_),d.multiply(_,E,_),_.w<0&&d.negate(_,_),d.computeAxis(_,C);var o=d.computeAngle(_);n[s]=C.x*o,n[s+1]=C.y*o,n[s+2]=C.z*o}},d.unpackInterpolationResult=function(e,t,r,i,s){a.defined(s)||(s=new d),n.Cartesian3.fromArray(e,0,x);var o=n.Cartesian3.magnitude(x);return d.unpack(t,4*i,M),0===o?d.clone(d.IDENTITY,_):d.fromAxisAngle(x,o,_),d.multiply(_,M,s)},d.clone=function(e,t){if(a.defined(e))return a.defined(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new d(e.x,e.y,e.z,e.w)},d.conjugate=function(e,a){return a.x=-e.x,a.y=-e.y,a.z=-e.z,a.w=e.w,a},d.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},d.magnitude=function(e){return Math.sqrt(d.magnitudeSquared(e))},d.normalize=function(e,a){var t=1/d.magnitude(e),n=e.x*t,r=e.y*t,i=e.z*t,s=e.w*t;return a.x=n,a.y=r,a.z=i,a.w=s,a},d.inverse=function(e,a){var t=d.magnitudeSquared(e);return a=d.conjugate(e,a),d.multiplyByScalar(a,1/t,a)},d.add=function(e,a,t){return t.x=e.x+a.x,t.y=e.y+a.y,t.z=e.z+a.z,t.w=e.w+a.w,t},d.subtract=function(e,a,t){return t.x=e.x-a.x,t.y=e.y-a.y,t.z=e.z-a.z,t.w=e.w-a.w,t},d.negate=function(e,a){return a.x=-e.x,a.y=-e.y,a.z=-e.z,a.w=-e.w,a},d.dot=function(e,a){return e.x*a.x+e.y*a.y+e.z*a.z+e.w*a.w},d.multiply=function(e,a,t){var n=e.x,r=e.y,i=e.z,s=e.w,o=a.x,u=a.y,l=a.z,d=a.w,c=s*o+n*d+r*l-i*u,f=s*u-n*l+r*d+i*o,h=s*l+n*u-r*o+i*d,m=s*d-n*o-r*u-i*l;return t.x=c,t.y=f,t.z=h,t.w=m,t},d.multiplyByVec=function(e,a,t){var r=new n.Cartesian3,i=new n.Cartesian3,s=new n.Cartesian3(e.x,e.y,e.z);r=n.Cartesian3.cross(s,a,r),i=n.Cartesian3.cross(s,r,i);var o=new n.Cartesian3;o=n.Cartesian3.multiplyByScalar(r,2*e.w,o);var u=new n.Cartesian3;return u=n.Cartesian3.multiplyByScalar(r,2,u),t=n.Cartesian3.add(a,o,t),t=n.Cartesian3.add(t,u,t)},d.multiplyByScalar=function(e,a,t){return t.x=e.x*a,t.y=e.y*a,t.z=e.z*a,t.w=e.w*a,t},d.divideByScalar=function(e,a,t){return t.x=e.x/a,t.y=e.y/a,t.z=e.z/a,t.w=e.w/a,t},d.computeAxis=function(e,a){var t=e.w;if(Math.abs(t-1)<u.CesiumMath.EPSILON6)return a.x=a.y=a.z=0,a;var n=1/Math.sqrt(1-t*t);return a.x=e.x*n,a.y=e.y*n,a.z=e.z*n,a},d.computeAngle=function(e){return Math.abs(e.w-1)<u.CesiumMath.EPSILON6?0:2*Math.acos(e.w)};var O=new d;d.lerp=function(e,a,t,n){return O=d.multiplyByScalar(a,t,O),n=d.multiplyByScalar(e,1-t,n),d.add(O,n,n)};var S=new d,v=new d,D=new d;d.slerp=function(e,a,t,n){var r=d.dot(e,a),i=a;if(r<0&&(r=-r,i=S=d.negate(a,S)),1-r<u.CesiumMath.EPSILON6)return d.lerp(e,i,t,n);var s=Math.acos(r);return v=d.multiplyByScalar(e,Math.sin((1-t)*s),v),D=d.multiplyByScalar(i,Math.sin(t*s),D),n=d.add(v,D,n),d.multiplyByScalar(n,1/Math.sin(s),n)},d.log=function(e,a){var t=u.CesiumMath.acosClamped(e.w),r=0;return 0!==t&&(r=t/Math.sin(t)),n.Cartesian3.multiplyByScalar(e,r,a)},d.exp=function(e,a){var t=n.Cartesian3.magnitude(e),r=0;return 0!==t&&(r=Math.sin(t)/t),a.x=e.x*r,a.y=e.y*r,a.z=e.z*r,a.w=Math.cos(t),a};var T=new n.Cartesian3,P=new n.Cartesian3,g=new d,N=new d;d.computeInnerQuadrangle=function(e,a,t,r){var i=d.conjugate(a,g);d.multiply(i,t,N);var s=d.log(N,T);d.multiply(i,e,N);var o=d.log(N,P);return n.Cartesian3.add(s,o,s),n.Cartesian3.multiplyByScalar(s,.25,s),n.Cartesian3.negate(s,s),d.exp(s,g),d.multiply(a,g,r)},d.squad=function(e,a,t,n,r,i){var s=d.slerp(e,a,r,g),o=d.slerp(t,n,r,N);return d.slerp(s,o,2*r*(1-r),i)};for(var R=new d,I=1.9011074535173003,A=l.FeatureDetection.supportsTypedArrays()?new Float32Array(8):[],U=l.FeatureDetection.supportsTypedArrays()?new Float32Array(8):[],z=l.FeatureDetection.supportsTypedArrays()?new Float32Array(8):[],F=l.FeatureDetection.supportsTypedArrays()?new Float32Array(8):[],b=0;b<7;++b){var W=b+1,q=2*W+1;A[b]=1/(W*q),U[b]=W/q}function L(e,a,t){for(var n,r,i=0,s=e.length-1;i<=s;)if((r=t(e[n=~~((i+s)/2)],a))<0)i=n+1;else{if(!(r>0))return n;s=n-1}return~(s+1)}function V(e,a,t,n,r){this.xPoleWander=e,this.yPoleWander=a,this.xPoleOffset=t,this.yPoleOffset=n,this.ut1MinusUtc=r}
/**
    @license
    sprintf.js from the php.js project - https://github.com/kvz/phpjs
    Directly from https://github.com/kvz/phpjs/blob/master/functions/strings/sprintf.js

    php.js is copyright 2012 Kevin van Zonneveld.

    Portions copyright Brett Zamir (http://brett-zamir.me), Kevin van Zonneveld
    (http://kevin.vanzonneveld.net), Onno Marsman, Theriault, Michael White
    (http://getsprink.com), Waldo Malqui Silva, Paulo Freitas, Jack, Jonas
    Raoni Soares Silva (http://www.jsfromhell.com), Philip Peterson, Legaev
    Andrey, Ates Goral (http://magnetiq.com), Alex, Ratheous, Martijn Wieringa,
    Rafa? Kukawski (http://blog.kukawski.pl), lmeyrick
    (https://sourceforge.net/projects/bcmath-js/), Nate, Philippe Baumann,
    Enrique Gonzalez, Webtoolkit.info (http://www.webtoolkit.info/), Carlos R.
    L. Rodrigues (http://www.jsfromhell.com), Ash Searle
    (http://hexmen.com/blog/), Jani Hartikainen, travc, Ole Vrijenhoek,
    Erkekjetter, Michael Grier, Rafa? Kukawski (http://kukawski.pl), Johnny
    Mast (http://www.phpvrouwen.nl), T.Wild, d3x,
    http://stackoverflow.com/questions/57803/how-to-convert-decimal-to-hex-in-javascript,
    Rafa? Kukawski (http://blog.kukawski.pl/), stag019, pilus, WebDevHobo
    (http://webdevhobo.blogspot.com/), marrtins, GeekFG
    (http://geekfg.blogspot.com), Andrea Giammarchi
    (http://webreflection.blogspot.com), Arpad Ray (mailto:arpad@php.net),
    gorthaur, Paul Smith, Tim de Koning (http://www.kingsquare.nl), Joris, Oleg
    Eremeev, Steve Hilder, majak, gettimeofday, KELAN, Josh Fraser
    (http://onlineaspect.com/2007/06/08/auto-detect-a-time-zone-with-javascript/),
    Marc Palau, Martin
    (http://www.erlenwiese.de/), Breaking Par Consulting Inc
    (http://www.breakingpar.com/bkp/home.nsf/0/87256B280015193F87256CFB006C45F7),
    Chris, Mirek Slugen, saulius, Alfonso Jimenez
    (http://www.alfonsojimenez.com), Diplom@t (http://difane.com/), felix,
    Mailfaker (http://www.weedem.fr/), Tyler Akins (http://rumkin.com), Caio
    Ariede (http://caioariede.com), Robin, Kankrelune
    (http://www.webfaktory.info/), Karol Kowalski, Imgen Tata
    (http://www.myipdf.com/), mdsjack (http://www.mdsjack.bo.it), Dreamer,
    Felix Geisendoerfer (http://www.debuggable.com/felix), Lars Fischer, AJ,
    David, Aman Gupta, Michael White, Public Domain
    (http://www.json.org/json2.js), Steven Levithan
    (http://blog.stevenlevithan.com), Sakimori, Pellentesque Malesuada,
    Thunder.m, Dj (http://phpjs.org/functions/htmlentities:425#comment_134018),
    Steve Clay, David James, Francois, class_exists, nobbler, T. Wild, Itsacon
    (http://www.itsacon.net/), date, Ole Vrijenhoek (http://www.nervous.nl/),
    Fox, Raphael (Ao RUDLER), Marco, noname, Mateusz "loonquawl" Zalega, Frank
    Forte, Arno, ger, mktime, john (http://www.jd-tech.net), Nick Kolosov
    (http://sammy.ru), marc andreu, Scott Cariss, Douglas Crockford
    (http://javascript.crockford.com), madipta, Slawomir Kaniecki,
    ReverseSyntax, Nathan, Alex Wilson, kenneth, Bayron Guevara, Adam Wallner
    (http://web2.bitbaro.hu/), paulo kuong, jmweb, Lincoln Ramsay, djmix,
    Pyerre, Jon Hohle, Thiago Mata (http://thiagomata.blog.com), lmeyrick
    (https://sourceforge.net/projects/bcmath-js/this.), Linuxworld, duncan,
    Gilbert, Sanjoy Roy, Shingo, sankai, Oskar Larsson H?gfeldt
    (http://oskar-lh.name/), Denny Wardhana, 0m3r, Everlasto, Subhasis Deb,
    josh, jd, Pier Paolo Ramon (http://www.mastersoup.com/), P, merabi, Soren
    Hansen, Eugene Bulkin (http://doubleaw.com/), Der Simon
    (http://innerdom.sourceforge.net/), echo is bad, Ozh, XoraX
    (http://www.xorax.info), EdorFaus, JB, J A R, Marc Jansen, Francesco, LH,
    Stoyan Kyosev (http://www.svest.org/), nord_ua, omid
    (http://phpjs.org/functions/380:380#comment_137122), Brad Touesnard, MeEtc
    (http://yass.meetcweb.com), Peter-Paul Koch
    (http://www.quirksmode.org/js/beat.html), Olivier Louvignes
    (http://mg-crea.com/), T0bsn, Tim Wiel, Bryan Elliott, Jalal Berrami,
    Martin, JT, David Randall, Thomas Beaucourt (http://www.webapp.fr), taith,
    vlado houba, Pierre-Luc Paour, Kristof Coomans (SCK-CEN Belgian Nucleair
    Research Centre), Martin Pool, Kirk Strobeck, Rick Waldron, Brant Messenger
    (http://www.brantmessenger.com/), Devan Penner-Woelk, Saulo Vallory, Wagner
    B. Soares, Artur Tchernychev, Valentina De Rosa, Jason Wong
    (http://carrot.org/), Christoph, Daniel Esteban, strftime, Mick@el, rezna,
    Simon Willison (http://simonwillison.net), Anton Ongson, Gabriel Paderni,
    Marco van Oort, penutbutterjelly, Philipp Lenssen, Bjorn Roesbeke
    (http://www.bjornroesbeke.be/), Bug?, Eric Nagel, Tomasz Wesolowski,
    Evertjan Garretsen, Bobby Drake, Blues (http://tech.bluesmoon.info/), Luke
    Godfrey, Pul, uestla, Alan C, Ulrich, Rafal Kukawski, Yves Sucaet,
    sowberry, Norman "zEh" Fuchs, hitwork, Zahlii, johnrembo, Nick Callen,
    Steven Levithan (stevenlevithan.com), ejsanders, Scott Baker, Brian Tafoya
    (http://www.premasolutions.com/), Philippe Jausions
    (http://pear.php.net/user/jausions), Aidan Lister
    (http://aidanlister.com/), Rob, e-mike, HKM, ChaosNo1, metjay, strcasecmp,
    strcmp, Taras Bogach, jpfle, Alexander Ermolaev
    (http://snippets.dzone.com/user/AlexanderErmolaev), DxGx, kilops, Orlando,
    dptr1988, Le Torbi, James (http://www.james-bell.co.uk/), Pedro Tainha
    (http://www.pedrotainha.com), James, Arnout Kazemier
    (http://www.3rd-Eden.com), Chris McMacken, gabriel paderni, Yannoo,
    FGFEmperor, baris ozdil, Tod Gentille, Greg Frazier, jakes, 3D-GRAF, Allan
    Jensen (http://www.winternet.no), Howard Yeend, Benjamin Lupton, davook,
    daniel airton wermann (http://wermann.com.br), Atli T¨®r, Maximusya, Ryan
    W Tenney (http://ryan.10e.us), Alexander M Beedie, fearphage
    (http://http/my.opera.com/fearphage/), Nathan Sepulveda, Victor, Matteo,
    Billy, stensi, Cord, Manish, T.J. Leahy, Riddler
    (http://www.frontierwebdev.com/), Rafa? Kukawski, FremyCompany, Matt
    Bradley, Tim de Koning, Luis Salazar (http://www.freaky-media.com/), Diogo
    Resende, Rival, Andrej Pavlovic, Garagoth, Le Torbi
    (http://www.letorbi.de/), Dino, Josep Sanz (http://www.ws3.es/), rem,
    Russell Walker (http://www.nbill.co.uk/), Jamie Beck
    (http://www.terabit.ca/), setcookie, Michael, YUI Library:
    http://developer.yahoo.com/yui/docs/YAHOO.util.DateLocale.html, Blues at
    http://hacks.bluesmoon.info/strftime/strftime.js, Ben
    (http://benblume.co.uk/), DtTvB
    (http://dt.in.th/2008-09-16.string-length-in-bytes.html), Andreas, William,
    meo, incidence, Cagri Ekin, Amirouche, Amir Habibi
    (http://www.residence-mixte.com/), Luke Smith (http://lucassmith.name),
    Kheang Hok Chin (http://www.distantia.ca/), Jay Klehr, Lorenzo Pisani,
    Tony, Yen-Wei Liu, Greenseed, mk.keck, Leslie Hoare, dude, booeyOH, Ben
    Bryan

    Licensed under the MIT (MIT-LICENSE.txt) license.

    Permission is hereby granted, free of charge, to any person obtaining a
    copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be included
    in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
    OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
    IN NO EVENT SHALL KEVIN VAN ZONNEVELD BE LIABLE FOR ANY CLAIM, DAMAGES
    OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
    ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.
    */function k(){var e=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,a=arguments,t=0,n=a[t++],r=function(e,a,t,n){t||(t=" ");var r=e.length>=a?"":Array(1+a-e.length>>>0).join(t);return n?e+r:r+e},i=function(e,a,t,n,i,s){var o=n-e.length;return o>0&&(e=t||!i?r(e,n,s,t):e.slice(0,a.length)+r("",o,"0",!0)+e.slice(a.length)),e},s=function(e,a,t,n,s,o,u){var l=e>>>0;return e=(t=t&&l&&{2:"0b",8:"0",16:"0x"}[a]||"")+r(l.toString(a),o||0,"0",!1),i(e,t,n,s,u)},o=function(e,a,t,n,r,s){return null!=n&&(e=e.slice(0,n)),i(e,"",a,t,r,s)},u=function(e,n,u,l,d,c,f){var h,m,p,y,w;if("%%"==e)return"%";for(var C=!1,x="",_=!1,M=!1,E=" ",O=u.length,S=0;u&&S<O;S++)switch(u.charAt(S)){case" ":x=" ";break;case"+":x="+";break;case"-":C=!0;break;case"'":E=u.charAt(S+1);break;case"0":_=!0;break;case"#":M=!0}if((l=l?"*"==l?+a[t++]:"*"==l.charAt(0)?+a[l.slice(1,-1)]:+l:0)<0&&(l=-l,C=!0),!isFinite(l))throw new Error("sprintf: (minimum-)width must be finite");switch(c=c?"*"==c?+a[t++]:"*"==c.charAt(0)?+a[c.slice(1,-1)]:+c:"fFeE".indexOf(f)>-1?6:"d"==f?0:void 0,w=n?a[n.slice(0,-1)]:a[t++],f){case"s":return o(String(w),C,l,c,_,E);case"c":return o(String.fromCharCode(+w),C,l,c,_);case"b":return s(w,2,M,C,l,c,_);case"o":return s(w,8,M,C,l,c,_);case"x":return s(w,16,M,C,l,c,_);case"X":return s(w,16,M,C,l,c,_).toUpperCase();case"u":return s(w,10,M,C,l,c,_);case"i":case"d":return h=+w||0,w=(m=(h=Math.round(h-h%1))<0?"-":x)+r(String(Math.abs(h)),c,"0",!1),i(w,m,C,l,_);case"e":case"E":case"f":case"F":case"g":case"G":return m=(h=+w)<0?"-":x,p=["toExponential","toFixed","toPrecision"]["efg".indexOf(f.toLowerCase())],y=["toString","toUpperCase"]["eEfFgG".indexOf(f)%2],w=m+Math.abs(h)[p](c),i(w,m,C,l,_)[y]();default:return e}};return n.replace(e,u)}function Y(e,a,t,n,r,i,s,o){this.year=e,this.month=a,this.day=t,this.hour=n,this.minute=r,this.second=i,this.millisecond=s,this.isLeapSecond=o}function B(e){return e%4==0&&e%100!=0||e%400==0}function j(e,a){this.julianDate=e,this.offset=a}A[7]=I/136,U[7]=8*I/17,d.fastSlerp=function(e,a,t,n){var r,i=d.dot(e,a);i>=0?r=1:(r=-1,i=-i);for(var s=i-1,o=1-t,u=t*t,l=o*o,c=7;c>=0;--c)z[c]=(A[c]*u-U[c])*s,F[c]=(A[c]*l-U[c])*s;var f=r*t*(1+z[0]*(1+z[1]*(1+z[2]*(1+z[3]*(1+z[4]*(1+z[5]*(1+z[6]*(1+z[7])))))))),h=o*(1+F[0]*(1+F[1]*(1+F[2]*(1+F[3]*(1+F[4]*(1+F[5]*(1+F[6]*(1+F[7])))))))),m=d.multiplyByScalar(e,h,R);return d.multiplyByScalar(a,f,n),d.add(m,n,n)},d.fastSquad=function(e,a,t,n,r,i){var s=d.fastSlerp(e,a,r,g),o=d.fastSlerp(t,n,r,N);return d.fastSlerp(s,o,2*r*(1-r),i)},d.equals=function(e,t){return e===t||a.defined(e)&&a.defined(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},d.equalsEpsilon=function(e,t,n){return e===t||a.defined(e)&&a.defined(t)&&Math.abs(e.x-t.x)<=n&&Math.abs(e.y-t.y)<=n&&Math.abs(e.z-t.z)<=n&&Math.abs(e.w-t.w)<=n},d.ZERO=Object.freeze(new d(0,0,0,0)),d.IDENTITY=Object.freeze(new d(0,0,0,1)),d.prototype.clone=function(e){return d.clone(this,e)},d.prototype.equals=function(e){return d.equals(this,e)},d.prototype.equalsEpsilon=function(e,a){return d.equalsEpsilon(this,e,a)},d.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};var G=Object.freeze({SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5}),Z=Object.freeze({UTC:0,TAI:1}),X=new Y,J=[31,28,31,30,31,30,31,31,30,31,30,31];function H(e,a){return ce.compare(e.julianDate,a.julianDate)}var $=new j;function Q(e){$.julianDate=e;var a=ce.leapSeconds,t=L(a,$,H);t<0&&(t=~t),t>=a.length&&(t=a.length-1);var n=a[t].offset;t>0&&(ce.secondsDifference(a[t].julianDate,e)>n&&(n=a[--t].offset));ce.addSeconds(e,n,e)}function K(e,a){$.julianDate=e;var t=ce.leapSeconds,n=L(t,$,H);if(n<0&&(n=~n),0===n)return ce.addSeconds(e,-t[0].offset,a);if(n>=t.length)return ce.addSeconds(e,-t[n-1].offset,a);var r=ce.secondsDifference(t[n].julianDate,e);return 0===r?ce.addSeconds(e,-t[n].offset,a):r<=1?void 0:ce.addSeconds(e,-t[--n].offset,a)}function ee(e,a,t){var n=a/G.SECONDS_PER_DAY|0;return e+=n,(a-=G.SECONDS_PER_DAY*n)<0&&(e--,a+=G.SECONDS_PER_DAY),t.dayNumber=e,t.secondsOfDay=a,t}function ae(e,a,t,n,r,i,s){var o=(a-14)/12|0,u=e+4800+o,l=(1461*u/4|0)+(367*(a-2-12*o)/12|0)-(3*((u+100)/100|0)/4|0)+t-32075;(n-=12)<0&&(n+=24);var d=i+(n*G.SECONDS_PER_HOUR+r*G.SECONDS_PER_MINUTE+s*G.SECONDS_PER_MILLISECOND);return d>=43200&&(l-=1),[l,d]}var te=/^(\d{4})$/,ne=/^(\d{4})-(\d{2})$/,re=/^(\d{4})-?(\d{3})$/,ie=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,se=/^(\d{4})-?(\d{2})-?(\d{2})$/,oe=/([Z+\-])?(\d{2})?:?(\d{2})?$/,ue=/^(\d{2})(\.\d+)?/.source+oe.source,le=/^(\d{2}):?(\d{2})(\.\d+)?/.source+oe.source,de=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+oe.source;function ce(e,t,n){this.dayNumber=void 0,this.secondsOfDay=void 0,e=a.defaultValue(e,0),t=a.defaultValue(t,0),n=a.defaultValue(n,Z.UTC);var r=0|e;ee(r,t+=(e-r)*G.SECONDS_PER_DAY,this),n===Z.UTC&&Q(this)}ce.fromGregorianDate=function(e,t){var n=ae(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return a.defined(t)?(ee(n[0],n[1],t),Q(t),t):new ce(n[0],n[1],Z.UTC)},ce.fromDate=function(e,t){var n=ae(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return a.defined(t)?(ee(n[0],n[1],t),Q(t),t):new ce(n[0],n[1],Z.UTC)},ce.fromIso8601=function(e,t){var n,r,i,s,o=(e=e.replace(",",".")).split("T"),u=1,l=1,d=0,c=0,f=0,h=0,m=o[0],p=o[1];if(null!==(o=m.match(se)))n=+o[1],u=+o[2],l=+o[3];else if(null!==(o=m.match(ne)))n=+o[1],u=+o[2];else if(null!==(o=m.match(te)))n=+o[1];else{var y;if(null!==(o=m.match(re)))n=+o[1],y=+o[2],i=B(n);else if(null!==(o=m.match(ie)))n=+o[1],y=7*+o[2]+(+o[3]||0)-new Date(Date.UTC(n,0,4)).getUTCDay()-3;(r=new Date(Date.UTC(n,0,1))).setUTCDate(y),u=r.getUTCMonth()+1,l=r.getUTCDate()}if(i=B(n),a.defined(p)){null!==(o=p.match(de))?(d=+o[1],c=+o[2],f=+o[3],h=1e3*+(o[4]||0),s=5):null!==(o=p.match(le))?(d=+o[1],c=+o[2],f=60*+(o[3]||0),s=4):null!==(o=p.match(ue))&&(d=+o[1],c=60*+(o[2]||0),s=3);var w=o[s],C=+o[s+1],x=+(o[s+2]||0);switch(w){case"+":d-=C,c-=x;break;case"-":d+=C,c+=x;break;case"Z":break;default:c+=new Date(Date.UTC(n,u-1,l,d,c)).getTimezoneOffset()}}var _=60===f;for(_&&f--;c>=60;)c-=60,d++;for(;d>=24;)d-=24,l++;for(r=i&&2===u?29:J[u-1];l>r;)l-=r,++u>12&&(u-=12,n++),r=i&&2===u?29:J[u-1];for(;c<0;)c+=60,d--;for(;d<0;)d+=24,l--;for(;l<1;)--u<1&&(u+=12,n--),l+=r=i&&2===u?29:J[u-1];var M=ae(n,u,l,d,c,f,h);return a.defined(t)?(ee(M[0],M[1],t),Q(t)):t=new ce(M[0],M[1],Z.UTC),_&&ce.addSeconds(t,1,t),t},ce.now=function(e){return ce.fromDate(new Date,e)};var fe=new ce(0,0,Z.TAI);function he(e){if(e=a.defaultValue(e,a.defaultValue.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=a.defaultValue(e.addNewLeapSeconds,!0),a.defined(e.data))pe(this,e.data);else if(a.defined(e.url)){var t=s.Resource.createIfNeeded(e.url),n=this;this._downloadPromise=a.when(t.fetchJson(),(function(e){pe(n,e)}),(function(){n._dataError="An error occurred while retrieving the EOP data from the URL "+t.url+"."}))}else pe(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function me(e,a){return ce.compare(e.julianDate,a)}function pe(e,t){if(a.defined(t.columnNames))if(a.defined(t.samples)){var n=t.columnNames.indexOf("modifiedJulianDateUtc"),r=t.columnNames.indexOf("xPoleWanderRadians"),i=t.columnNames.indexOf("yPoleWanderRadians"),s=t.columnNames.indexOf("ut1MinusUtcSeconds"),o=t.columnNames.indexOf("xCelestialPoleOffsetRadians"),u=t.columnNames.indexOf("yCelestialPoleOffsetRadians"),l=t.columnNames.indexOf("taiMinusUtcSeconds");if(n<0||r<0||i<0||s<0||o<0||u<0||l<0)e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";else{var d,c=e._samples=t.samples,f=e._dates=[];e._dateColumn=n,e._xPoleWanderRadiansColumn=r,e._yPoleWanderRadiansColumn=i,e._ut1MinusUtcSecondsColumn=s,e._xCelestialPoleOffsetRadiansColumn=o,e._yCelestialPoleOffsetRadiansColumn=u,e._taiMinusUtcSecondsColumn=l,e._columnCount=t.columnNames.length,e._lastIndex=void 0;for(var h=e._addNewLeapSeconds,m=0,p=c.length;m<p;m+=e._columnCount){var y=c[m+n],w=c[m+l],C=new ce(y+G.MODIFIED_JULIAN_DATE_DIFFERENCE,w,Z.TAI);if(f.push(C),h){if(w!==d&&a.defined(d)){var x=ce.leapSeconds,_=L(x,C,me);if(_<0){var M=new j(C,w);x.splice(~_,0,M)}}d=w}}}}else e._dataError="Error in loaded EOP data: The samples property is required.";else e._dataError="Error in loaded EOP data: The columnNames property is required."}function ye(e,a,t,n,r){var i=t*n;r.xPoleWander=a[i+e._xPoleWanderRadiansColumn],r.yPoleWander=a[i+e._yPoleWanderRadiansColumn],r.xPoleOffset=a[i+e._xCelestialPoleOffsetRadiansColumn],r.yPoleOffset=a[i+e._yCelestialPoleOffsetRadiansColumn],r.ut1MinusUtc=a[i+e._ut1MinusUtcSecondsColumn]}function we(e,a,t){return a+e*(t-a)}function Ce(e,a,t,n,r,i,s){var o=e._columnCount;if(i>a.length-1)return s.xPoleWander=0,s.yPoleWander=0,s.xPoleOffset=0,s.yPoleOffset=0,s.ut1MinusUtc=0,s;var u=a[r],l=a[i];if(u.equals(l)||n.equals(u))return ye(e,t,r,o,s),s;if(n.equals(l))return ye(e,t,i,o,s),s;var d=ce.secondsDifference(n,u)/ce.secondsDifference(l,u),c=r*o,f=i*o,h=t[c+e._ut1MinusUtcSecondsColumn],m=t[f+e._ut1MinusUtcSecondsColumn],p=m-h;if(p>.5||p<-.5){var y=t[c+e._taiMinusUtcSecondsColumn],w=t[f+e._taiMinusUtcSecondsColumn];y!==w&&(l.equals(n)?h=m:m-=w-y)}return s.xPoleWander=we(d,t[c+e._xPoleWanderRadiansColumn],t[f+e._xPoleWanderRadiansColumn]),s.yPoleWander=we(d,t[c+e._yPoleWanderRadiansColumn],t[f+e._yPoleWanderRadiansColumn]),s.xPoleOffset=we(d,t[c+e._xCelestialPoleOffsetRadiansColumn],t[f+e._xCelestialPoleOffsetRadiansColumn]),s.yPoleOffset=we(d,t[c+e._yCelestialPoleOffsetRadiansColumn],t[f+e._yCelestialPoleOffsetRadiansColumn]),s.ut1MinusUtc=we(d,h,m),s}function xe(e,t,n){this.heading=a.defaultValue(e,0),this.pitch=a.defaultValue(t,0),this.roll=a.defaultValue(n,0)}function _e(e,a,t){this.x=e,this.y=a,this.s=t}function Me(e){e=a.defaultValue(e,a.defaultValue.EMPTY_OBJECT),this._xysFileUrlTemplate=s.Resource.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=a.defaultValue(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=a.defaultValue(e.sampleZeroJulianEphemerisDate,2442396.5),this._sampleZeroDateTT=new ce(this._sampleZeroJulianEphemerisDate,0,Z.TAI),this._stepSizeDays=a.defaultValue(e.stepSizeDays,1),this._samplesPerXysFile=a.defaultValue(e.samplesPerXysFile,1e3),this._totalSamples=a.defaultValue(e.totalSamples,27426),this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];for(var t=this._interpolationOrder,n=this._denominators=new Array(t+1),r=this._xTable=new Array(t+1),i=Math.pow(this._stepSizeDays,t),o=0;o<=t;++o){n[o]=i,r[o]=o*this._stepSizeDays;for(var u=0;u<=t;++u)u!==o&&(n[o]*=o-u);n[o]=1/n[o]}this._work=new Array(t+1),this._coef=new Array(t+1)}ce.toGregorianDate=function(e,t){var n=!1,r=K(e,fe);a.defined(r)||(ce.addSeconds(e,-1,fe),r=K(fe,fe),n=!0);var i=r.dayNumber,s=r.secondsOfDay;s>=43200&&(i+=1);var o=i+68569|0,u=4*o/146097|0,l=4e3*((o=o-((146097*u+3)/4|0)|0)+1)/1461001|0,d=80*(o=o-(1461*l/4|0)+31|0)/2447|0,c=o-(2447*d/80|0)|0,f=d+2-12*(o=d/11|0)|0,h=100*(u-49)+l+o|0,m=s/G.SECONDS_PER_HOUR|0,p=s-m*G.SECONDS_PER_HOUR,y=p/G.SECONDS_PER_MINUTE|0,w=0|(p-=y*G.SECONDS_PER_MINUTE),C=(p-w)/G.SECONDS_PER_MILLISECOND;return(m+=12)>23&&(m-=24),n&&(w+=1),a.defined(t)?(t.year=h,t.month=f,t.day=c,t.hour=m,t.minute=y,t.second=w,t.millisecond=C,t.isLeapSecond=n,t):new Y(h,f,c,m,y,w,C,n)},ce.toDate=function(e){var a=ce.toGregorianDate(e,X),t=a.second;return a.isLeapSecond&&(t-=1),new Date(Date.UTC(a.year,a.month-1,a.day,a.hour,a.minute,t,a.millisecond))},ce.toIso8601=function(e,t){var n=ce.toGregorianDate(e,X),r=n.year,i=n.month,s=n.day,o=n.hour,u=n.minute,l=n.second,d=n.millisecond;return 1e4===r&&1===i&&1===s&&0===o&&0===u&&0===l&&0===d&&(r=9999,i=12,s=31,o=24),a.defined(t)||0===d?a.defined(t)&&0!==t?k("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",r,i,s,o,u,l,(.01*d).toFixed(t).replace(".","").slice(0,t)):k("%04d-%02d-%02dT%02d:%02d:%02dZ",r,i,s,o,u,l):k("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",r,i,s,o,u,l,(.01*d).toString().replace(".",""))},ce.clone=function(e,t){if(a.defined(e))return a.defined(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new ce(e.dayNumber,e.secondsOfDay,Z.TAI)},ce.compare=function(e,a){var t=e.dayNumber-a.dayNumber;return 0!==t?t:e.secondsOfDay-a.secondsOfDay},ce.equals=function(e,t){return e===t||a.defined(e)&&a.defined(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay},ce.equalsEpsilon=function(e,t,n){return e===t||a.defined(e)&&a.defined(t)&&Math.abs(ce.secondsDifference(e,t))<=n},ce.totalDays=function(e){return e.dayNumber+e.secondsOfDay/G.SECONDS_PER_DAY},ce.secondsDifference=function(e,a){return(e.dayNumber-a.dayNumber)*G.SECONDS_PER_DAY+(e.secondsOfDay-a.secondsOfDay)},ce.daysDifference=function(e,a){return e.dayNumber-a.dayNumber+(e.secondsOfDay-a.secondsOfDay)/G.SECONDS_PER_DAY},ce.computeTaiMinusUtc=function(e){$.julianDate=e;var a=ce.leapSeconds,t=L(a,$,H);return t<0&&(t=~t,--t<0&&(t=0)),a[t].offset},ce.addSeconds=function(e,a,t){return ee(e.dayNumber,e.secondsOfDay+a,t)},ce.addMinutes=function(e,a,t){var n=e.secondsOfDay+a*G.SECONDS_PER_MINUTE;return ee(e.dayNumber,n,t)},ce.addHours=function(e,a,t){var n=e.secondsOfDay+a*G.SECONDS_PER_HOUR;return ee(e.dayNumber,n,t)},ce.addDays=function(e,a,t){return ee(e.dayNumber+a,e.secondsOfDay,t)},ce.lessThan=function(e,a){return ce.compare(e,a)<0},ce.lessThanOrEquals=function(e,a){return ce.compare(e,a)<=0},ce.greaterThan=function(e,a){return ce.compare(e,a)>0},ce.greaterThanOrEquals=function(e,a){return ce.compare(e,a)>=0},ce.prototype.clone=function(e){return ce.clone(this,e)},ce.prototype.equals=function(e){return ce.equals(this,e)},ce.prototype.equalsEpsilon=function(e,a){return ce.equalsEpsilon(this,e,a)},ce.prototype.toString=function(){return ce.toIso8601(this)},ce.leapSeconds=[new j(new ce(2441317,43210,Z.TAI),10),new j(new ce(2441499,43211,Z.TAI),11),new j(new ce(2441683,43212,Z.TAI),12),new j(new ce(2442048,43213,Z.TAI),13),new j(new ce(2442413,43214,Z.TAI),14),new j(new ce(2442778,43215,Z.TAI),15),new j(new ce(2443144,43216,Z.TAI),16),new j(new ce(2443509,43217,Z.TAI),17),new j(new ce(2443874,43218,Z.TAI),18),new j(new ce(2444239,43219,Z.TAI),19),new j(new ce(2444786,43220,Z.TAI),20),new j(new ce(2445151,43221,Z.TAI),21),new j(new ce(2445516,43222,Z.TAI),22),new j(new ce(2446247,43223,Z.TAI),23),new j(new ce(2447161,43224,Z.TAI),24),new j(new ce(2447892,43225,Z.TAI),25),new j(new ce(2448257,43226,Z.TAI),26),new j(new ce(2448804,43227,Z.TAI),27),new j(new ce(2449169,43228,Z.TAI),28),new j(new ce(2449534,43229,Z.TAI),29),new j(new ce(2450083,43230,Z.TAI),30),new j(new ce(2450630,43231,Z.TAI),31),new j(new ce(2451179,43232,Z.TAI),32),new j(new ce(2453736,43233,Z.TAI),33),new j(new ce(2454832,43234,Z.TAI),34),new j(new ce(2456109,43235,Z.TAI),35),new j(new ce(2457204,43236,Z.TAI),36),new j(new ce(2457754,43237,Z.TAI),37)],he.NONE=Object.freeze({getPromiseToLoad:function(){return a.when()},compute:function(e,t){return a.defined(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new V(0,0,0,0,0),t}}),he.prototype.getPromiseToLoad=function(){return a.when(this._downloadPromise)},he.prototype.compute=function(e,t){if(a.defined(this._samples)){if(a.defined(t)||(t=new V(0,0,0,0,0)),0===this._samples.length)return t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0,t;var n=this._dates,r=this._lastIndex,i=0,s=0;if(a.defined(r)){var u=n[r],l=n[r+1],d=ce.lessThanOrEquals(u,e),c=!a.defined(l),f=c||ce.greaterThanOrEquals(l,e);if(d&&f)return i=r,!c&&l.equals(e)&&++i,s=i+1,Ce(this,n,this._samples,e,i,s,t),t}var h=L(n,e,ce.compare,this._dateColumn);return h>=0?(h<n.length-1&&n[h+1].equals(e)&&++h,i=h,s=h):(i=(s=~h)-1)<0&&(i=0),this._lastIndex=i,Ce(this,n,this._samples,e,i,s,t),t}if(a.defined(this._dataError))throw new o.RuntimeError(this._dataError)},xe.fromQuaternion=function(e,t){a.defined(t)||(t=new xe);var n=2*(e.w*e.y-e.z*e.x),r=1-2*(e.x*e.x+e.y*e.y),i=2*(e.w*e.x+e.y*e.z),s=1-2*(e.y*e.y+e.z*e.z),o=2*(e.w*e.z+e.x*e.y);return t.heading=-Math.atan2(o,s),t.roll=Math.atan2(i,r),t.pitch=-u.CesiumMath.asinClamped(n),t},xe.fromDegrees=function(e,t,n,r){return a.defined(r)||(r=new xe),r.heading=e*u.CesiumMath.RADIANS_PER_DEGREE,r.pitch=t*u.CesiumMath.RADIANS_PER_DEGREE,r.roll=n*u.CesiumMath.RADIANS_PER_DEGREE,r},xe.clone=function(e,t){if(a.defined(e))return a.defined(t)?(t.heading=e.heading,t.pitch=e.pitch,t.roll=e.roll,t):new xe(e.heading,e.pitch,e.roll)},xe.equals=function(e,t){return e===t||a.defined(e)&&a.defined(t)&&e.heading===t.heading&&e.pitch===t.pitch&&e.roll===t.roll},xe.equalsEpsilon=function(e,t,n,r){return e===t||a.defined(e)&&a.defined(t)&&u.CesiumMath.equalsEpsilon(e.heading,t.heading,n,r)&&u.CesiumMath.equalsEpsilon(e.pitch,t.pitch,n,r)&&u.CesiumMath.equalsEpsilon(e.roll,t.roll,n,r)},xe.prototype.clone=function(e){return xe.clone(this,e)},xe.prototype.equals=function(e){return xe.equals(this,e)},xe.prototype.equalsEpsilon=function(e,a,t){return xe.equalsEpsilon(this,e,a,t)},xe.prototype.toString=function(){return"("+this.heading+", "+this.pitch+", "+this.roll+")"};var Ee=new ce(0,0,Z.TAI);function Oe(e,a,t){var n=Ee;return n.dayNumber=a,n.secondsOfDay=t,ce.daysDifference(n,e._sampleZeroDateTT)}function Se(e,t){if(e._chunkDownloadsInProgress[t])return e._chunkDownloadsInProgress[t];var n,r=a.when.defer();e._chunkDownloadsInProgress[t]=r;var i=e._xysFileUrlTemplate;return n=a.defined(i)?i.getDerivedResource({templateValues:{0:t}}):new s.Resource({url:s.buildModuleUrl("Assets/IAU2006_XYS/IAU2006_XYS_"+t+".json")}),a.when(n.fetchJson(),(function(a){e._chunkDownloadsInProgress[t]=!1;for(var n=e._samples,i=a.samples,s=t*e._samplesPerXysFile*3,o=0,u=i.length;o<u;++o)n[s+o]=i[o];r.resolve()})),r.promise}Me.prototype.preload=function(e,t,n,r){var i=Oe(this,e,t),s=Oe(this,n,r),o=i/this._stepSizeDays-this._interpolationOrder/2|0;o<0&&(o=0);var u=s/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;u>=this._totalSamples&&(u=this._totalSamples-1);for(var l=o/this._samplesPerXysFile|0,d=u/this._samplesPerXysFile|0,c=[],f=l;f<=d;++f)c.push(Se(this,f));return a.when.all(c)},Me.prototype.computeXysRadians=function(e,t,n){var r=Oe(this,e,t);if(!(r<0)){var i=r/this._stepSizeDays|0;if(!(i>=this._totalSamples)){var s=this._interpolationOrder,o=i-(s/2|0);o<0&&(o=0);var u=o+s;u>=this._totalSamples&&(o=(u=this._totalSamples-1)-s)<0&&(o=0);var l=!1,d=this._samples;if(a.defined(d[3*o])||(Se(this,o/this._samplesPerXysFile|0),l=!0),a.defined(d[3*u])||(Se(this,u/this._samplesPerXysFile|0),l=!0),!l){a.defined(n)?(n.x=0,n.y=0,n.s=0):n=new _e(0,0,0);var c,f,h=r-o*this._stepSizeDays,m=this._work,p=this._denominators,y=this._coef,w=this._xTable;for(c=0;c<=s;++c)m[c]=h-w[c];for(c=0;c<=s;++c){for(y[c]=1,f=0;f<=s;++f)f!==c&&(y[c]*=m[f]);y[c]*=p[c];var C=3*(o+c);n.x+=y[c]*d[C++],n.y+=y[c]*d[C++],n.s+=y[c]*d[C]}return n}}}};var ve={},De={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Te={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Pe={},ge={east:new n.Cartesian3,north:new n.Cartesian3,up:new n.Cartesian3,west:new n.Cartesian3,south:new n.Cartesian3,down:new n.Cartesian3},Ne=new n.Cartesian3,Re=new n.Cartesian3,Ie=new n.Cartesian3;ve.localFrameToFixedFrameGenerator=function(e,r){if(!De.hasOwnProperty(e)||!De[e].hasOwnProperty(r))throw new i.DeveloperError("firstAxis and secondAxis must be east, north, up, west, south or down.");var o,l=De[e][r],d=e+r;return a.defined(Pe[d])?o=Pe[d]:(o=function(i,o,d){if(a.defined(d)||(d=new t.Matrix4),n.Cartesian3.equalsEpsilon(i,n.Cartesian3.ZERO,u.CesiumMath.EPSILON14))n.Cartesian3.unpack(Te[e],0,Ne),n.Cartesian3.unpack(Te[r],0,Re),n.Cartesian3.unpack(Te[l],0,Ie);else if(u.CesiumMath.equalsEpsilon(i.x,0,u.CesiumMath.EPSILON14)&&u.CesiumMath.equalsEpsilon(i.y,0,u.CesiumMath.EPSILON14)){var c=u.CesiumMath.sign(i.z);n.Cartesian3.unpack(Te[e],0,Ne),"east"!==e&&"west"!==e&&n.Cartesian3.multiplyByScalar(Ne,c,Ne),n.Cartesian3.unpack(Te[r],0,Re),"east"!==r&&"west"!==r&&n.Cartesian3.multiplyByScalar(Re,c,Re),n.Cartesian3.unpack(Te[l],0,Ie),"east"!==l&&"west"!==l&&n.Cartesian3.multiplyByScalar(Ie,c,Ie)}else{(o=a.defaultValue(o,s.Ellipsoid.WGS84)).geodeticSurfaceNormal(i,ge.up);var f=ge.up,h=ge.east;h.x=-i.y,h.y=i.x,h.z=0,n.Cartesian3.normalize(h,ge.east),n.Cartesian3.cross(f,h,ge.north),n.Cartesian3.multiplyByScalar(ge.up,-1,ge.down),n.Cartesian3.multiplyByScalar(ge.east,-1,ge.west),n.Cartesian3.multiplyByScalar(ge.north,-1,ge.south),Ne=ge[e],Re=ge[r],Ie=ge[l]}return d[0]=Ne.x,d[1]=Ne.y,d[2]=Ne.z,d[3]=0,d[4]=Re.x,d[5]=Re.y,d[6]=Re.z,d[7]=0,d[8]=Ie.x,d[9]=Ie.y,d[10]=Ie.z,d[11]=0,d[12]=i.x,d[13]=i.y,d[14]=i.z,d[15]=1,d},Pe[d]=o),o},ve.eastNorthUpToFixedFrame=ve.localFrameToFixedFrameGenerator("east","north"),ve.northEastDownToFixedFrame=ve.localFrameToFixedFrameGenerator("north","east"),ve.northUpEastToFixedFrame=ve.localFrameToFixedFrameGenerator("north","up"),ve.northWestUpToFixedFrame=ve.localFrameToFixedFrameGenerator("north","west");var Ae=new d,Ue=new n.Cartesian3(1,1,1),ze=new t.Matrix4;ve.headingPitchRollToFixedFrame=function(e,r,i,s,o){s=a.defaultValue(s,ve.eastNorthUpToFixedFrame);var u=d.fromHeadingPitchRoll(r,Ae),l=t.Matrix4.fromTranslationQuaternionRotationScale(n.Cartesian3.ZERO,u,Ue,ze);return o=s(e,i,o),t.Matrix4.multiply(o,l,o)};var Fe=new t.Matrix4,be=new t.Matrix3;ve.headingPitchRollQuaternion=function(e,a,n,r,i){var s=ve.headingPitchRollToFixedFrame(e,a,n,r,Fe),o=t.Matrix4.getMatrix3(s,be);return d.fromRotationMatrix(o,i)};var We=new n.Cartesian3(1,1,1),qe=new n.Cartesian3,Le=new t.Matrix4,Ve=new t.Matrix4,ke=new t.Matrix3,Ye=new d;ve.fixedFrameToHeadingPitchRoll=function(e,r,i,o){r=a.defaultValue(r,s.Ellipsoid.WGS84),i=a.defaultValue(i,ve.eastNorthUpToFixedFrame),a.defined(o)||(o=new xe);var u=t.Matrix4.getTranslation(e,qe);if(n.Cartesian3.equals(u,n.Cartesian3.ZERO))return o.heading=0,o.pitch=0,o.roll=0,o;var l=t.Matrix4.inverseTransformation(i(u,r,Le),Le),c=t.Matrix4.setScale(e,We,Ve);c=t.Matrix4.setTranslation(c,n.Cartesian3.ZERO,c),l=t.Matrix4.multiply(l,c,l);var f=d.fromRotationMatrix(t.Matrix4.getMatrix3(l,ke),Ye);return f=d.normalize(f,f),xe.fromQuaternion(f,o)};var Be=u.CesiumMath.TWO_PI/86400,je=new ce;ve.computeTemeToPseudoFixedMatrix=function(e,n){var r,i=(je=ce.addSeconds(e,-ce.computeTaiMinusUtc(e),je)).dayNumber,s=je.secondsOfDay,o=i-2451545,l=(24110.54841+(r=s>=43200?(o+.5)/G.DAYS_PER_JULIAN_CENTURY:(o-.5)/G.DAYS_PER_JULIAN_CENTURY)*(8640184.812866+r*(.093104+-62e-7*r)))*Be%u.CesiumMath.TWO_PI+(72921158553e-15+11772758384668e-32*(i-2451545.5))*((s+.5*G.SECONDS_PER_DAY)%G.SECONDS_PER_DAY),d=Math.cos(l),c=Math.sin(l);return a.defined(n)?(n[0]=d,n[1]=-c,n[2]=0,n[3]=c,n[4]=d,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n):new t.Matrix3(d,c,0,-c,d,0,0,0,1)},ve.iau2006XysData=new Me,ve.earthOrientationParameters=he.NONE;var Ge=32.184;ve.preloadIcrfFixed=function(e){var t=e.start.dayNumber,n=e.start.secondsOfDay+Ge,r=e.stop.dayNumber,i=e.stop.secondsOfDay+Ge,s=ve.iau2006XysData.preload(t,n,r,i),o=ve.earthOrientationParameters.getPromiseToLoad();return a.when.all([s,o])},ve.computeIcrfToFixedMatrix=function(e,n){a.defined(n)||(n=new t.Matrix3);var r=ve.computeFixedToIcrfMatrix(e,n);if(a.defined(r))return t.Matrix3.transpose(r,n)};var Ze=new _e(0,0,0),Xe=new V(0,0,0,0,0,0),Je=new t.Matrix3,He=new t.Matrix3;ve.computeFixedToIcrfMatrix=function(e,n){a.defined(n)||(n=new t.Matrix3);var r=ve.earthOrientationParameters.compute(e,Xe);if(a.defined(r)){var i=e.dayNumber,s=e.secondsOfDay+Ge,o=ve.iau2006XysData.computeXysRadians(i,s,Ze);if(a.defined(o)){var l=o.x+r.xPoleOffset,d=o.y+r.yPoleOffset,c=1/(1+Math.sqrt(1-l*l-d*d)),f=Je;f[0]=1-c*l*l,f[3]=-c*l*d,f[6]=l,f[1]=-c*l*d,f[4]=1-c*d*d,f[7]=d,f[2]=-l,f[5]=-d,f[8]=1-c*(l*l+d*d);var h=t.Matrix3.fromRotationZ(-o.s,He),m=t.Matrix3.multiply(f,h,Je),p=e.dayNumber-2451545,y=(e.secondsOfDay-ce.computeTaiMinusUtc(e)+r.ut1MinusUtc)/G.SECONDS_PER_DAY,w=.779057273264+y+.00273781191135448*(p+y);w=w%1*u.CesiumMath.TWO_PI;var C=t.Matrix3.fromRotationZ(w,He),x=t.Matrix3.multiply(m,C,Je),_=Math.cos(r.xPoleWander),M=Math.cos(r.yPoleWander),E=Math.sin(r.xPoleWander),O=Math.sin(r.yPoleWander),S=i-2451545+s/G.SECONDS_PER_DAY,v=-47e-6*(S/=36525)*u.CesiumMath.RADIANS_PER_DEGREE/3600,D=Math.cos(v),T=Math.sin(v),P=He;return P[0]=_*D,P[1]=_*T,P[2]=E,P[3]=-M*T+O*E*D,P[4]=M*D+O*E*T,P[5]=-O*_,P[6]=-O*T-M*E*D,P[7]=O*D-M*E*T,P[8]=M*_,t.Matrix3.multiply(x,P,n)}}};var $e=new n.Cartesian4;ve.pointToWindowCoordinates=function(e,a,t,n){return(n=ve.pointToGLWindowCoordinates(e,a,t,n)).y=2*a[5]-n.y,n},ve.pointToGLWindowCoordinates=function(e,r,i,s){a.defined(s)||(s=new t.Cartesian2);var o=$e;return t.Matrix4.multiplyByVector(e,n.Cartesian4.fromElements(i.x,i.y,i.z,1,o),o),n.Cartesian4.multiplyByScalar(o,1/o.w,o),t.Matrix4.multiplyByVector(r,o,o),t.Cartesian2.fromCartesian4(o,s)};var Qe=new n.Cartesian3,Ke=new n.Cartesian3,ea=new n.Cartesian3;ve.rotationMatrixFromPositionVelocity=function(e,r,i,o){var l=a.defaultValue(i,s.Ellipsoid.WGS84).geodeticSurfaceNormal(e,Qe),d=n.Cartesian3.cross(r,l,Ke);n.Cartesian3.equalsEpsilon(d,n.Cartesian3.ZERO,u.CesiumMath.EPSILON6)&&(d=n.Cartesian3.clone(n.Cartesian3.UNIT_X,d));var c=n.Cartesian3.cross(d,r,ea);return n.Cartesian3.normalize(c,c),n.Cartesian3.cross(r,c,d),n.Cartesian3.negate(d,d),n.Cartesian3.normalize(d,d),a.defined(o)||(o=new t.Matrix3),o[0]=r.x,o[1]=r.y,o[2]=r.z,o[3]=d.x,o[4]=d.y,o[5]=d.z,o[6]=c.x,o[7]=c.y,o[8]=c.z,o};var aa=new t.Matrix4(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),ta=new r.Cartographic,na=new n.Cartesian3,ra=new n.Cartesian3,ia=new t.Matrix3,sa=new t.Matrix4,oa=new t.Matrix4;ve.basisTo2D=function(e,a,r){var i=t.Matrix4.getTranslation(a,ra),s=e.ellipsoid,o=s.cartesianToCartographic(i,ta),u=e.project(o,na);n.Cartesian3.fromElements(u.z,u.x,u.y,u);var l=ve.eastNorthUpToFixedFrame(i,s,sa),d=t.Matrix4.inverseTransformation(l,oa),c=t.Matrix4.getMatrix3(a,ia),f=t.Matrix4.multiplyByMatrix3(d,c,r);return t.Matrix4.multiply(aa,f,r),t.Matrix4.setTranslation(r,u,r),r},ve.wgs84To2DModelMatrix=function(e,a,r){var i=e.ellipsoid,s=ve.eastNorthUpToFixedFrame(a,i,sa),o=t.Matrix4.inverseTransformation(s,oa),u=i.cartesianToCartographic(a,ta),l=e.project(u,na);n.Cartesian3.fromElements(l.z,l.x,l.y,l);var d=t.Matrix4.fromTranslation(l,sa);return t.Matrix4.multiply(aa,o,r),t.Matrix4.multiply(d,r,r),r},ve.buildUp=function(e,a){var t=a.clone(),r=e.clone();r=n.Cartesian3.normalize(r,r),Math.abs(n.Cartesian3.dot(r,t))>=1&&(r=Math.abs(n.Cartesian3.dot(t,n.Cartesian3.UNIT_Y))<1?n.Cartesian3.clone(n.Cartesian3.UNIT_Y,r):n.Cartesian3.clone(n.Cartesian3.UNIT_Z,r));var i=new n.Cartesian3;return n.Cartesian3.cross(r,t,i),i=n.Cartesian3.normalize(i,i),n.Cartesian3.cross(t,i,r),r=n.Cartesian3.normalize(r,r)},ve.getHeading=function(e,a){var t;return t=u.CesiumMath.equalsEpsilon(Math.abs(e.z),1,u.CesiumMath.EPSILON3)?Math.atan2(a.y,a.x)-u.CesiumMath.PI_OVER_TWO:Math.atan2(e.y,e.x)-u.CesiumMath.PI_OVER_TWO,u.CesiumMath.TWO_PI-u.CesiumMath.zeroToTwoPi(t)},ve.convertToColumbusCartesian=function(e){var a=new s.GeographicProjection,t=a.ellipsoid,i=new n.Cartesian3,o=new r.Cartographic;return t.cartesianToCartographic(e,o),a.project(o,i),n.Cartesian3.fromElements(i.z,i.x,i.y)},ve.convertTo3DCartesian=function(e){var a=new s.GeographicProjection,t=a.ellipsoid,i=new n.Cartesian3,o=new r.Cartographic;return i=n.Cartesian3.fromElements(e.y,e.z,e.x),a.unproject(i,o),t.cartographicToCartesian(o,i)},e.Quaternion=d,e.Transforms=ve}));
