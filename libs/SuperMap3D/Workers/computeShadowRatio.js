define(["./Cartesian4-69ef58e5","./Cartographic-00721f3e","./when-b60132fc","./Math-119be1a3","./createTaskProcessorWorker","./Check-7b2a090c"],(function(r,e,a,t,n,i){"use strict";var s=new r.Cartesian4(1,1/255,1/65025,1/160581375),o=new r.Cartesian4,f=1024;function u(e,a,n,i,u,h,c){var C=e.longitude,v=e.latitude,g=e.height;if(C=t.CesiumMath.toDegrees(C),v=t.CesiumMath.toDegrees(v),C<a[0]||C>a[2]||v<a[1]||v>a[3])return-1;for(var d=!1,l=0,p=.1*i,b=0;b<=n;b+=i){if(Math.abs(u+b-g)<p){d=!0;break}l++}if(!d)return-1;if(h.length<0)return-1;d=!1;for(var m=0;m<h.length;m+=2){var k=r.Cartesian3.fromDegrees(C,v,g),w=r.Cartesian3.fromDegrees(h[m+0],h[m+1],g);if(r.Cartesian3.distance(k,w)<p){d=!0;break}}if(!d)return-1;var D=a[2]-a[0],M=(g=a[3]-a[1],a[0]-.025*D),x=a[1]-.025*g;D+=.05*D,g+=.05*g;var y=parseInt((C-M)/D*f),I=parseInt((v-x)/g*f);y=y<1?1:y,I=I<1?1:I;var P=c[l],z=0;for(m=-1;m<2;m++)for(var A=-1;A<2;A++){var B=4*(f*(I+A)+(y+m));o.x=P[B],o.y=P[B+1],o.z=P[B+2],o.w=P[B+3],r.Cartesian4.divideByScalar(o,255,o),z=Math.max(z,r.Cartesian4.dot(o,s))}return z=z>.999?1:z}return n((function(a,t){for(var n=a.points,i=a.enuPoints,s=a.bounds,o=a.extend,f=a.spacing,h=a.bottom,c=a.pixelsArray,C=[],v=0,g=n.length;v<g;v++){var d=n[v],l=u(e.Cartographic.fromCartesian(d),s,o,f,h,i,c);C.push({position:r.Cartesian3.clone(d),shadowRatio:l})}return{resultData:C}}))}));
