{"version":3,"sources":["webpack:///./src/modules/cesium/BuildScene/buss/maphandler.js","webpack:///./src/modules/cesium/BuildScene/components/Widgets/buss/Source.js","webpack:///./src/modules/cesium/BuildScene/components/menu.vue","webpack:///./src/modules/cesium/BuildScene/components/menu.vue?63f6","webpack:///./src/modules/cesium/BuildScene/components/Widgets/buss/widgets.js","webpack:///./src/modules/cesium/BuildScene/components/studio.vue","webpack:///./src/modules/cesium/BuildScene/components/studio.vue?3390","webpack:///./src/modules/cesium/BuildScene/components/Widgets/Souce.vue","webpack:///./src/modules/cesium/BuildScene/components/Widgets/Souce.vue?9e34","webpack:///./src/modules/cesium/common/buss/GroundSkyBox.js","webpack:///./src/modules/cesium/BuildScene/components/Widgets/buss/circum.js","webpack:///./src/modules/cesium/BuildScene/components/Widgets/Circum.vue","webpack:///./src/modules/cesium/BuildScene/components/Widgets/Circum.vue?0db0","webpack:///./src/modules/cesium/BuildScene/components/Widgets/buss/clock.js","webpack:///./src/modules/cesium/BuildScene/components/Widgets/clock.vue","webpack:///./src/modules/cesium/BuildScene/components/Widgets/clock.vue?9648","webpack:///./src/modules/cesium/BuildScene/buss/keyboardcontrol.js","webpack:///./src/modules/cesium/BuildScene/components/Widgets/buss/camera.js","webpack:///./src/modules/cesium/BuildScene/components/Widgets/camera.vue","webpack:///./src/modules/cesium/BuildScene/components/Widgets/camera.vue?cc4b","webpack:///./src/modules/cesium/BuildScene/components/Widgets/buss/terrainMap.js","webpack:///./src/modules/cesium/BuildScene/components/Widgets/terrainmap.vue","webpack:///./src/modules/cesium/BuildScene/components/Widgets/terrainmap.vue?8df7","webpack:///./src/modules/cesium/BuildScene/components/Widgets/buss/maptree.js","webpack:///./src/modules/cesium/BuildScene/components/Widgets/maptree.vue","webpack:///./src/modules/cesium/BuildScene/components/Widgets/maptree.vue?5ab8","webpack:///./src/modules/cesium/BuildScene/components/Widgets/widgets.vue","webpack:///./src/modules/cesium/BuildScene/components/Widgets/widgets.vue?cc20","webpack:///./src/modules/cesium/BuildScene/components/Widgets/effects.vue","webpack:///./src/modules/cesium/BuildScene/components/Widgets/effects.vue?0e22","webpack:///./src/modules/cesium/BuildScene/buss/studio.js","webpack:///./src/modules/cesium/BuildScene/components/sceneedit.vue","webpack:///./src/modules/cesium/BuildScene/components/sceneedit.vue?ffa4","webpack:///./src/modules/cesium/BuildScene/components/sceneedit.vue?b4a4","webpack:///./src/modules/cesium/BuildScene/components/Widgets/terrainmap.vue?19de","webpack:///./src/modules/cesium/BuildScene/components/Widgets/maptree.vue?eb73","webpack:///./src/modules/cesium/BuildScene/assets/img/keyboard.png","webpack:///./src/modules/cesium/BuildScene/components/Widgets/maptree.vue?2d64","webpack:///./src/modules/cesium/BuildScene/components/Widgets/Souce.vue?70f6","webpack:///./src/modules/cesium/BuildScene/components/sceneedit.vue?66b5","webpack:///./src/modules/cesium/BuildScene/components/Widgets/terrainmap.vue?5dae","webpack:///./src/modules/cesium/BuildScene/components/Widgets/Souce.vue?b7e0","webpack:///./src/modules/cesium/BuildScene/components/studio.vue?05dd","webpack:///./src/modules/cesium/BuildScene/components/Widgets/widgets.vue?23f0"],"names":["translate","element","translatestrlist","childNodes","forEach","ele","length","find","item","textContent","GlobalState","viewer","CesiumViewer","imageryList","containerId","mode","options","contextOptions","webgl","alpha","depth","stencil","antialias","premultipliedAlpha","preserveDrawingBuffer","failIfMajorPerformanceCaveat","selectionIndicator","animation","geocoder","infoBox","shouldAnimate","shadows","Cesium","Ion","defaultAccessToken","Viewer","scene","shadowMap","darkness","maximumDistance","globe","enableLighting","context","willReadFrequently","tooltipcontainer","homeButton","_container","_element","title","insertBefore","fullscreenButton","lastElementChild","classList","add","remove","viewModel","fullscreenElement","document","getElementById","navigationHelpButton","_wrapper","zoominele","createElement","onclick","Camera","GetCamera","camera","zoomIn","height","innerHTML","sceneModePicker","zoomoutele","zoomOut","northinele","id","postRender","addEventListener","scenemode","headingdeg","heading","style","setProperty","wgs84poi","CoordinateWGS84","longitude","latitude","wgs84poinew","GetPointOnSameCircle","pitch","FlyToWithDuration","roll","baseLayerPicker","nextSibling","originvms","_viewModel","imageryProviderViewModels","push","ProviderViewModel","name","category","iconUrl","tooltip","creationFunction","_creationCommand","Tdtkey","imgsettings","createf","UrlTemplateImageryProvider","url","subdomains","WebMapTileServiceImageryProvider","layer","format","tileMatrixSetID","maximumLevel","show","splice","originvts","terrainProviderViewModels","ArcGISTiledElevationTerrainProvider","token","skyAtmosphere","fog","enabled","layers","Array","isArray","some","imageryLayers","addImageryProvider","mapcontainerbtns","timeline","container","prototype","clone","JSON","parse","stringify","this","skyBox","_cesiumWidget","_creditContainer","display","depthTestAgainstTerrain","cesiumWidget","screenSpaceEventHandler","removeInputAction","ScreenSpaceEventType","LEFT_DOUBLE_CLICK","FeatureDetection","supportsImageRenderingPixelated","resolutionScale","window","devicePixelRatio","fxaa","postProcessStages","handler","ScreenSpaceEventHandler","canvas","setInputAction","movement","cartesian","pickPosition","position","cartographic","Ellipsoid","WGS84","cartesianToCartographic","lon","Math","toDegrees","lat","campt","console","log","camlon","camlat","LEFT_CLICK","wheelState","RIGHT_DOWN","RIGHT_UP","time","timeout","clearTimeout","Bus","VM","$emit","SignalType","Scene_Mouse_DoubleLeft_Click","setTimeout","Scene_Mouse_Left_Click","Scene_Mouse_Right_Click","RIGHT_CLICK","Scene_Mouse_Move","Scene_Mouse_Middle_Move","MOUSE_MOVE","Scene_Left_Down","LEFT_DOWN","Scene_Left_Up","LEFT_UP","changed","Scene_Init_Finish","headingnew","planedis","tan","toRadians","mercatorpoi","CoordinateMercator","fromWGS84","x1","Mercator_X","cos","y1","Mercator_Y","sin","fromMercatorxyh","ellipsoid","cartesian3","lng","alt","duration","flyTo","destination","Cartesian3","fromDegrees","orientation","maximumHeight","duraion","GetPickedRayPositionWGS84","pos","ray","getPickRay","direction","x","y","z","pick","feature","defined","fromCatesianWithCartographic","fromCatesian","MoonLightSettings","ShadowDistance","OriginShadowDis","LightIntensity","OriginLightIntensity","LightTemp","OriginLightTemp","Color","WHITE","OriginColor","SunLightSettings","Object","defineProperty","get","toCssColorString","set","value","fromCssColorString","soucesettings","state","remark","dataTag","thumbnailUrl","thumbnailsrc","actions","filepath","scope","InitSouceSt","settings","setThumbnailUrl","CaptureUploadImg","callback","$promise","capturescreen","then","blob","URL","createObjectURL","Promise","resolve","reject","scalefac","len","min","width","center","lefttop","image","Image","src","toDataURL","onload","newCanvas","ctx","getContext","scale","drawImage","toBlob","blod","souSt","emit","props","activeIndex","curmenu","handleSelect","key","keyPath","share","preview","save","__exports__","tooltipbtns","othersettings","statusbar","lonlat","lod","cameraheight","fps","lonlatpre","scaleleft","scaleright","scaletop","scalebottom","statusbarstrs","scalebarstr","timecontrolstrs","currenttime","shouldanimate","timeformat","step","getters","result","timelineshow","originshow","settimelinevisib","$off","onscenemousemovegetlonlat","removeEventListener","onrenderlist","_fpsFrameCount","$on","_lastFpsTm","Date","subele","left","clock","onTick","onmapclocktick","JulianDate","now","currentTime","multiplier","visible","parentNode","removeChild","right","appendChild","e","wgspos","endPosition","toFixed","curtimesp","fpstime","parseInt","tilesToRender","_surface","_tilesToRender","level","onscalerenderlist","centerw","wgs1","wgs2","dis","distance","ToCartesian","toDate","SetScaleBarShow","InitBtns","btn","index","oriresizef","resize","apply","GetSettings","$state","findindex","ind","findIndex","showindex","nextidx","i","hidenindex","setindexvisib","visibility","SetToolbarBtnShow","curindex","otS","getscalestyle","horizon","vertical","tags","onclickcapture","filePath","SkyBoxFS","SkyBoxVS","Matrix4","getRotation","getMatrix3","skyboxMatrix3","Matrix3","SkyBox","sources","_sources","undefined","isRotate","rotate","speed","rotateSpeed","defaultValue","_command","DrawCommand","modelMatrix","IDENTITY","owner","_cubeMap","_attributeLocations","_useHdr","update","frameState","useHdr","that","SceneMode","SCENE3D","MORPHING","passes","render","positiveX","negativeX","positiveY","negativeY","positiveZ","negativeZ","DeveloperError","loadCubeMap","cubeMap","destroy","CubeMap","source","command","Transforms","eastNorthUpToFixedFrame","_positionWC","vertexArray","uniformMap","u_cubeMap","u_rotateMatrix","u_speed","u_rotate","geometry","BoxGeometry","createGeometry","fromDimensions","dimensions","vertexFormat","VertexFormat","POSITION_ONLY","attributeLocations","GeometryPipeline","createAttributeLocations","VertexArray","fromGeometry","bufferUsage","BufferUsage","STATIC_DRAW","renderState","RenderState","fromCache","blending","BlendingState","ALPHA_BLEND","shaderProgram","fs","ShaderSource","defines","ShaderProgram","vertexShaderSource","fragmentShaderSource","isDestroyed","destroyObject","sunsetting","_sunPositionWC","_sunDirectionWC","_sunPositionColumbusView","circumsettings","showSun","showMoon","backmode","backmodepars","skyboxnum","skyboxrotate","skyboxrs","colorcss","outatm","earthatm","highdyren","globalcol","fixedlight","shadow","terrainsh","showdaynight","depthtest","GroundSkyBox","backgroundColor","sun","moon","SCENE2D","COLUMBUS_VIEW","showGroundAtmosphere","highDynamicRange","baseColor","setSunAndMoonDirections","fromDate","_frameState","mapProjection","light","DirectionalLight","SunLight","terrainShadows","ShadowMode","ENABLED","DISABLED","InitCircumSt","SetBackModes","SetSunShow","SetMoonShow","SetSceneMode","SetOutAtmos","SetGoundAtmos","SetFog","SetHdr","SetGlobeColor","SetFixLight","SetShadow","SetTerrainShadow","SetDayNight","SetFxaa","SetDepthTest","transformMatrix","sunCartographicScratch","Cartographic","computeIcrfToFixedMatrix","computeTemeToPseudoFixedMatrix","Simon1994PlanetaryPositions","computeSunPositionInEarthInertialFrame","multiplyByVector","normalize","projection","sunCartographic","project","crSt","activeNames","newval","oldval","deep","clocksettings","starttime","endtime","timemode","curtime","multiply","startTime","stopTime","clockRange","ClockRange","UNBOUNDED","CLAMPED","LOOP_STOP","InitClockSt","SetStartTime","SetEndTime","SetTimeMode","SetCurTime","SetMultiply","clSt","rotate2","anglerad","p","Cartesian2","m","Matrix2","fromRotation","rotated","instance","flags","moveForward","moveBackward","moveUp","moveDown","moveLeft","moveRight","centerRotateFor","centerRotateBak","centerRotateUp","centerRotateDown","centerRotateClock","centerRotateUnClock","cameraRotateUp","cameraRotateDown","cameraRotateLeft","cameraRotateRight","getFlagForKeyCode","keyCode","charCodeAt","pars","panstep","centerrotatestep","camerarotatestep","minpitch","maxpitch","minhei","keydown","flagName","keyup","rotatecamera","addheading","addpitch","c","setView","rotatecenter","centerwgs","target","lc","CoordinateLocal","FromCartesian","xyn","ty","sqrt","pzn","panonplane","angle","d","d1","l","xy","d2","move","ontick","curcamera","PI","wgs","h","control","camerasettings","originlon","originlat","originhei","originheading","originpitch","originroll","zoomF","minizoomdis","maxizoomdis","minicolhei","allowrotate","allowtranslate","allowtilt","allowzoom","rightrotate","allowkeyboard","zoomto","f","beforeExecute","_listeners","cancel","screenSpaceCameraController","_zoomFactor","minimumZoomDistance","maximumZoomDistance","minimumCollisionTerrainHeight","enableRotate","enableTranslate","enableTilt","enableZoom","rotateEventTypes","CameraEventType","LEFT_DRAG","RIGHT_DRAG","zoomEventTypes","WHEEL","PINCH","getInstance","SetParams","SetControl","InitCameraSt","SetOriginCamera","SetZoomF","SetMiniZoomDis","SetMaxiZoomDis","SetMiniColHeight","SetAllowRotate","SetAllowTranslate","SetAllowTilt","SetAllowZoom","SetRightRotate","SetAllowkeyboard","cmSt","getElevationContourMaterial","Material","fabric","type","materials","contourMaterial","elevationRampMaterial","components","diffuse","translucent","getSlopeContourMaterial","slopeRampMaterial","getAspectContourMaterial","aspectRampMaterial","terrainsettings","showterrain","terrainname","shownetwork","terrainexa","showcontour","contourstep","contourwidth","contourcss","groundrender","rendertype","imagestripe","minranphei","maxranphei","colorramps","enableunder","globea","SetTerrain","selectedTerrain","tileProvider","_debug","wireframe","terrainExaggeration","duan","per","sets","color","ramp","colorsts","getcolorrampst","grd","createLinearGradient","colorst","addColorStop","fillStyle","fillRect","material","contourUniforms","shadingUniforms","fromType","uniforms","minimumHeight","spacing","getcolorrampimage","translucency","frontFaceAlpha","enableCollisionDetection","InitTerrainSettigns","SetShowTerrain","SetShowNetWork","SetTerrainExa","SetGlobeMaterial","SetGroundA","SetEnableUnder","trSt","dialogactivename","showselectlayerdialog","selectedterrainname","onlineterrains","getcolorrampstyle","dropdown","re","map","toString","join","opendia","handleDialogTabClick","handleselectedclick","onterrainchanged","maptreesettings","treedata","label","children","InitMaptreeSt","InitTreeData","mtSt","showfolder","pagesize","pageno","layernum","shf","querylayers","home","compass","zoominout","imapk","fullsize","navi","SetTimelineShow","SetStatusBarShow","SetAnimationBarShow","script","Init","widgetst","circumst","clockst","camerast","terrainst","maptreest","SCENEBUILDINIT","menuprop","logourl","handlemenuchange","val","module","exports"],"mappings":"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","file":"js/chunk-1cab980e.5e9d706f.js","sourcesContent":["\r\nimport Bus from '@/common/buss/Bus'\r\nimport {reactive} from 'vue'\r\n\r\nimport coordinates from '@/common/util/Coordinates'\r\n\r\nfunction translate(element, translatestrlist) {\r\n\telement.childNodes.forEach(ele => {\r\n\t\tif (ele.childNodes.length == 0) {\r\n\t\t\tconst find = translatestrlist.find(item => item[0] == ele.textContent);\r\n\t\t\tif (find) {\r\n\t\t\t\tele.textContent = find[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttranslate(ele, translatestrlist);\r\n\t\t}\r\n\t})\r\n}\r\n\r\nexport const GlobalState={\r\n\tviewer:null,\r\n}\r\n\r\nexport function CesiumViewer(imageryList, containerId = \"CesiumMap\", mode) {\r\ndebugger\r\n\tlet options = {\r\n\t\tcontextOptions: {\r\n\t\t\twebgl: {\r\n\t\t\t\talpha: true,\r\n\t\t\t\tdepth: true,\r\n\t\t\t\tstencil: true,\r\n\t\t\t\tantialias: true,\r\n\t\t\t\tpremultipliedAlpha: true,\r\n\t\t\t\t//通过canvas.toDataURL()实现截图需要将该项设置为true\r\n\t\t\t\tpreserveDrawingBuffer: true,\r\n\t\t\t\tfailIfMajorPerformanceCaveat: true\r\n\t\t\t}\r\n\t\t},\r\n\t\tselectionIndicator: false,\r\n\t\tanimation: false, //是否显示动画控件\r\n\t\t// imageryProvider:false,\r\n\t\t// baseLayerPicker: false, //是否显示图层选择控件\r\n\t\tgeocoder: false, //是否显示地名查找控件\r\n\t\t// timeline: false, //是否显示时间线控件\r\n\t\t// sceneModePicker: false, //模式切换\r\n\t\t// navigationHelpButton: false, //是否显示帮助信息控件\r\n\t\tinfoBox: false, //是否显示点击要素之后显示的信息\r\n\t\t// fullscreenButton: false, //全屏\r\n\t\t// homeButton: false, //主页,\r\n\t\tshouldAnimate: true,\r\n\t\tshadows: true,\r\n\r\n\t};\r\n\t//超图修改球\r\n\t// var obj = [6378137.0, 6378137.0, 6356752.3142451793];\r\n\t// Cesium.Ellipsoid.WGS84 = Object.freeze(new Cesium.Ellipsoid(obj[0], obj[1], obj[2]));\r\n\tCesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIyNThiOTQ5Yi04OTkzLTQzZWUtOTJlMC01OTQxNGU0YzMxZWIiLCJpZCI6NzY2OCwic2NvcGVzIjpbImFzciIsImdjIl0sImlhdCI6MTU1NDE2OTI3Nn0.5Q_q6jBgYzvO_EKF8V8ypFOkwEc92rLSb9weyeTKoBg';\r\n\r\n\tlet viewer = new Cesium.Viewer(containerId, options);\r\n\tGlobalState.viewer = viewer;\r\n\t// viewer.camera.setView({\r\n\t// \tdestination: Cesium.Cartesian3.fromDegrees(110.603252444485, 27.941885505227617, 9491663.9170652),\r\n\t// \torientation: {\r\n\t// \t\theading: 6.127,\r\n\t// \t\tpitch: -1.57,\r\n\t// \t\troll: 0.0\r\n\t// \t}\r\n\t// })\r\n\tviewer.scene.shadowMap.darkness = 0.5;\r\n\tviewer.scene.shadowMap.maximumDistance = 1000;\r\n\tviewer.scene.globe.enableLighting = true;\r\n\tviewer.scene.context.willReadFrequently = true;\r\n\r\n\tviewer.tooltipcontainer=viewer.homeButton._container;\r\n\r\n\r\n\t// //timeline\r\n\t// var ssss=viewer.timeline.container;\r\n\r\n\r\n\tviewer.homeButton._element.title = \"初始视图\";\r\n\r\n\t// viewer.homeButton.viewModel.command.beforeExecute.addEventListener(function (e) {\r\n\t// \te.cancel = true;\r\n\t// \tviewer.camera.flyTo({\r\n\t// \t\tdestination: Cesium.Cartesian3.fromDegrees(110.603252444485, 27.941885505227617, 9491663.9170652),\r\n\t// \t\torientation: {\r\n\t// \t\t\theading: 6.127,\r\n\t// \t\t\tpitch: -1.57,\r\n\t// \t\t\troll: 0.0\r\n\t// \t\t}\r\n\t// \t});\r\n\t// })\r\n\r\n\r\n\r\n\t//全屏\r\n\tviewer.homeButton._container.insertBefore(viewer.fullscreenButton._container, viewer.homeButton._container.lastElementChild);\r\n\r\n\r\n\tviewer.fullscreenButton._container.classList.add('cesium-toolbar-button');\r\n\tviewer.fullscreenButton._container.classList.add('cesium-button');\r\n\tviewer.fullscreenButton._container.classList.remove('cesium-viewer-fullscreenContainer');\r\n\tviewer.fullscreenButton.viewModel.fullscreenElement=document.getElementById('studiocontainer');\r\n\r\n\ttranslate(viewer.navigationHelpButton._wrapper, [\r\n\t\t['Mouse', '鼠标'],\r\n\t\t['Touch', '触摸手势'],\r\n\t\t['Pan view', '平移视图'],\r\n\t\t['Left click + drag', '鼠标左键+拖拽'],\r\n\t\t['Zoom view', '缩放视图'],\r\n\t\t['Right click + drag, or', '右键+拖拽，或者'],\r\n\t\t['Mouse wheel scroll', '中键滚动'],\r\n\t\t['Rotate view', '旋转视图'],\r\n\t\t['Middle click + drag, or', '中键按下拖拽，或者'],\r\n\t\t['CTRL + Left/Right click + drag', '按Ctrl键同时 左/右键拖拽'],\r\n\t\t['One finger drag', '单指拖动'],\r\n\t\t['Two finger pinch', '双指向内或向外滑动'],\r\n\t\t['Tilt view', '倾斜视图'],\r\n\t\t['Two finger drag, same direction', '双指按相同方向拖动'],\r\n\t\t['Two finger drag, opposite direction', '双指按相反方向拖动'],\r\n\t]);\r\n\r\n\r\n\r\n\r\n\t//放大\r\n\tvar zoominele = document.createElement(\"div\");\r\n\tzoominele.classList.add('cesium-toolbar-button');\r\n\tzoominele.classList.add('cesium-button');\r\n\tzoominele.onclick = function () {\r\n\t\tlet Camera = GetCamera();\r\n\t\tviewer.camera.zoomIn(Camera.height/10);\r\n\t};\r\n\tzoominele.innerHTML = `<div><svg width=\"24\" height=\"24\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"48\" height=\"48\" fill=\"white\" fill-opacity=\"0.01\"></rect><path d=\"M24.0607 10L24.024 38\" stroke=\"#ffffff\" stroke-width=\"5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path> <path d=\"M10 24L38 24\" stroke=\"#ffffff\" stroke-width=\"5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg></div>`;\r\n\tviewer.homeButton._container.insertBefore(zoominele, viewer.sceneModePicker._wrapper);\r\n\t//缩小\r\n\tvar zoomoutele = document.createElement(\"div\");\r\n\tzoomoutele.classList.add('cesium-toolbar-button');\r\n\tzoomoutele.classList.add('cesium-button');\r\n\tzoomoutele.onclick=function(){\r\n\t\tlet Camera = GetCamera();\r\n\t\tviewer.camera.zoomOut(Camera.height/10);\r\n\t}\r\n\tzoomoutele.innerHTML = `<div><svg width=\"24\" height=\"24\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"48\" height=\"48\" fill=\"white\" fill-opacity=\"0.01\"></rect><path d=\"M10.5 24L38.5 24\" stroke=\"#ffffff\" stroke-width=\"5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg></div>`;\r\n\r\n\t//罗盘\r\n\tvar northinele = document.createElement(\"div\");\r\n\tnorthinele.classList.add('cesium-toolbar-button');\r\n\tnorthinele.classList.add('cesium-button');\r\n\tnorthinele.id='NothinBtn';\r\n\tviewer.scene.postRender.addEventListener(function () {\r\n\t\tlet scenemode = viewer.scene.mode;\r\n\t\tif (scenemode == 3 || scenemode == 1) {\r\n\t\t\tlet headingdeg = GetCamera().heading;\r\n\t\t\tnorthinele.style.setProperty('--rotatedeg',headingdeg + \"deg\");\r\n\t\t}\r\n\t});\r\n\tnorthinele.onclick=function(){\r\n\t\tlet camera = GetCamera();\r\n\t\tlet wgs84poi = new coordinates.CoordinateWGS84(camera.longitude, camera.latitude, camera.height);\r\n\t\tlet wgs84poinew =GetPointOnSameCircle(wgs84poi, camera.heading, 0, camera.pitch);\r\n\t\tFlyToWithDuration(wgs84poinew.latitude, wgs84poinew.longitude, camera.height, 0, camera.pitch, camera.roll, -1);\r\n\t}\r\n\tviewer.homeButton._container.insertBefore(northinele, zoominele);\r\n\r\n\t//修改图层选择\r\n\tviewer.homeButton._container.insertBefore(zoomoutele, viewer.sceneModePicker._wrapper);\r\n\ttranslate(viewer.baseLayerPicker._element.nextSibling, [\r\n\t\t['Imagery', '影像'],\r\n\t\t['Terrain', '地形服务'],\r\n\t]);\r\n\tconst originvms = viewer.baseLayerPicker._viewModel.imageryProviderViewModels;\r\n\tviewer.baseLayerPicker._viewModel.imageryProviderViewModels = [];\r\n\toriginvms.forEach(item => {\r\n\t\tviewer.baseLayerPicker._viewModel.imageryProviderViewModels.push(new Cesium.ProviderViewModel({\r\n\t\t\tname: item.name,\r\n\t\t\tcategory: '',\r\n\t\t\ticonUrl: item.iconUrl,\r\n\t\t\ttooltip: item.tooltip,\r\n\t\t\tcreationFunction: item._creationCommand\r\n\t\t}))\r\n\t});\r\n\tconst Tdtkey = \"507fb0c40dd915b2c0bed8a7c42300cb\";\r\n\tconst imgsettings = [\r\n\t\t// {\r\n\t\t// \tname: \"百度矢量标注\", createf: function () {\r\n\t\t// \t\treturn [new BaiduImageryProvider({\r\n\t\t// \t\t\turl: \"https://ss1.bdstatic.com/8bo_dTSlR1gBo1vgoIiO_jowehsv/tile/?qt=vtile&x={x}&y={y}&z={z}&styles=pl&scaler=1&showtext=0\",\r\n\t\t// \t\t}), new BaiduImageryProvider({\r\n\t\t// \t\t\turl: \"https://ss1.bdstatic.com/8bo_dTSlR1gBo1vgoIiO_jowehsv/tile/?qt=vtile&x={x}&y={y}&z={z}&styles=sl&scaler=1&showtext=1\",\r\n\t\t// \t\t})];\r\n\t\t// \t}\r\n\t\t// },\r\n\t\t// {\r\n\t\t// \tname: \"百度影像标注\", createf: function () {\r\n\t\t// \t\treturn [new BaiduImageryProvider({\r\n\t\t// \t\t\turl: \"http://shangetu{s}.map.bdimg.com/it/u=x={x};y={y};z={z};v=009;type=sate&fm=46\",\r\n\t\t// \t\t}), new BaiduImageryProvider({\r\n\t\t// \t\t\turl: \"https://ss1.bdstatic.com/8bo_dTSlR1gBo1vgoIiO_jowehsv/tile/?qt=vtile&x={x}&y={y}&z={z}&styles=sl&scaler=1&showtext=1\",\r\n\t\t// \t\t})]\r\n\t\t// \t}\r\n\t\t// },\r\n\t\t// {\r\n\t\t// \tname: \"百度影像底图\", createf: function () {\r\n\t\t// \t\treturn new BaiduImageryProvider({\r\n\t\t// \t\t\turl: \"http://shangetu{s}.map.bdimg.com/it/u=x={x};y={y};z={z};v=009;type=sate&fm=46\",\r\n\t\t// \t\t})\r\n\t\t// \t}\r\n\t\t// },\r\n\t\t// {\r\n\t\t// \tname: \"百度矢量底图\", createf: function () {\r\n\t\t// \t\treturn new BaiduImageryProvider({\r\n\t\t// \t\t\turl: \"https://ss1.bdstatic.com/8bo_dTSlR1gBo1vgoIiO_jowehsv/tile/?qt=vtile&x={x}&y={y}&z={z}&styles=pl&scaler=1&showtext=0\",\r\n\t\t// \t\t})\r\n\t\t// \t}\r\n\t\t// },\r\n\t\t{\r\n\t\t\tname: \"高德影像\", createf: function () {\r\n\t\t\t\treturn new Cesium.UrlTemplateImageryProvider({\r\n\t\t\t\t\turl: \"http://{s}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&style=6\",\r\n\t\t\t\t\tsubdomains: ['webst01', 'webst02', 'webst03', 'webst04'],\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: \"高德矢量标注\", createf: function () {\r\n\t\t\t\treturn [new Cesium.UrlTemplateImageryProvider({\r\n\t\t\t\t\turl: \"http://{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}\",\r\n\t\t\t\t\tsubdomains: ['webrd01', 'webrd02', 'webrd03', 'webrd04'],\r\n\t\t\t\t}), new Cesium.UrlTemplateImageryProvider({\r\n\t\t\t\t\turl: \"http://{s}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&style=8\",\r\n\t\t\t\t\tsubdomains: ['webst01', 'webst02', 'webst03', 'webst04'],\r\n\t\t\t\t})]\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: \"高德影像标注\", createf: function () {\r\n\t\t\t\treturn [new Cesium.UrlTemplateImageryProvider({\r\n\t\t\t\t\turl: \"http://{s}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&style=6\",\r\n\t\t\t\t\tsubdomains: ['webst01', 'webst02', 'webst03', 'webst04'],\r\n\t\t\t\t}), new Cesium.UrlTemplateImageryProvider({\r\n\t\t\t\t\turl: \"http://{s}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&style=8\",\r\n\t\t\t\t\tsubdomains: ['webst01', 'webst02', 'webst03', 'webst04'],\r\n\t\t\t\t})]\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: \"天地图矢量标注\", createf: function () {\r\n\t\t\t\treturn [new Cesium.WebMapTileServiceImageryProvider({\r\n\t\t\t\t\turl: \"http://t{s}.tianditu.com/vec_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=vec&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default.jpg&tk=\" + Tdtkey,\r\n\t\t\t\t\tsubdomains: ['0', '1', '2', '3', '4', '5', '6', '7'],\r\n\t\t\t\t\tlayer: \"tdtVecLayer\",\r\n\t\t\t\t\tstyle: \"default\",\r\n\t\t\t\t\tformat: \"image/jpeg\",\r\n\t\t\t\t\ttileMatrixSetID: \"GoogleMapsCompatible\",\r\n\t\t\t\t\tmaximumLevel: 18,\r\n\t\t\t\t\tshow: true\r\n\t\t\t\t}), new Cesium.WebMapTileServiceImageryProvider({\r\n\t\t\t\t\turl: \"http://t{s}.tianditu.com/cva_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cva&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default.jpg&tk=\" + Tdtkey,\r\n\t\t\t\t\tsubdomains: ['0', '1', '2', '3', '4', '5', '6', '7'],\r\n\t\t\t\t\tlayer: \"tdtCvaLayer\",\r\n\t\t\t\t\tstyle: \"default\",\r\n\t\t\t\t\tformat: \"image/jpeg\",\r\n\t\t\t\t\ttileMatrixSetID: \"GoogleMapsCompatible\",\r\n\t\t\t\t\tmaximumLevel: 18,\r\n\t\t\t\t\tshow: true\r\n\t\t\t\t})]\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: \"天地图影像底图\", createf: function () {\r\n\t\t\t\treturn new Cesium.WebMapTileServiceImageryProvider({\r\n\t\t\t\t\t//影像底图\r\n\t\t\t\t\turl: \"http://t{s}.tianditu.com/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk=\" + Tdtkey,\r\n\t\t\t\t\tsubdomains: ['0', '1', '2', '3', '4', '5', '6', '7'],\r\n\t\t\t\t\tlayer: \"tdtImgLayer\",\r\n\t\t\t\t\tstyle: \"default\",\r\n\t\t\t\t\tformat: \"image/jpeg\",\r\n\t\t\t\t\ttileMatrixSetID: \"GoogleMapsCompatible\",\r\n\t\t\t\t\tmaximumLevel: 18,\r\n\t\t\t\t\tshow: true\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: \"天地图矢量底图\", createf: function () {\r\n\t\t\t\treturn new Cesium.WebMapTileServiceImageryProvider({\r\n\t\t\t\t\turl: \"http://t{s}.tianditu.com/vec_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=vec&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default.jpg&tk=\" + Tdtkey,\r\n\t\t\t\t\tsubdomains: ['0', '1', '2', '3', '4', '5', '6', '7'],\r\n\t\t\t\t\tlayer: \"tdtVecLayer\",\r\n\t\t\t\t\tstyle: \"default\",\r\n\t\t\t\t\tformat: \"image/jpeg\",\r\n\t\t\t\t\ttileMatrixSetID: \"GoogleMapsCompatible\",\r\n\t\t\t\t\tmaximumLevel: 18,\r\n\t\t\t\t\tshow: true\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: \"天地图影像标注\", createf: function () {\r\n\t\t\t\treturn [new Cesium.WebMapTileServiceImageryProvider({\r\n\t\t\t\t\t//影像底图\r\n\t\t\t\t\turl: \"http://t{s}.tianditu.com/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk=\" + Tdtkey,\r\n\t\t\t\t\tsubdomains: ['0', '1', '2', '3', '4', '5', '6', '7'],\r\n\t\t\t\t\tlayer: \"tdtImgLayer\",\r\n\t\t\t\t\tstyle: \"default\",\r\n\t\t\t\t\tformat: \"image/jpeg\",\r\n\t\t\t\t\ttileMatrixSetID: \"GoogleMapsCompatible\",\r\n\t\t\t\t\tmaximumLevel: 18,\r\n\t\t\t\t\tshow: true\r\n\t\t\t\t}), new Cesium.WebMapTileServiceImageryProvider({\r\n\t\t\t\t\turl: \"http://t{s}.tianditu.com/cia_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cia&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default.jpg&tk=\" + Tdtkey,\r\n\t\t\t\t\tsubdomains: ['0', '1', '2', '3', '4', '5', '6', '7'],\r\n\t\t\t\t\tlayer: \"tdtCiaLayer\",\r\n\t\t\t\t\tstyle: \"default\",\r\n\t\t\t\t\tformat: \"image/jpeg\",\r\n\t\t\t\t\ttileMatrixSetID: \"GoogleMapsCompatible\",\r\n\t\t\t\t\tmaximumLevel: 18,\r\n\t\t\t\t\tshow: true\r\n\t\t\t\t})]\r\n\t\t\t}\r\n\t\t},\r\n\t];\r\n\timgsettings.forEach(item => {\r\n\t\tviewer.baseLayerPicker._viewModel.imageryProviderViewModels.splice(0, 0, new Cesium.ProviderViewModel({\r\n\t\t\tname: item.name,\r\n\t\t\tcategory: '',\r\n\t\t\ticonUrl:'/images/cesium/Buildscene/'+item.name+'.png',\r\n\t\t\t//iconUrl: new URL('../assets/img/' + item.name + '.png', import.meta.url).href,\r\n\t\t\ttooltip: item.name,\r\n\t\t\tcreationFunction: item.createf\r\n\t\t}));\r\n\t})\r\n\tconst originvts = viewer.baseLayerPicker._viewModel.terrainProviderViewModels;\r\n\tviewer.baseLayerPicker._viewModel.terrainProviderViewModels = [];\r\n\toriginvts.forEach(item => {\r\n\t\tviewer.baseLayerPicker._viewModel.terrainProviderViewModels.push(new Cesium.ProviderViewModel({\r\n\t\t\tname: item.name=='Cesium World Terrain'?'Cesium':(item.name=='WGS84 Ellipsoid'?'None':item.name),\r\n\t\t\tcategory: '',\r\n\t\t\ticonUrl: item.iconUrl,\r\n\t\t\ttooltip: item.tooltip,\r\n\t\t\tcreationFunction: item._creationCommand\r\n\t\t}))\r\n\t});\r\n\tviewer.baseLayerPicker._viewModel.terrainProviderViewModels.push(new Cesium.ProviderViewModel({\r\n\t\tname: 'ArcGIS地形',\r\n\t\tcategory: '',\r\n\t\t// iconUrl: new URL('../assets/img/arcgisterrain.png', import.meta.url).href,\r\n\t\ticonUrl: '/images/cesium/Buildscene/arcgisterrain.png',\r\n\t\ttooltip: 'ArcGIS地形',\r\n\t\tcreationFunction: function () {\r\n\t\t\t// return Cesium.ArcGISTiledElevationTerrainProvider.fromUrl(\"https://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer\", {\r\n\t\t\t// \ttoken: \"KED1aF_I4UzXOHy3BnhwyBHU4l5oY6rO6walkmHoYqGp4XyIWUd5YZUC1ZrLAzvV40pR6gBXQayh0eFA8m6vPg..\"\r\n\t\t\t// })\r\n\t\t\treturn new Cesium.ArcGISTiledElevationTerrainProvider({\r\n\t\t\t\turl : 'https://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer',\r\n\t\t\t\ttoken : 'KED1aF_I4UzXOHy3BnhwyBHU4l5oY6rO6walkmHoYqGp4XyIWUd5YZUC1ZrLAzvV40pR6gBXQayh0eFA8m6vPg..'\r\n\t\t\t});\r\n\t\t}\r\n\t}))\r\n\tviewer.scene.skyAtmosphere.show = false;\r\n\tviewer.scene.fog.enabled = false;\r\n\t// 添加底图\r\n\tviewer.layers = [];\r\n\tif (Array.isArray(imageryList) && imageryList.length > 0) {\r\n\t\t// viewer.imageryLayers.removeAll();\r\n\t\timageryList.some((item) => {\r\n\t\t\tlet layer = viewer.imageryLayers.addImageryProvider(item);\r\n\t\t\t// viewer.imageryLayers.lowerToBottom(layer);\r\n\t\t\tviewer.layers.push(layer);\r\n\t\t});\r\n\t}\r\n\r\n\r\n\tviewer.mapcontainerbtns=[];\r\n\tviewer.mapcontainerbtns.push([viewer.homeButton._element]);\r\n\tviewer.mapcontainerbtns.push([northinele]);\r\n\tviewer.mapcontainerbtns.push([zoominele,zoomoutele]);\r\n\tviewer.mapcontainerbtns.push([viewer.sceneModePicker._wrapper]);\r\n\tviewer.mapcontainerbtns.push([viewer.baseLayerPicker._element,viewer.baseLayerPicker._element.nextSibling]);\r\n\tviewer.mapcontainerbtns.push([viewer.fullscreenButton._container]);\r\n\tviewer.mapcontainerbtns.push([viewer.navigationHelpButton._wrapper]);\r\n\tviewer.mapcontainerbtns.push([viewer.timeline.container]);\r\n\r\n\r\n\r\n\t// 列表复制\r\n\tArray.prototype.clone = function () {\r\n\t\treturn JSON.parse(JSON.stringify(this));\r\n\t};\r\n\tviewer.scene.skyBox.show = true;\r\n\t// viewer.scene.skyAtmosphere.show = false;\r\n\tviewer._cesiumWidget._creditContainer.style.display = \"none\"; //取消版权信息\r\n\tviewer.scene.globe.depthTestAgainstTerrain = true;\r\n\t//去除默认双击事件\r\n\tviewer.cesiumWidget.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK);\r\n\t//设置鼠标中键\r\n\t// viewer.scene.screenSpaceCameraController.zoomEventTypes = [Cesium.CameraEventType.WHEEL, Cesium.CameraEventType.PINCH];\r\n\t// viewer.scene.screenSpaceCameraController.tiltEventTypes = [Cesium.CameraEventType.PINCH, Cesium.CameraEventType.RIGHT_DRAG];\r\n\t//开启抗锯齿\r\n\tif (Cesium.FeatureDetection.supportsImageRenderingPixelated()) {\r\n\t\t//判断是否支持图像渲染像素化处理\r\n\t\tviewer.resolutionScale = window.devicePixelRatio;\r\n\t}\r\n\tviewer.scene.fxaa = true;\r\n\tviewer.scene.postProcessStages.fxaa.enabled = true;\r\n\t// viewer.scene.globe.baseColor = new Cesium.Color(0, 0, 0, 0);\r\n\tlet handler = new Cesium.ScreenSpaceEventHandler(viewer.canvas);\r\n\thandler.setInputAction(function (movement) {\r\n\t\tlet cartesian = viewer.scene.pickPosition(movement.position);\r\n\t\tif (cartesian) {\r\n\t\t\tlet cartographic = Cesium.Ellipsoid.WGS84.cartesianToCartographic(cartesian);\r\n\t\t\tlet lon = Cesium.Math.toDegrees(cartographic.longitude);\r\n\t\t\tlet lat = Cesium.Math.toDegrees(cartographic.latitude);\r\n\t\t\tlet height = cartographic.height;\r\n\t\t\t// let extent = getExtent(viewer);\r\n\t\t\t// let padding = [0, 0, 0, 0];\r\n\t\t\t// let topOffset = degreeToMeter(extent[3] - lat);\r\n\t\t\t// let rightOffset = degreeToMeter(extent[2] - lon);\r\n\t\t\t// let bottomOffset = degreeToMeter(lat - extent[1]);\r\n\t\t\t// let leftOffset = degreeToMeter(lon - extent[0]);\r\n\t\t\t// padding = [topOffset, rightOffset, bottomOffset, leftOffset];\r\n\t\t\tlet campt = Cesium.Ellipsoid.WGS84.cartesianToCartographic(viewer.camera.position);\r\n\t\t\tconsole.log(\"点击的经纬度坐标为: lon:\" + lon + \",lat:\" + lat + \",height:\" + height);\r\n\t\t\t// console.log(`当前相机位置为：x=${viewer.camera.position.x},y=${viewer.camera.position.y},z=${viewer.camera.position.z},\r\n\t\t\t// heading=${viewer.camera.heading},pitch=${viewer.camera.pitch}`);\r\n\t\t\tlet camlon = Cesium.Math.toDegrees(campt.longitude);\r\n\t\t\tlet camlat = Cesium.Math.toDegrees(campt.latitude);\r\n\t\t\tconsole.log(`当前相机位置为: x:${camlon},y:${camlat},z:${campt.height},heading:${viewer.camera.heading},pitch:${viewer.camera.pitch},roll:${viewer.camera.roll}`);\r\n\t\t\t// console.log(\"当前视域范围:\" + extent);\r\n\t\t\t// console.log(\"偏移:\" + padding);\r\n\t\t}\r\n\t}, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\t//事件\r\n\tlet wheelState = false;\r\n\r\n\r\n\r\n\t// viewer.scene.screenSpaceCameraController.inertiaZoom=0.01;\r\n\t//注册鼠标滚轮事件\r\n\t// viewer.screenSpaceEventHandler.setInputAction(function () {\r\n\t// \t// let currCameraHeight = that.viewer.camera.positionCartographic.height;\r\n\t// \t// if (currCameraHeight < 1000) {\r\n\t// \t// \tthat.viewer.imageryLayers.remove(tdtImgAnnoLayer, falses);\r\n\t// \t// } else if (!that.viewer.imageryLayers.contains(tdtImgAnnoLayer)) {\r\n\t// \t// \tthat.viewer.imageryLayers.add(tdtImgAnnoLayer);\r\n\t// \t// }\r\n\t// \t// Bus.VM.$emit(Bus.SignalType.Scene_Mouse_Wheel, currCameraHeight);\r\n\t// }, Cesium.ScreenSpaceEventType.WHEEL);\r\n\t//注册鼠标滚轮按下MIDDLE_DOWN事件\r\n\tviewer.screenSpaceEventHandler.setInputAction(function () {\r\n\t\twheelState = true; //激活指北针动态更新，只有在鼠标中键按下去时才会有效果\r\n\t}, Cesium.ScreenSpaceEventType.RIGHT_DOWN);\r\n\t//注册鼠标滚轮松开MIDDLE_UP事件\r\n\tviewer.screenSpaceEventHandler.setInputAction(function () {\r\n\t\twheelState = false; //取消指北针动态更新\r\n\t}, Cesium.ScreenSpaceEventType.RIGHT_UP);\r\n\tlet time = 200;\r\n\tvar timeout = null;\r\n\t//注册鼠标左键双击事件\r\n\tviewer.screenSpaceEventHandler.setInputAction(function (movement) {\r\n\t\tclearTimeout(timeout);\r\n\t\tBus.VM.$emit(Bus.SignalType.Scene_Mouse_DoubleLeft_Click, movement);\r\n\t}, Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK);\r\n\t//注册鼠标左键单击事件\r\n\tviewer.screenSpaceEventHandler.setInputAction(function (movement) {\r\n\t\t// let position = that.viewer.scene.camera.pickEllipsoid(movement.position, that.viewer.scene.globe.ellipsoid);\r\n\t\tclearTimeout(timeout);\r\n\t\ttimeout = setTimeout(function () {\r\n\t\t\tBus.VM.$emit(Bus.SignalType.Scene_Mouse_Left_Click, movement);\r\n\t\t}, time);\r\n\t}, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\t//注册鼠标右键单击事件\r\n\tviewer.screenSpaceEventHandler.setInputAction(function (movement) {\r\n\t\tBus.VM.$emit(Bus.SignalType.Scene_Mouse_Right_Click, movement);\r\n\t}, Cesium.ScreenSpaceEventType.RIGHT_CLICK);\r\n\t//注册鼠标移动事件\r\n\tviewer.screenSpaceEventHandler.setInputAction(function (movement) {\r\n\t\tBus.VM.$emit(Bus.SignalType.Scene_Mouse_Move, movement);\r\n\t\tif (wheelState) {\r\n\t\t\t//这里同步指北针用的\r\n\t\t\tlet heading = Cesium.Math.toDegrees(viewer.camera.heading);\r\n\t\t\tBus.VM.$emit(Bus.SignalType.Scene_Mouse_Middle_Move, heading);\r\n\t\t}\r\n\t}, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\r\n\t//注册相机移动起始事件\r\n\t// viewer.camera.moveStart.addEventListener(function () {\r\n\t// \t//获取当前相机信息\r\n\t// \tlet cameraAtt = that.getCamera();\r\n\t// \t// console.log(cameraAtt);\r\n\t// \tBus.VM.$emit(Bus.SignalType.Scene_Camera_MoveStart, cameraAtt);\r\n\t// })\r\n\t//鼠标左键按下\r\n\tviewer.screenSpaceEventHandler.setInputAction(function (movement) {\r\n\t\tBus.VM.$emit(Bus.SignalType.Scene_Left_Down, movement);\r\n\t}, Cesium.ScreenSpaceEventType.LEFT_DOWN);\r\n\t//鼠标左键抬起\r\n\tviewer.screenSpaceEventHandler.setInputAction(function (movement) {\r\n\t\tBus.VM.$emit(Bus.SignalType.Scene_Left_Up, movement);\r\n\t}, Cesium.ScreenSpaceEventType.LEFT_UP);\r\n\tviewer.scene.camera.changed.addEventListener(function () {\r\n\t\tBus.VM.$emit(\"Scene_Camera_Changed\");\r\n\t});\r\n\r\n\tBus.VM.$emit(Bus.SignalType.Scene_Init_Finish, viewer);\r\n\r\n\r\n\treturn viewer;\r\n}\r\nfunction GetPointOnSameCircle(wgs84poi, heading, headingnew, pitch) {\r\n\t// heading=heading+180;\r\n\t// headingnew=headingnew+180;\r\n\theading = 270 - heading;\r\n\theadingnew = 270 - headingnew;\r\n\tlet planedis = wgs84poi.height / (Math.tan(Cesium.Math.toRadians(0 - pitch)));\r\n\tlet mercatorpoi = coordinates.CoordinateMercator.fromWGS84(wgs84poi);\r\n\t// let x1=mercatorpoi.Mercator_X-planedis*Math.sin(Cesium.Math.toRadians(heading))+planedis*Math.sin(Cesium.Math.toRadians(headingnew));\r\n\t// let y1=mercatorpoi.Mercator_Y-planedis*Math.cos(Cesium.Math.toRadians(heading))+planedis*Math.cos(Cesium.Math.toRadians(headingnew));\r\n\tlet x1 = mercatorpoi.Mercator_X - planedis * Math.cos(Cesium.Math.toRadians(heading)) + planedis * Math.cos(Cesium.Math.toRadians(headingnew));\r\n\tlet y1 = mercatorpoi.Mercator_Y - planedis * Math.sin(Cesium.Math.toRadians(heading)) + planedis * Math.sin(Cesium.Math.toRadians(headingnew));\r\n\treturn coordinates.CoordinateWGS84.fromMercatorxyh(x1, y1, wgs84poi.height);\r\n}\r\nexport function GetCamera() {\r\n\tlet viewer = GlobalState.viewer;\r\n\tlet ellipsoid = viewer.scene.globe.ellipsoid;\r\n\tlet cartesian3 = viewer.camera.position;\r\n\tlet cartographic = ellipsoid.cartesianToCartographic(cartesian3);\r\n\tlet lat = Cesium.Math.toDegrees(cartographic.latitude);\r\n\tlet lng = Cesium.Math.toDegrees(cartographic.longitude);\r\n\tlet alt = cartographic.height;\r\n\treturn {\r\n\t\tlongitude: lng,\r\n\t\tlatitude: lat,\r\n\t\theight: alt,\r\n\t\theading: Cesium.Math.toDegrees(viewer.camera.heading),\r\n\t\tpitch: Cesium.Math.toDegrees(viewer.camera.pitch),\r\n\t\troll: Cesium.Math.toDegrees(viewer.camera.roll),\r\n\t}\r\n}\r\n\r\n//heading\\pitch都为角度，roll目前全部传参为0 duration单位为秒\r\nexport function FlyToWithDuration(latitude, longitude, height, heading, pitch, roll, duration) {\r\n\tlet viewer = GlobalState.viewer;\r\n\tif (duration === -1) {\r\n\t\tviewer.camera.flyTo({\r\n\t\t\tdestination: Cesium.Cartesian3.fromDegrees(longitude, latitude, height),\r\n\t\t\torientation: {\r\n\t\t\t\theading: Cesium.Math.toRadians(heading),\r\n\t\t\t\tpitch: Cesium.Math.toRadians(pitch),\r\n\t\t\t\troll: Cesium.Math.toRadians(roll)\r\n\t\t\t},\r\n\t\t\tmaximumHeight: 10\r\n\t\t\t// maximumHeight:10,\r\n\t\t\t// pitchAdjustHeight:10,\r\n\t\t\t//easingFunction : Cesium.EasingFunction.BACK_IN_OUT\r\n\t\t});\r\n\t}\r\n\tviewer.camera.flyTo({\r\n\t\tdestination: Cesium.Cartesian3.fromDegrees(longitude, latitude, height),\r\n\t\torientation: {\r\n\t\t\theading: Cesium.Math.toRadians(heading),\r\n\t\t\tpitch: Cesium.Math.toRadians(pitch),\r\n\t\t\troll: Cesium.Math.toRadians(roll)\r\n\t\t},\r\n\t\tduraion: duration\r\n\t});\r\n}\r\n\r\n/*\r\n* @param {string} url 瓦片地址\r\n* @param {string} name 名称\r\n*/\r\nexport function getWebTile(url, show) {\r\n\tlet provider = new Cesium.UrlTemplateImageryProvider({\r\n\t\t// url: \"http://localhost:3232/zz-tile-blue/{z}/{x}/{y}.png\",\r\n\t\turl: url,\r\n\t});\r\n\treturn {\r\n\t\tprovider: provider,\r\n\t\tshow: show ? show : false,\r\n\t};\r\n}\r\n\r\n/**\r\n * @Author: dongnan\r\n * @Description: 天地图 矢量\r\n * @Date: 2021-11-07 00:20:07\r\n */\r\nexport function getTdtVector() {\r\n\treturn new Cesium.WebMapTileServiceImageryProvider({\r\n\t\turl: \"http://t0.tianditu.gov.cn/vec_w/wmts?tk=\" + FyConfig.Tdtkey,\r\n\t\tlayer: \"vec\",\r\n\t\tstyle: \"default\",\r\n\t\ttileMatrixSetID: \"w\",\r\n\t\tformat: \"tiles\",\r\n\t\tmaximumLevel: 18,\r\n\t});\r\n}\r\n\r\n/**\r\n * @Author: dongnan\r\n * @Description: 天地图 矢量标注\r\n * @Date: 2021-11-07 00:24:07\r\n */\r\nexport function getTdtVectorLabel() {\r\n\treturn new Cesium.WebMapTileServiceImageryProvider({\r\n\t\turl: \"http://t{s}.tianditu.gov.cn/cva_w/wmts?tk=\" + FyConfig.Tdtkey,\r\n\t\tsubdomains: ['0', '1', '2', '3', '4', '5', '6', '7'],\r\n\t\tlayer: \"cva\",\r\n\t\tstyle: \"default\",\r\n\t\ttileMatrixSetID: \"w\",\r\n\t\tformat: \"tiles\",\r\n\t\tmaximumLevel: 18,\r\n\t});\r\n}\r\n\r\n/**\r\n * @Author: dongnan\r\n * @Description: 天地图 影像\r\n * @Date: 2021-11-07 00:24:20\r\n */\r\nexport function getTdtImage() {\r\n\treturn new Cesium.WebMapTileServiceImageryProvider({\r\n\t\turl: \"http://t{s}.tianditu.gov.cn/img_w/wmts?tk=\" + FyConfig.Tdtkey,\r\n\t\tsubdomains: ['0', '1', '2', '3', '4', '5', '6', '7'],\r\n\t\tlayer: \"img\",\r\n\t\tstyle: \"default\",\r\n\t\ttileMatrixSetID: \"w\",\r\n\t\tformat: \"tiles\",\r\n\t\tmaximumLevel: 18,\r\n\t});\r\n}\r\n\r\n/**\r\n * @Author: dongnan\r\n * @Description: 天地图 影像标注\r\n * @Date: 2021-11-07 00:24:36\r\n */\r\nexport function getTdtImageLabel() {\r\n\treturn new Cesium.WebMapTileServiceImageryProvider({\r\n\t\turl: \"http://t{s}.tianditu.gov.cn/cia_w/wmts?tk=\" + FyConfig.Tdtkey,\r\n\t\tsubdomains: ['0', '1', '2', '3', '4', '5', '6', '7'],\r\n\t\tlayer: \"cia\",\r\n\t\tstyle: \"default\",\r\n\t\ttileMatrixSetID: \"w\",\r\n\t\tformat: \"tiles\",\r\n\t\tmaximumLevel: 18,\r\n\t});\r\n}\r\n\r\nexport function GetWindowPosFromWGS84(wgs84, viewer) {\r\n\tlet car3 = Cesium.Cartesian3.fromDegrees(wgs84.longitude, wgs84.latitude, wgs84.height);\r\n\treturn Cesium.SceneTransforms.wgs84ToWindowCoordinates(viewer.scene, car3);\r\n}\r\n\r\nexport function GetPickedRayPositionWGS84(pos) {\r\n\tconst viewer=GlobalState.viewer;\r\n\tvar ray = viewer.camera.getPickRay(pos);\r\n\tvar x = Cesium.Math.toDegrees(ray.direction.x);\r\n\tvar y = Cesium.Math.toDegrees(ray.direction.y);\r\n\tvar z = Cesium.Math.toDegrees(ray.direction.z);\r\n\tvar position = viewer.scene.globe.pick(ray, viewer.scene);\r\n\tvar feature = viewer.scene.pick(pos);\r\n\tif (!feature || feature === null) {\r\n\t\tif (Cesium.defined(position)) {\r\n\t\t\treturn coordinates.CoordinateWGS84.fromCatesian(position);\r\n\t\t}\r\n\t} else {\r\n\t\tvar cartesian = viewer.scene.pickPosition(pos);\r\n\t\tif (Cesium.defined(cartesian)) {\r\n\t\t\treturn coordinates.CoordinateWGS84.fromCatesianWithCartographic(cartesian);\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nexport function GetEntitysByContainId(containentityid, viewer) {\r\n\tlet result = [];\r\n\tviewer.entities.values.forEach(entity => {\r\n\t\tif (entity.id.indexOf(containentityid) != -1\r\n\t\t)\r\n\t\t\tresult.push(entity);\r\n\t})\r\n\treturn result;\r\n}\r\n\r\nexport function GetEntityByID(entityid, viewer) {\r\n\treturn viewer.entities.getById(entityid);\r\n}\r\n\r\nexport function RemoveEntitysByContainId(containentityid, viewer) {\r\n\tlet entitys = GetEntitysByContainId(containentityid, viewer);\r\n\tentitys.forEach(entity => {\r\n\t\tviewer.entities.remove(entity);\r\n\t})\r\n}\r\n\r\n//添加实体对象\r\nexport function SetEntity(entity, replace = true) {\r\n\tlet viewer = GlobalState.viewer;\r\n\tlet entityori = viewer.entities.getById(entity.id);\r\n\tif (entityori) {\r\n\t\tviewer.entities.remove(entityori);\r\n\t}\r\n\treturn viewer.entities.add(entity);\r\n}\r\n\r\n//移除集合中指定id的实体对象\r\nexport function RemoveEntityById(viewer, entityid) {\r\n\tviewer.entities.removeById(entityid);\r\n}\r\n\r\nexport function GetLerpWGS84(wgs84pos1, wgs84pos2, tpoint, viewer) {\r\n\tvar cartesian1 = Cesium.Cartesian3.fromDegrees(wgs84pos1.longitude, wgs84pos1.latitude, wgs84pos1.height);\r\n\tvar cartesian2 = Cesium.Cartesian3.fromDegrees(wgs84pos2.longitude, wgs84pos2.latitude, wgs84pos2.height);\r\n\tvar cartesian3 = Cesium.Cartesian3.lerp(cartesian1, cartesian2, tpoint, new Cesium.Cartesian3());\r\n\tvar cartographic = viewer.scene.globe.ellipsoid.cartesianToCartographic(cartesian3);\r\n\treturn new coordinates.CoordinateWGS84(Cesium.Math.toDegrees(cartographic.longitude),\r\n\t\tCesium.Math.toDegrees(cartographic.latitude),\r\n\t\tcartographic.height);\r\n}\r\n\r\n// wkt to lonlat\r\nfunction geomToListMultiPolygon(geom) {\r\n\tlet str = geom.substr(15, geom.length - 3);\r\n\tlet str2 = str.split(',');\r\n\tlet list = [];\r\n\tstr2.some((item) => {\r\n\t\tlet sList = item.split(' ');\r\n\t\tlet nList = [parseFloat(sList[0]), parseFloat(sList[1])];\r\n\t\tlist.push(nList);\r\n\t});\r\n\treturn list;\r\n}\r\n\r\nfunction geomToListPolygon(geom) {\r\n\tlet str = geom.substr(9, geom.length - 12);\r\n\tlet str2 = str.split(',');\r\n\tlet list = [];\r\n\tstr2.some((item) => {\r\n\t\tlet sList = item.split(' ');\r\n\t\tlet nList = [parseFloat(sList[0]), parseFloat(sList[1])];\r\n\t\tlist.push(nList);\r\n\t});\r\n\treturn list;\r\n}\r\n\r\nexport function geomToList(geom) {\r\n\treturn geom.indexOf('MULTIPOLYGON(') >= 0 ?\r\n\t\tgeomToListMultiPolygon(geom) : geomToListPolygon(geom);\r\n}\r\n\r\nexport function SetCurrentTime(viewer, year, month, day, hour, minute, second, addsecond = 0) {\r\n\tvar date = new Date(year, month - 1, day, hour, minute, second);\r\n\tdate = new Date(date.getTime() + addsecond * 1000);\r\n\tvar julian_time = Cesium.JulianDate.fromDate(date);\r\n\tviewer.clock.currentTime = julian_time;\r\n}\r\n\r\nexport function SetSnowVisible(visible, viewer) {\r\n\tlet stage = viewer.scene.postProcessStages._stages.find(stage => stage && stage.name == \"czm_snow\");\r\n\tif (visible == true && stage == null) {\r\n\t\tviewer.scene.postProcessStages.add(new Cesium.PostProcessStage({\r\n\t\t\tname: 'czm_snow',\r\n\t\t\tfragmentShader: \"uniform sampler2D colorTexture; //输入的场景渲染照片\\n\" +\r\n\t\t\t\t\"varying vec2 v_textureCoordinates;\\n\" +\r\n\t\t\t\t\"\\n\" +\r\n\t\t\t\t\"float snow(vec2 uv,float scale)\\n\" +\r\n\t\t\t\t\"{\\n\" +\r\n\t\t\t\t\"    float time = czm_frameNumber / 60.0;\\n\" +\r\n\t\t\t\t\"    float w=smoothstep(1.0,0.0,-uv.y*(scale/10.));\\n\" +\r\n\t\t\t\t//  \"    if(w<0.1)return 0.;\\n\" +//可以不需要\r\n\t\t\t\t\"    uv+=time/scale;\\n\" +\r\n\t\t\t\t\"    uv.y+=time*2./scale;\\n\" +\r\n\t\t\t\t// \"    uv.x+=sin(uv.y+time*.5)/scale;\\n\" +\r\n\t\t\t\t\"    uv.x+=sin(uv.y+time*0.5)/scale;\\n\" +\r\n\t\t\t\t\"    uv*=scale;\\n\" +\r\n\t\t\t\t\"    vec2 s=floor(uv),f=fract(uv),p;\\n\" +\r\n\t\t\t\t\"    float k=3.,d;\\n\" +\r\n\t\t\t\t// \"    p=.5+.35*sin(11.*fract(sin((s+scale)*mat2(7,3,6,5))*5.))-f;\\n\" +\r\n\t\t\t\t// \"    p=sin((s)*mat2(1,0,1,0));\\n\" +\r\n\t\t\t\t\"    p=.5+.35*sin(11.*fract(sin((s+scale)*mat2(7,3,6,5))*5.))-f;\\n\" +\r\n\t\t\t\t\"    d=length(p);\\n\" +\r\n\t\t\t\t\"    k=min(d,k);\\n\" +\r\n\t\t\t\t\"    k=smoothstep(0.,k,sin(f.x+f.y)*0.01);\\n\" +\r\n\t\t\t\t\"    return k*w;\\n\" +\r\n\t\t\t\t//\"    return k;\\n\" +\r\n\t\t\t\t\"}\\n\" +\r\n\t\t\t\t\"\\n\" +\r\n\t\t\t\t\"void main(void){\\n\" +\r\n\t\t\t\t\"    vec2 resolution = czm_viewport.zw;\\n\" +\r\n\t\t\t\t\"    vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\\n\" +\r\n\t\t\t\t\"    vec3 finalColor=vec3(0);\\n\" +\r\n\t\t\t\t\"    //float c=smoothstep(1.,0.3,clamp(uv.y*.3+.8,0.,.75));\\n\" +\r\n\t\t\t\t\"    float c = 0.0;\\n\" +\r\n\t\t\t\t\"    c+=snow(uv,30.)*0.0;\\n\" +//没有用因为乘以系数0\r\n\t\t\t\t\"    c+=snow(uv,20.)*0.0;\\n\" +//没有用因为乘以系数0\r\n\t\t\t\t\"    c+=snow(uv,15.)*0.0;\\n\" +//没有用因为乘以系数0\r\n\t\t\t\t\"    //c+=snow(uv,10.);\\n\" +\r\n\t\t\t\t\"    c+=snow(uv,8.);\\n\" +\r\n\t\t\t\t\"    c+=snow(uv,6.);\\n\" +\r\n\t\t\t\t\"    c+=snow(uv,5.);\\n\" +\r\n\t\t\t\t\"    finalColor=(vec3(c)); //屏幕上雪的颜色\\n\" +\r\n\t\t\t\t\"    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(finalColor,1), 0.5);  //将雪和三维场景融合\\n\" +\r\n\t\t\t\t\"\\n\" +\r\n\t\t\t\t\"}\"\r\n\t\t}));\r\n\t} else if (visible == false && stage != null) {\r\n\t\tviewer.scene.postProcessStages.remove(stage);\r\n\t}\r\n}\r\n\r\nexport function SetRainVisible(visible, viewer) {\r\n\tlet stage = viewer.scene.postProcessStages._stages.find(stage => stage && stage.name == \"czm_rain\");\r\n\tif (visible == true && stage == null) {\r\n\t\tviewer.scene.postProcessStages.add(new Cesium.PostProcessStage({\r\n\t\t\t\"name\": \"czm_rain\",\r\n\t\t\tfragmentShader: \"uniform sampler2D colorTexture;//输入的场景渲染照片\\n\" +\r\n\t\t\t\t\"varying vec2 v_textureCoordinates;\\n\" +\r\n\t\t\t\t\"\\n\" +\r\n\t\t\t\t\"float hash(float x){\\n\" +\r\n\t\t\t\t\"    return fract(sin(x*133.3)*13.13);\\n\" +\r\n\t\t\t\t\"}\\n\" +\r\n\t\t\t\t\"\\n\" +\r\n\t\t\t\t\"void main(void){\\n\" +\r\n\t\t\t\t\"\\n\" +\r\n\t\t\t\t\"    float time = czm_frameNumber / 60.0;\\n\" +\r\n\t\t\t\t\"    vec2 resolution = czm_viewport.zw;\\n\" +\r\n\t\t\t\t\"\\n\" +\r\n\t\t\t\t\"    vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\\n\" +\r\n\t\t\t\t\"    vec3 c=vec3(.6,.7,.8);\\n\" +\r\n\t\t\t\t\"\\n\" +\r\n\t\t\t\t\"    float a=-.4;//雨跟地面的夹角\\n\" +\r\n\t\t\t\t\"    float si=sin(a),co=cos(a);\\n\" +\r\n\t\t\t\t\"    uv*=mat2(co,-si,si,co);\\n\" +\r\n\t\t\t\t\"    uv*=length(uv+vec2(0,4.9))*.3+1.;\\n\" +\r\n\t\t\t\t\"\\n\" +\r\n\t\t\t\t\"    float v=1.-sin(hash(floor(uv.x*100.))*2.);\\n\" +\r\n\t\t\t\t\"    float b=clamp(abs(sin(20.*time*v+uv.y*(5./(2.+v))))-.95,0.,1.)*20.;\\n\" +\r\n\t\t\t\t\"    c*=v*b; //屏幕上雨的颜色\\n\" +\r\n\t\t\t\t\"\\n\" +\r\n\t\t\t\t\"    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(c,1), 0.5); //将雨和三维场景融合\\n\" +\r\n\t\t\t\t\"}\",\r\n\t\t}));\r\n\t} else if (visible == false && stage != null) {\r\n\t\tviewer.scene.postProcessStages.remove(stage);\r\n\t}\r\n}\r\n\r\nexport function SetFogVisible(visible, viewer) {\r\n\tlet stage = viewer.scene.postProcessStages._stages.find(stage => stage && stage.name == \"czm_fog\");\r\n\tif (visible == true && stage == null) {\r\n\t\tviewer.scene.postProcessStages.add(new Cesium.PostProcessStage({\r\n\t\t\tname: \"czm_fog\",\r\n\t\t\t//sampleMode:PostProcessStageSampleMode.LINEAR,\r\n\t\t\tfragmentShader: \"  uniform sampler2D colorTexture;\\n\" +\r\n\t\t\t\t\"  uniform sampler2D depthTexture;\\n\" +\r\n\t\t\t\t\"  varying vec2 v_textureCoordinates;\\n\" +\r\n\t\t\t\t\"  void main(void)\\n\" +\r\n\t\t\t\t\"  {\\n\" +\r\n\t\t\t\t\"      vec4 origcolor=texture2D(colorTexture, v_textureCoordinates);\\n\" +\r\n\t\t\t\t\"      vec4 fogcolor=vec4(0.8,0.8,0.8,0.5);\\n\" +\r\n\t\t\t\t\"\\n\" +\r\n\t\t\t\t\"      float depth = czm_readDepth(depthTexture, v_textureCoordinates);\\n\" +\r\n\t\t\t\t\"      vec4 depthcolor=texture2D(depthTexture, v_textureCoordinates);\\n\" +\r\n\t\t\t\t\"\\n\" +\r\n\t\t\t\t//\"      float f=(depthcolor.r-0.22)/0.2;\\n\" +//修改后的线性雾\r\n\t\t\t\t\"      float f=(depthcolor.r-0.7)/0.2;\\n\" +//第一次使用的线性雾\"\r\n\t\t\t\t// \"    float f=1.0-pow(2.71828,0.0-(depthcolor.r-0.28)/0.08);\\n\" +//修改后的指数雾\r\n\t\t\t\t\"      if(f<0.0) f=0.0;\\n\" +\r\n\t\t\t\t\"      else if(f>1.0) f=1.0;\\n\" +\r\n\t\t\t\t\"      gl_FragColor = mix(origcolor,fogcolor,f);\\n\" +\r\n\t\t\t\t\"   }\"\r\n\t\t}));\r\n\t} else if (visible == false && stage != null) {\r\n\t\tviewer.scene.postProcessStages.remove(stage);\r\n\t}\r\n}\r\n\r\nexport function SetCloudyVisible(visible, viewer) {\r\n\tviewer.scene.skyBox = GlobalState.getInstance().cloudyskybox;\r\n}\r\n\r\nexport function SetSunnyVisible(visible, viewer) {\r\n\tviewer.scene.skyBox = GlobalState.getInstance().sunnyskybox;\r\n}\r\n\r\n/** 时间格式转换\r\n * @param e 要转换的日期(如：Sat Nov 26 2022 21:37:29 GMT+0800 (中国标准时间))\r\n * @returns {string} 转换结果(如：2022-11-26 21:37:29)\r\n */\r\nexport function timeFormatConvert(e) {\r\n\tconst Y = e.getFullYear(); // 年\r\n\tconst M = prefixZero(e.getMonth() + 1); // 月\r\n\tconst D = prefixZero(e.getDate()); // 日\r\n\tconst H = prefixZero(e.getHours()); // 时\r\n\tconst Mi = prefixZero(e.getMinutes()); // 分\r\n\tconst S = prefixZero(e.getSeconds()); // 秒\r\n\t// return {Y + \"-\" + M + \"-\" + D + \" \" + H + \":\" + Mi + \":\" + S;}\r\n\treturn {Y, M, D, H, Mi, S}\r\n}\r\n\r\nexport function prefixZero(num = 0, n = 2) {\r\n\t// 数字位数不够，数字前面补零\r\n\treturn (Array(n).join(\"0\") + num).slice(-n);\r\n}\r\n\r\n\r\n/**\r\n * 昼夜切换\r\n * @param isday：true为白昼，时间设为中午12点，false为黑色，时间设为夜里12点，时区为当前设定的时区，默认为东八区\r\n * @param viewer\r\n * @constructor\r\n */\r\nexport function SetDayOrNight(isday, viewer) {\r\n\tviewer.clock.currentTime = Cesium.JulianDate.fromDate(new Date())\r\n\tviewer.scene.globe.enableLighting = true;\r\n\tviewer.clock.shouldAnimate = true;\r\n\tviewer.clock.multiplier = 0;\r\n\tlet jsDate = new Date(viewer.clock.currentTime.toString());\r\n\tlet date = timeFormatConvert(jsDate);\r\n\tif (!isday) {\r\n\t\tlet offset = 24 - date.H;\r\n\t\tviewer.clock.currentTime = Cesium.JulianDate.addHours(\r\n\t\t\tCesium.JulianDate.now(new Date()),\r\n\t\t\toffset,\r\n\t\t\tnew Cesium.JulianDate()\r\n\t\t);\r\n\t\tsetAllLayerBrightnes(0.4, viewer)\r\n\t} else if (isday) {\r\n\t\tlet offset = 12 - date.H;\r\n\t\tviewer.clock.currentTime = Cesium.JulianDate.addHours(\r\n\t\t\tCesium.JulianDate.now(new Date()),\r\n\t\t\toffset,\r\n\t\t\tnew Cesium.JulianDate()\r\n\t\t);\r\n\t\tsetAllLayerBrightnes(1, viewer)\r\n\t}\r\n}\r\n\r\n//设置所有图层的亮度\r\nexport function setAllLayerBrightnes(brightness, viewer) {\r\n\tvar layers = viewer.imageryLayers;\r\n\tfor (var i = 0; i < layers.length; i++) {\r\n\t\tvar layer = layers.get(i);\r\n\t\tlayer.brightness = brightness;\r\n\t}\r\n}\r\n\r\nexport const MoonLightSettings = reactive({\r\n\t// <!--阴影可见距离-->\r\n\tShadowDistance: 5000,\r\n\tOriginShadowDis: 5000,\r\n\t// <!--光强-->\r\n\tLightIntensity: 1,\r\n\tOriginLightIntensity: 1,\r\n\t// <!--色温-->\r\n\tLightTemp: 6500,\r\n\tOriginLightTemp: 6500,\r\n\t// <!--颜色rgb-->\r\n\tColor: Cesium.Color.WHITE,\r\n\tOriginColor: Cesium.Color.WHITE,\r\n\t// DirLight: new Cesium.DirectionalLight(new Cesium.Cartesian3(1, 1, 1)),\r\n\t// Init() {\r\n\t// \tthis.ShadowDistance = this.OriginShadowDis;\r\n\t// \tthis.LightIntensity = this.OriginLightIntensity;\r\n\t// \tthis.LightTemp = this.OriginLightTemp;\r\n\t// \tthis.Color = this.OriginColor;\r\n\t// },\r\n\t// SetSure() {\r\n\t// \tthis.OriginShadowDis = this.ShadowDistance;\r\n\t// \tthis.OriginLightIntensity = this.LightIntensity;\r\n\t// \tthis.OriginLightTemp = this.LightTemp;\r\n\t// \tthis.OriginColor = this.Color;\r\n\t// }\r\n});\r\nexport const SunLightSettings = reactive({\r\n\t// <!--阴影可见距离-->\r\n\tShadowDistance: 5000,\r\n\tOriginShadowDis: 5000,\r\n\t// <!--光强-->\r\n\tLightIntensity: 2,\r\n\tOriginLightIntensity: 2,\r\n\t// <!--色温-->\r\n\tLightTemp: 6500,\r\n\tOriginLightTemp: 6500,\r\n\t// <!--颜色rgb-->\r\n\tColor: Cesium.Color.WHITE,\r\n\tOriginColor: Cesium.Color.WHITE,\r\n\t// DirLight: new Cesium.DirectionalLight(new Cesium.Cartesian3(1, 1, 1)),\r\n\t// Init() {\r\n\t// \tthis.ShadowDistance = this.OriginShadowDis;\r\n\t// \tthis.LightIntensity = this.OriginLightIntensity;\r\n\t// \tthis.LightTemp = this.OriginLightTemp;\r\n\t// \tthis.Color = this.OriginColor;\r\n\t// },\r\n\t// SetSure() {\r\n\t// \tthis.OriginShadowDis = this.ShadowDistance;\r\n\t// \tthis.OriginLightIntensity = this.LightIntensity;\r\n\t// \tthis.OriginLightTemp = this.LightTemp;\r\n\t// \tthis.OriginColor = this.Color;\r\n\t// }\r\n});\r\n[MoonLightSettings, SunLightSettings].forEach(item => {\r\n\tObject.defineProperty(item, \"UiColor\", {\r\n\t\tget: function () {\r\n\t\t\treturn this.Color.toCssColorString()\r\n\t\t},\r\n\t\tset: function (value) {\r\n\t\t\tthis.Color = Cesium.Color.fromCssColorString(value);\r\n\t\t\t// alert(this.Color)\r\n\t\t}\r\n\t})\r\n})\r\n\r\n","/**\r\n * Created by wqy\r\n * Date 2024/1/15 15:13\r\n * Description\r\n */\r\nimport {defineStore} from \"pinia\";\r\n// import {setSession, getSession, removeSession} from \"@/utils/tools/sessionStorage.js\";\r\n\r\nimport {GlobalState} from \"../../../buss/maphandler\";\r\n\r\nexport const soucesettings = defineStore('sourcesetting', {\r\n\tstate: () => {\r\n\t\treturn {\r\n\t\t\ttitle: '',\r\n\t\t\tremark: '',\r\n\t\t\tdataTag: '',\r\n\t\t\tthumbnailUrl: '',\r\n\t\t\tthumbnailsrc:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKkAAACkCAYAAADsSw7xAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDYuMC1jMDAyIDc5LjE2NDQ4OCwgMjAyMC8wNy8xMC0yMjowNjo1MyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIyLjAgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjAwOEY0Mjk4NzYwRDExRUQ4MEVERUQ2NzZGQzA0Qjg0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjAwOEY0Mjk5NzYwRDExRUQ4MEVERUQ2NzZGQzA0Qjg0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDA4RjQyOTY3NjBEMTFFRDgwRURFRDY3NkZDMDRCODQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDA4RjQyOTc3NjBEMTFFRDgwRURFRDY3NkZDMDRCODQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz58/TbYAAAEkklEQVR42uzdy24TVxzA4fF4bI8dU7KCVAj1Ih6g6pJ13yJSn6M8AV30NehLdF/eoqI7YFUkO7ETXzj/GFeGJhDnUs9kvk8aRVaEsEe/nDnneOK0Dh49yQ4ePiizLHuWjsN0fJuOdga7MU/Hq3T8no7nr9+8PW798OPTQXrwx2QyfToaj7PZbOY0sVNFUWTDvUFWluXL9PCn9sHXj59NptOf/3n3LlssFs4QOxcdpiZTrO3HKdhlHpf40WjszFA5o/FRfDmMSL93iaeKPnT5TURaOB1UWJ47B1S+UqcAkYJIESmIFESKSEGkiBRECiJFpCBSECkiBZEiUhApiBSRgkhBpIgURIpIQaQgUkQKIgWRIlIQKSIFkYJIESmIFESKSEGkiBRECiJFpCBSECkiBZEiUhApiBSRgkhBpNRQ0difzryVjnr8jC6Xy2w+X4i0KdrtPOv3y7OvdRKhTiYn2cnJqUjv9uiZZ3t7/azVatXuucdz7vd7WTz16bRZoTZqTlqW3VoGuqnX62Y1fwlG0s++2KL90ePT01m6jNbjecccej2i5nk7zVHnIr2LNkfRWIgcHU1qcgXopRG0s/E6GrbIzUCkIFJE2kyxjxoLllbTJoAWTvVYXA0G5b87AbGJfnw8PdsJwEhaCbEPublVtY7WiCrSyuh02udfcoq2kyPSalhesLu/rMOuv0ib4bwbOBaLRTab3ew7PKYPIr1GpLOzhVKEGaNnLJjG4+Mb3zm4d29QuzuxrO4rNpre1i1xmwuxuCNrNDpKPxCmEkbSColA1zdbr4Ltu/SLtDo+3d5aX/ojXES6+3lVijPuZ73oe3FDMyLd3UnOvzxadrudj27HQ6T/m5huXvYdq7hvtNOxlhXplmLOuL4r/irKcrtf+qvjLwmKdKeX6dU20XA4uNIIF5fwbne7fxcDbvyf1/nBEGmDrC/T673NixY+54/AV18M2ZoS6SUv072z0DbFFtJlfiV6HfV1pxm2pkR6odgSumilHd+Ly//n5o2rDfvWjTwPW1MiPXce+qURbDVXPX+eGiPwTd7Wd5V5rUjvuFhdX2YuuN5a2pynRrS3sdfZ9LmpTblP5pzbjoLxb2LuGp/T5NIs0lsVoW2zev/vPLXvJLrc357VatwoKNIKi8VOXT6rVKQNFIudpq+eRVrlF5/nFjsirbaYh3rr0eq+wqt5c1AjKYh0e3flL3g07S+RNCrS6fSk9q8hftW6aZ+m0qhI44Me6hxqfIrKZDK1cLrr4j32iLUoihqt7Jdngd70R/2ItOJzuvn8JMPlHkSKSEGkIFJECiIFkSJSECkiBZGCSBEpiBREikhBpIgURAoiRaQgUkTqFCBSECkiBZGCSBEpiBSRgkhBpIgURAoiRaQgUkQKIgWRIlIQKYgUkYJIESmIFESKSEGkIFJECiKl0ZHOnAYqbBGR/lUUhVNB5Xzo8u+I9MVwuOeMUDnDvUF8eRGR/lb2en/u79/PjKhUZQTdv/9VVpbly/Tweevg0ZPs4OGDMj34JR2H6fguHW2nih2Zp+NVjKDp+PX1m7fH7wUYAILw0PzlZqTUAAAAAElFTkSuQmCC',\r\n\t\t}\r\n\t},\r\n\r\n\tactions:{\r\n\t\tsetThumbnailUrl(filepath){\r\n\t\t\t// this.thumbnailUrl=filepath;\r\n\t\t\tconst scope=this;\r\n\t\t\t// GetThumbnailImgUrl(filepath,function (url) {\r\n\t\t\t\tscope.thumbnailsrc=filepath;\r\n\t\t\t// })\r\n\r\n\t\t}\r\n\t}\r\n\r\n});\r\n\r\nexport function InitSouceSt(settings) {\r\n\tif (settings) {\r\n\t\tsoucesettings().title = settings.title;\r\n\t\tsoucesettings().remark = settings.remark;\r\n\t\tsoucesettings().dataTag = settings.dataTag;\r\n\t\tif(settings.thumbnailUrl!=null&&settings.thumbnailUrl!=''){\r\n\t\t\tsoucesettings().setThumbnailUrl(settings.thumbnailUrl);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport function GetThumbnailImgUrl(filepath, callback) {\r\n\t// fetch(`${FyConfig.IP}/file/file/download?filePath=${filepath}`, {\r\n\t// \tmethod: \"get\",\r\n\t// \theaders: {\r\n\t// \t\t'Token': getSession(\"SpaceAccessToken\", true),\r\n\t// \t},\r\n\t// }).then(response => response.blob())\r\n\t// \t.then(blob => {\r\n\t// \t\tlet file = new File([blob], 'viewpng', {\r\n\t// \t\t\ttype: \"image/png\",\r\n\t// \t\t});\r\n\t// \t\tlet url = URL.createObjectURL(file);\r\n\t//\r\n\t// \t\tif(callback){\r\n\t// \t\t\tcallback(url);\r\n\t// \t\t}\r\n\t//\r\n\t// \t})\r\n}\r\n\r\nexport function CaptureUploadImg(callback) {\r\n\tconst $promise = capturescreen();\r\n\t// let fileJson = {};\r\n\t// const userID = getSession('UserID', true);\r\n\tif ($promise) {\r\n\t\t$promise.then((blob) => {\r\n\t\t\tcallback(URL.createObjectURL(blob));\r\n\t// \t\tvar fd = new FormData();\r\n\t// \t\tfd.append('file', blob, new Date().getDate() + '.png');\r\n\t//\r\n\t// \t\tlet token = getSession(\"SpaceAccessToken\", true);\r\n\t// \t\tconst xhr = new XMLHttpRequest();\r\n\t// \t\tconst url = FyConfig.IP + '/file/file/upload' + '?userId=' + `${userID}`;\r\n\t// \t\txhr.open('POST', url);\r\n\t// \t\txhr.setRequestHeader('Token', token);\r\n\t// \t\txhr.onreadystatechange = function () {\r\n\t// \t\t\tif (xhr.readyState === 4 && xhr.status === 200) {\r\n\t// \t\t\t\tlet Text = JSON.parse(xhr.responseText);\r\n\t// \t\t\t\tfileJson = Text.data;\r\n\t//\r\n\t// \t\t\t\tif(callback){\r\n\t// \t\t\t\t\tcallback(fileJson.filePath);\r\n\t// \t\t\t\t}\r\n\t// \t\t\t}\r\n\t// \t\t};\r\n\t// \t\txhr.send(fd);\r\n\t\t});\r\n\t};\r\n}\r\n\r\nfunction capturescreen() {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tconst viewer = GlobalState.viewer;\r\n\t\tconst canvas = viewer.scene.canvas;\r\n\r\n\t\tconst scalefac=0.4;\r\n\r\n\t\tconst len=Math.min(canvas.width,canvas.height);\r\n\r\n\t\tconst center=[(canvas.width/2),(canvas.height/2)];\r\n\t\tconst lefttop=[center[0]-len/2,center[1]-len/2];\r\n\r\n\r\n\t\t//新Image对象，可以理解为DOM\r\n\t\tlet image = new Image();\r\n\t\t// canvas.toDataURL 返回的是一串Base64编码的URL，当然,浏览器自己肯定支持\r\n\t\t// 指定格式 PNG\r\n\t\timage.src = canvas.toDataURL(\"image/png\");\r\n\t\timage.onload = function () {\r\n\t\t\tlet newCanvas = document.createElement(\"canvas\");\r\n\t\t\tconst ctx = newCanvas.getContext(\"2d\");\r\n\t\t\tnewCanvas.width = len*scalefac;\r\n\t\t\tnewCanvas.height = len*scalefac;\r\n\t\t\tctx.scale(scalefac,scalefac);\r\n\r\n\t\t\tctx.drawImage(image, lefttop[0],lefttop[1],len,len,0,0,len,len);\r\n\r\n\r\n\t\t\tnewCanvas.toBlob((blod) => {\r\n\t\t\t\tresolve(blod);\r\n\t\t\t\timage.src='';\r\n\t\t\t\tnewCanvas=null;\r\n\t\t\t}, \"image/png\");\r\n\r\n\t\t};\r\n\t});\r\n\r\n\r\n}\r\n","<!--\r\n * Created by wqy\r\n * Date 2024/1/5 11:10\r\n * Description\r\n-->\r\n<template>\r\n    <div id=\"menu\">\r\n        <img :src=\"settingdt.logourl\">\r\n        <div id=\"menu-head__content\">\r\n            <div v-if=\"settingdt.type=='edit'\" id=\"menu-head__left\">\r\n                <el-menu\r\n                        :default-active=\"activeIndex\"\r\n                        class=\"el-menu-demo\"\r\n                        mode=\"horizontal\"\r\n                        :ellipsis=\"false\"\r\n                        background-color=\"#232630\"\r\n                        text-color=\"white\"\r\n                        @select=\"handleSelect\"\r\n                >\r\n\r\n                    <el-sub-menu index=\"1\">\r\n                        <template #title>\r\n                            <div class=\"menubuttonicon\">\r\n                                <div>\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" role=\"img\" width=\"1em\"\r\n                                         height=\"1em\" viewBox=\"0 0 48 48\" class=\"iconify iconify--icon-park-outline\">\r\n                                        <g fill=\"none\" stroke=\"currentColor\" stroke-linejoin=\"round\" stroke-width=\"4\">\r\n                                            <path d=\"M5 8a2 2 0 0 1 2-2h12l5 6h17a2 2 0 0 1 2 2v26a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2zm38 14H5\"></path>\r\n                                            <path stroke-linecap=\"round\" d=\"M5 16v12m38-12v12\"></path>\r\n                                        </g>\r\n                                    </svg>\r\n                                </div>\r\n                                <span>Base</span>\r\n                            </div>\r\n                        </template>\r\n                        <el-menu-item index=\"1-1\">Source</el-menu-item>\r\n                        <el-menu-item index=\"1-2\">Circum</el-menu-item>\r\n                        <el-menu-item index=\"1-3\">Clock</el-menu-item>\r\n                        <el-menu-item index=\"1-4\">Camera</el-menu-item>\r\n                    </el-sub-menu>\r\n                    <el-sub-menu index=\"2\">\r\n                        <template #title>\r\n                            <div class=\"menubuttonicon\">\r\n                                <div>\r\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" role=\"img\" width=\"1em\"\r\n                                         height=\"1em\" viewBox=\"0 0 48 48\" class=\"iconify iconify--icon-park-outline\">\r\n                                        <g fill=\"none\" stroke=\"currentColor\" stroke-linejoin=\"round\" stroke-width=\"4\">\r\n                                            <path d=\"M4 11.914L24 19l20-7.086L24 5z\"></path>\r\n                                            <path stroke-linecap=\"round\"\r\n                                                  d=\"m4 20l20 7l20-7M4 28l20 7l20-7M4 36l20 7l20-7\"></path>\r\n                                        </g>\r\n                                    </svg>\r\n                                </div>\r\n                                <span>Layers</span>\r\n                            </div>\r\n                        </template>\r\n                        <!--<el-menu-item index=\"2-1\">底图</el-menu-item>-->\r\n                        <el-menu-item index=\"2-2\">Terrain</el-menu-item>\r\n                        <el-menu-item index=\"2-3\">Maptree</el-menu-item>\r\n                    </el-sub-menu>\r\n                    <el-menu-item index=\"3\" class=\"menubuttonicon\">\r\n                        <div>\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" role=\"img\" width=\"1em\"\r\n                                 height=\"1em\" viewBox=\"0 0 48 48\" class=\"iconify iconify--icon-park-outline\">\r\n                                <path fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\"\r\n                                      stroke-width=\"4\"\r\n                                      d=\"M44 16c0 6.627-5.373 12-12 12c-2.027 0-3.936-.503-5.61-1.39L9 44l-5-5l17.39-17.39A11.948 11.948 0 0 1 20 16c0-6.627 5.373-12 12-12c2.027 0 3.936.502 5.61 1.39L30 13l5 5l7.61-7.61A11.948 11.948 0 0 1 44 16\"></path>\r\n                            </svg>\r\n                        </div>\r\n                        <span>Components</span>\r\n                    </el-menu-item>\r\n                    <el-menu-item index=\"4\" class=\"menubuttonicon\">\r\n                        <div>\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" role=\"img\" width=\"1em\"\r\n                                 height=\"1em\" viewBox=\"0 0 48 48\" class=\"iconify iconify--icon-park-outline\">\r\n                                <path fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\"\r\n                                      stroke-width=\"4\"\r\n                                      d=\"m24.95 42.36l5.466-11.99l12.689-3.72l-9.767-8.88l.368-13.163l-11.502 6.503l-12.46-4.416l2.657 12.9l-8.069 10.433l13.145 1.47zm11.228-6.306l8 7.964\"></path>\r\n                            </svg>\r\n                        </div>\r\n                        <span>Effects</span>\r\n                    </el-menu-item>\r\n                </el-menu>\r\n            </div>\r\n            <div id=\"menu-head__center\"> {{souSt.title}}</div>\r\n            <div id=\"menu-head__right\">\r\n                <div class=\"topmenuitems\" >\r\n                    <div class=\"menubuttonicon\" @click=\"share\">\r\n                        <div>\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"1em\" height=\"1em\" viewBox=\"0 0 48 48\"\r\n                                 class=\"iconify iconify--icon-park-outline\">\r\n                                <path fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\"\r\n                                      stroke-width=\"4\"\r\n                                      d=\"M28 6h14v14m0 9.474V39a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h9m7.8 16.2L41.1 6.9\"></path>\r\n                            </svg>\r\n                        </div>\r\n                        <span>Share</span>\r\n                    </div>\r\n                    <div class=\"menubuttonicon\" v-if=\"settingdt.type=='edit'\" @click=\"preview\">\r\n                        <div>\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"1em\" height=\"1em\" viewBox=\"0 0 48 48\"\r\n                                 class=\"iconify iconify--icon-park-outline\">\r\n                                <g fill=\"none\" stroke=\"currentColor\" stroke-linejoin=\"round\" stroke-width=\"4\">\r\n                                    <path d=\"M24 36c11.046 0 20-12 20-12s-8.954-12-20-12S4 24 4 24s8.954 12 20 12Z\"></path>\r\n                                    <path d=\"M24 29a5 5 0 1 0 0-10a5 5 0 0 0 0 10Z\"></path>\r\n                                </g>\r\n                            </svg>\r\n                        </div>\r\n                        <span>Preview</span>\r\n                    </div>\r\n                    <div class=\"menubuttonicon\" v-if=\"settingdt.type=='edit'\" @click=\"save\">\r\n                        <div>\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" role=\"img\" width=\"1em\"\r\n                                 height=\"1em\" viewBox=\"0 0 48 48\" class=\"iconify iconify--icon-park-outline\">\r\n                                <g fill=\"none\" stroke=\"currentColor\" stroke-width=\"4\">\r\n                                    <path stroke-linejoin=\"round\"\r\n                                          d=\"M39.3 6H8.7A2.7 2.7 0 0 0 6 8.7v30.6A2.7 2.7 0 0 0 8.7 42h30.6a2.7 2.7 0 0 0 2.7-2.7V8.7A2.7 2.7 0 0 0 39.3 6Z\"></path>\r\n                                    <path stroke-linejoin=\"round\" d=\"M32 6v18H15V6z\"></path>\r\n                                    <path stroke-linecap=\"round\" d=\"M26 13v4M10.997 6H36\"></path>\r\n                                </g>\r\n                            </svg>\r\n                        </div>\r\n                        <span>Save</span>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n\r\n\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    import {soucesettings} from \"./Widgets/buss/Source\";\r\n    import {ref} from 'vue'\r\n\tconst souSt=soucesettings();\r\n\tconst emit = defineEmits();\r\n\tconst props = defineProps({\r\n\t\tsettingdt: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: {\r\n\t\t\t\ttype: 'preview',\r\n\t\t\t\tlogourl: '/img/logo.svg',\r\n\r\n\t\t\t},\r\n\t\t},\r\n        curmenu:{\r\n\t\t\ttype:String,\r\n            default:''\r\n        },\r\n\t});\r\n\tconst activeIndex = ref(props.curmenu);\r\n\tconst handleSelect = function (key, keyPath) {\r\n\t\temit('menuchange',key);\r\n\t}\r\n\tconst share=function () {\r\n\r\n\t}\r\n\tconst preview=function () {\r\n\t\temit('preview');\r\n\t}\r\n\tconst save=function () {\r\n\t\temit('save');\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import script from \"./menu.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./menu.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","/**\r\n * Created by wqy\r\n * Date 2024/1/8 16:59\r\n * Description\r\n */\r\n\r\nimport {CesiumViewer, GetCamera, GetPickedRayPositionWGS84,GlobalState} from '../../../buss/maphandler';\r\nimport {defineStore} from \"pinia\";\r\nimport Bus from '@/common/buss/Bus'\r\nimport moment from 'moment';\r\n//地图工具栏\r\nconst tooltipbtns = [\r\n\t{key: 'home'},\r\n\t{key: 'compass'},\r\n\t{key: 'zoominout'},\r\n\t{key: 'scenemode'},\r\n\t{key: 'imapk'},\r\n\t{key: 'fullsize'},\r\n\t{key: 'navi'},\r\n];\r\nexport const othersettings = defineStore('othersettings', {\r\n\t\tstate: () => {\r\n\t\t\treturn {\r\n\t\t\t\t//状态栏控制\r\n\t\t\t\tstatusbar: true,\r\n\t\t\t\tlonlat: true,\r\n\t\t\t\theight: true,\r\n\t\t\t\tlod: true,\r\n\t\t\t\theading: true,\r\n\t\t\t\tpitch: true,\r\n\t\t\t\troll: true,\r\n\t\t\t\tcameraheight: true,\r\n\t\t\t\tfps: true,\r\n\t\t\t\tlonlatpre: 6,\r\n\t\t\t\t//比例尺\r\n\t\t\t\tscale: true,\r\n\t\t\t\tscaleleft: '80px',\r\n\t\t\t\tscaleright: '',\r\n\t\t\t\tscaletop: '',\r\n\t\t\t\tscalebottom: '30px',\r\n\t\t\t\t//时间控制\r\n\t\t\t\ttimeline: true,\r\n\t\t\t\tanimation: true,\r\n\t\t\t\t//状态栏缓存数据\r\n\t\t\t\tstatusbarstrs: {\r\n\t\t\t\t\tlon: '', lat: '', height: '', lod: '', heading: '', pitch: '', roll: '', cameraheight: '', fps: ''\r\n\t\t\t\t},\r\n\t\t\t\t//比例尺控制缓存数据\r\n\t\t\t\tscalebarstr: '',\r\n\t\t\t\t//时间控制缓存数据\r\n\t\t\t\ttimecontrolstrs: {\r\n\t\t\t\t\tcurrenttime:null,\r\n\t\t\t\t\tshouldanimate: true,\r\n\t\t\t\t\ttimeformat: 'YYYY-MM-DD HH:mm:ss',\r\n\t\t\t\t\tstep:1,\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetters: {\r\n\t\t\tstatuscontents(state) {\r\n\t\t\t\tlet result = '';\r\n\t\t\t\tif (state.lonlat === true) {\r\n\t\t\t\t\tresult += `Longitude：${state.statusbarstrs.lon}   Latitude：${state.statusbarstrs.lat} `;\r\n\t\t\t\t}\r\n\t\t\t\tif (state.height === true) {\r\n\t\t\t\t\tresult += `Height：${state.statusbarstrs.height}m`;\r\n\t\t\t\t}\r\n\t\t\t\tif (state.lod === true) {\r\n\t\t\t\t\tresult += `Level：${state.statusbarstrs.lod}   `;\r\n\t\t\t\t}\r\n\t\t\t\tif (state.heading === true) {\r\n\t\t\t\t\tresult += `Heading：${state.statusbarstrs.heading}   `;\r\n\t\t\t\t}\r\n\t\t\t\tif (state.pitch === true) {\r\n\t\t\t\t\tresult += `Pitch：${state.statusbarstrs.pitch}   `;\r\n\t\t\t\t}\r\n\t\t\t\tif (state.roll === true) {\r\n\t\t\t\t\tresult += `Roll：${state.statusbarstrs.roll}   `;\r\n\t\t\t\t}\r\n\t\t\t\tif (state.cameraheight === true) {\r\n\t\t\t\t\tresult += `CameraHeight：${state.statusbarstrs.cameraheight}m   `;\r\n\t\t\t\t}\r\n\t\t\t\tif (state.fps === true) {\r\n\t\t\t\t\tresult += `FPS：${state.statusbarstrs.fps}   `;\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t},\r\n\t\t\tscalecontents(state) {\r\n\t\t\t\treturn state.scalebarstr;\r\n\t\t\t},\r\n\t\t\tcurrentMapTime(state) {\r\n\t\t\t\tif(state.timecontrolstrs.currenttime==null) return;\r\n\t\t\t\treturn moment(state.timecontrolstrs.currenttime).format(state.timecontrolstrs.timeformat);\r\n\t\t\t},\r\n\r\n\t\t},\r\n\t\tactions: {\r\n\t\t\tSetTimelineShow(timelineshow) {\r\n\t\t\t\tconst originshow = this.timeline;\r\n\t\t\t\tif (originshow != timelineshow) {\r\n\t\t\t\t\tsettimelinevisib(timelineshow);\r\n\t\t\t\t\tthis.timeline = timelineshow;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tSetStatusBarShow(show) {\r\n\t\t\t\tconst originshow = this.statusbar;\r\n\t\t\t\tif (originshow != show) {\r\n\t\t\t\t\tif (show === false) {\r\n\t\t\t\t\t\tBus.VM.$off(Bus.SignalType.Scene_Mouse_Move, onscenemousemovegetlonlat);\r\n\t\t\t\t\t\tGlobalState.viewer.scene.postRender.removeEventListener(onrenderlist);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.statusbarstrs._fpsFrameCount = 0;\r\n\t\t\t\t\t\tBus.VM.$on(Bus.SignalType.Scene_Mouse_Move, onscenemousemovegetlonlat);\r\n\t\t\t\t\t\tGlobalState.viewer.scene.postRender.addEventListener(onrenderlist);\r\n\t\t\t\t\t\tthis.statusbarstrs._lastFpsTm = new Date();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.statusbar = show;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tSetAnimationBarShow(show) {\r\n\t\t\t\tconst originshow = this.animation;\r\n\t\t\t\tif (originshow != show) {\r\n\t\t\t\t\tGlobalState.viewer.mapcontainerbtns[7].forEach(subele => {\r\n\t\t\t\t\t\tsubele.style.left = show !== true ? '0' : '268px';\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.animation = show;\r\n\t\t\t\t}\r\n\t\t\t\tGlobalState.viewer.clock.onTick.removeEventListener(onmapclocktick);\r\n\t\t\t\tif(show===true){\r\n\t\t\t\t\tGlobalState.viewer.clock.onTick.addEventListener(onmapclocktick);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\ttoggleshouldanimate() {\r\n\t\t\t\tthis.timecontrolstrs.shouldanimate = !this.timecontrolstrs.shouldanimate;\r\n\t\t\t\tGlobalState.viewer.clock.shouldAnimate = this.timecontrolstrs.shouldanimate;\r\n\r\n\t\t\t},\r\n\t\t\tBackToNow(){\r\n\t\t\t\tCesium.JulianDate.now(GlobalState.viewer.clock.currentTime)\r\n\t\t\t},\r\n\t\t\tSetAniStep(){\r\n\t\t\t\tGlobalState.viewer.clock.multiplier=this.timecontrolstrs.step;\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n;\r\n\r\nfunction settimelinevisib(visible) {\r\n\tif (visible === false) {\r\n\t\tGlobalState.viewer.mapcontainerbtns[7].forEach(subele => {\r\n\t\t\tGlobalState.viewer.tooltipcontainer.parentNode.removeChild(subele);\r\n\t\t})\r\n\t}\r\n\telse {\r\n\t\t//timeline\r\n\t\tGlobalState.viewer.mapcontainerbtns[7].forEach(subele => {\r\n\t\t\tsubele.style.right = '0';\r\n\t\t\tsubele.style.left = othersettings().animation !== true ? '0' : '268px';\r\n\t\t\tGlobalState.viewer.tooltipcontainer.parentNode.appendChild(subele);\r\n\t\t});\r\n\t}\r\n}\r\n\r\n\r\n\r\nfunction onscenemousemovegetlonlat(e) {\r\n\tconst wgspos = GetPickedRayPositionWGS84(e.endPosition);\r\n\tif (wgspos == null) return;\r\n\tothersettings().statusbarstrs.lon = wgspos.longitude.toFixed(othersettings().lonlatpre);\r\n\tothersettings().statusbarstrs.lat = wgspos.latitude.toFixed(othersettings().lonlatpre);\r\n\tif (wgspos.height < 0) wgspos.height = 0;\r\n\tothersettings().statusbarstrs.height = wgspos.height.toFixed(0);\r\n}\r\n\r\nfunction onrenderlist() {\r\n\tconst camera = GetCamera();\r\n\tothersettings().statusbarstrs.heading = camera.heading.toFixed(2) + '°';\r\n\tothersettings().statusbarstrs.pitch = camera.pitch.toFixed(2) + '°';\r\n\tothersettings().statusbarstrs.roll = camera.roll.toFixed(2) + '°';\r\n\tothersettings().statusbarstrs.cameraheight = camera.height.toFixed(2);\r\n\tothersettings().statusbarstrs._fpsFrameCount++;\r\n\tconst curtimesp = new Date();\r\n\tconst fpstime = curtimesp - othersettings().statusbarstrs._lastFpsTm;\r\n\tif (fpstime > 1000) {\r\n\t\tlet fps = (othersettings().statusbarstrs._fpsFrameCount * 1000) / fpstime;\r\n\t\tothersettings().statusbarstrs.fps = parseInt(fps) + ' FPS';\r\n\t\tothersettings().statusbarstrs._lastFpsTm = curtimesp;\r\n\t\tothersettings().statusbarstrs._fpsFrameCount = 0;\r\n\t}\r\n\tlet tilesToRender = GlobalState.viewer.scene.globe._surface._tilesToRender;\r\n\tif (tilesToRender != null && tilesToRender.length > 0) {\r\n\t\tothersettings().statusbarstrs.lod = tilesToRender[0].level;\r\n\t}\r\n}\r\n\r\nfunction onscalerenderlist() {\r\n\tvar scene = GlobalState.viewer.scene;\r\n\tconst centerw = scene.canvas.width / 2;\r\n\tconst height = scene.canvas.height;\r\n\tconst wgs1 = GetPickedRayPositionWGS84({\r\n\t\tx: centerw, y: height\r\n\t});\r\n\tconst wgs2 = GetPickedRayPositionWGS84({\r\n\t\tx: centerw, y: height - 65\r\n\t});\r\n\tif (wgs1 == null || wgs2 == null) {\r\n\t\tothersettings().scalebarstr = '';\r\n\t\treturn;\r\n\t}\r\n\twgs1.height = wgs2.height;\r\n\tconst dis = Cesium.Cartesian3.distance(wgs1.ToCartesian(), wgs2.ToCartesian())\r\n\t// const dis=coordinates.CoordinateWGS84.GetDistancePlane(wgs1,wgs2);\r\n\tif (dis > 1000)\r\n\t\tothersettings().scalebarstr = parseInt(dis / 1000) + \"km\";\r\n\telse\r\n\t\tothersettings().scalebarstr = parseInt(dis) + \"m\";\r\n}\r\n\r\nfunction onmapclocktick() {\r\n\tothersettings().timecontrolstrs.currenttime=Cesium.JulianDate.toDate(GlobalState.viewer.clock.currentTime);\r\n}\r\n\r\n\r\n\r\n\r\nexport function SetScaleBarShow(show) {\r\n\tconst originshow = othersettings().scale;\r\n\tif (originshow != show) {\r\n\t\tif (show === false) {\r\n\t\t\tGlobalState.viewer.scene.postRender.removeEventListener(onscalerenderlist);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tGlobalState.viewer.scene.postRender.addEventListener(onscalerenderlist);\r\n\t\t}\r\n\t\tothersettings().scale = show;\r\n\t}\r\n}\r\n\r\nexport function InitBtns(settings) {\r\n\tif(settings)\r\n\t{\r\n\t\ttooltipbtns.forEach((btn, index) => {\r\n\t\t\tbtn.show = settings[btn.key];\r\n\t\t\tif (btn.show === false) {\r\n\t\t\t\tGlobalState.viewer.mapcontainerbtns[index].forEach(subele => {\r\n\t\t\t\t\tGlobalState.viewer.tooltipcontainer.removeChild(subele);\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t});\r\n\t\tothersettings().timeline = settings.timeline;\r\n\t\tothersettings().animation = settings.animation;\r\n\t\tothersettings().statusbar = settings.statusbar;\r\n\t\tothersettings().lonlat = settings.lonlat;\r\n\t\tothersettings().height = settings.height;\r\n\t\tothersettings().lod = settings.lod;\r\n\t\tothersettings().heading = settings.heading;\r\n\t\tothersettings().pitch = settings.pitch;\r\n\t\tothersettings().roll = settings.roll;\r\n\t\tothersettings().cameraheight = settings.cameraheight;\r\n\t\tothersettings().fps = settings.fps;\r\n\t\tothersettings().lonlatpre = settings.lonlatpre;\r\n\t\t//比例尺控制\r\n\t\tothersettings().scale = settings.scale;\r\n\t\tothersettings().scaleleft = settings.scaleleft;\r\n\t\tothersettings().scaleright = settings.scaleright;\r\n\t\tothersettings().scaletop = settings.scaletop;\r\n\t\tothersettings().scalebottom = settings.scalebottom;\r\n\t}\r\n\telse{\r\n\t\ttooltipbtns.forEach((btn, index) => {\r\n\t\t\tbtn.show = true;\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\tGlobalState.viewer.mapcontainerbtns[7].forEach(subele => {\r\n\t\tsubele.style.right = '0';\r\n\t\tsubele.style.left = othersettings().animation !== true ? '0' : '268px';\r\n\t});\r\n\tconst oriresizef = GlobalState.viewer.timeline.resize;\r\n\tGlobalState.viewer.timeline.resize = function () {\r\n\t\toriresizef.apply(GlobalState.viewer.timeline);\r\n\t\tGlobalState.viewer.mapcontainerbtns[7].forEach(subele => {\r\n\t\t\tsubele.style.right = '0';\r\n\t\t\tsubele.style.left = othersettings().animation !== true ? '0' : '268px';\r\n\t\t});\r\n\t}\r\n\tif (othersettings().timeline === false) {\r\n\t\tGlobalState.viewer.mapcontainerbtns[7].forEach(subele => {\r\n\t\t\tGlobalState.viewer.tooltipcontainer.parentNode.removeChild(subele);\r\n\t\t});\r\n\t}\r\n\r\n\tif (othersettings().statusbar === true) {\r\n\t\tothersettings().statusbarstrs._fpsFrameCount = 0;\r\n\t\tBus.VM.$on(Bus.SignalType.Scene_Mouse_Move, onscenemousemovegetlonlat);\r\n\t\tGlobalState.viewer.scene.postRender.addEventListener(onrenderlist);\r\n\t\tothersettings().statusbarstrs._lastFpsTm = new Date();\r\n\t}\r\n\r\n\tif (othersettings().scale === true) {\r\n\t\tGlobalState.viewer.scene.postRender.addEventListener(onscalerenderlist);\r\n\t}\r\n\r\n\t//time控制\r\n\tGlobalState.viewer.clock.onTick.removeEventListener(onmapclocktick);\r\n\tif(othersettings().animation===true){\r\n\t\tGlobalState.viewer.clock.onTick.addEventListener(onmapclocktick);\r\n\t}\r\n}\r\n\r\nexport function GetSettings() {\r\n\tconst result = {};\r\n\ttooltipbtns.forEach(item => {\r\n\t\tresult[item.key] = item.show;\r\n\t});\r\n\tfor (let key in othersettings().$state) {\r\n\t\tif (key != 'statusbarstrs' &&\r\n\t\t\tkey != 'scalebarstr' &&\r\n\t\t\tkey != 'timecontrolstrs'\r\n\t\t) {\r\n\t\t\tresult[key] = othersettings()[key];\r\n\t\t}\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nfunction findindex(ind) {\r\n\treturn tooltipbtns.findIndex((item, index) => index > ind && item.show === true);\r\n}\r\n\r\nfunction showindex(index) {\r\n\tlet nextidx = findindex(index);\r\n\tif (nextidx == -1) {\r\n\t\tGlobalState.viewer.mapcontainerbtns[index].forEach(ele => {\r\n\t\t\tGlobalState.viewer.tooltipcontainer.appendChild(ele);\r\n\t\t})\r\n\t}\r\n\telse {\r\n\t\tlet i = GlobalState.viewer.mapcontainerbtns[index].length - 1;\r\n\t\tlet ele = GlobalState.viewer.mapcontainerbtns[nextidx][0];\r\n\t\tdo {\r\n\t\t\tGlobalState.viewer.tooltipcontainer.insertBefore(\r\n\t\t\t\tGlobalState.viewer.mapcontainerbtns[index][i], ele);\r\n\t\t\tele = GlobalState.viewer.mapcontainerbtns[index][i];\r\n\t\t\ti--;\r\n\t\t} while (i >= 0);\r\n\t}\r\n}\r\n\r\nfunction hidenindex(index) {\r\n\tGlobalState.viewer.mapcontainerbtns[index].forEach(ele => {\r\n\t\tGlobalState.viewer.tooltipcontainer.removeChild(ele);\r\n\t})\r\n}\r\n\r\nfunction setindexvisib(index, visibility) {\r\n\tif (visibility === true) {\r\n\t\tshowindex(index);\r\n\t}\r\n\telse {\r\n\t\thidenindex(index);\r\n\t}\r\n}\r\n\r\nexport function SetToolbarBtnShow(key, show) {\r\n\tconst curindex = tooltipbtns.findIndex(item => item.key == key);\r\n\tif (curindex == -1) return;\r\n\tconst originshow = tooltipbtns[curindex].show;\r\n\tif (originshow != show) {\r\n\t\tsetindexvisib(curindex, show);\r\n\t\ttooltipbtns[curindex].show = show;\r\n\t}\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n","<!--\r\n * Created by wqy\r\n * Date 2024/1/3 10:10\r\n * Description\r\n-->\r\n<template>\r\n    <div id=\"studio\">\r\n        <div id=\"FySceneContainer\">\r\n        </div>\r\n        <div id=\"Statusbar\" v-if=\"otS.statusbar\" :style=\"otS.timeline===true?'bottom:30px;':''\">{{otS.statuscontents}}</div>\r\n        <div id=\"Scalebar\" v-if=\"otS.scale&&otS.scalecontents!=''\" :style=\"getscalestyle()\">\r\n            <div class=\"scalelabel\">{{otS.scalecontents}}</div>\r\n            <div class=\"scaleb\"></div>\r\n        </div>\r\n        <div id=\"Animationbar\" v-if=\"otS.animation\">\r\n            <div @click=\"otS.toggleshouldanimate()\" :title=\"otS.timecontrolstrs.shouldanimate?'暂停':'继续'\">\r\n                <svg v-if=\"!otS.timecontrolstrs.shouldanimate\" width=\"20\" height=\"20\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"48\" height=\"48\" fill=\"white\" fill-opacity=\"0.01\"></rect><path d=\"M15 24V11.8756L25.5 17.9378L36 24L25.5 30.0622L15 36.1244V24Z\" fill=\"none\" stroke=\"#ffffff\" stroke-width=\"5\" stroke-linejoin=\"round\"></path></svg>\r\n                <svg v-if=\"otS.timecontrolstrs.shouldanimate\" width=\"20\" height=\"20\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"48\" height=\"48\" fill=\"white\" fill-opacity=\"0.01\"></rect><path d=\"M16 12V36\" stroke=\"#ffffff\" stroke-width=\"5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path><path d=\"M32 12V36\" stroke=\"#ffffff\" stroke-width=\"5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg>\r\n            </div>\r\n            <div title=\"回到当前时间\" @click=\"otS.BackToNow()\">\r\n                <svg width=\"20\" height=\"20\" style=\"margin-top: 6px;\" viewBox=\"0 0 48 58\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"48\" height=\"48\" fill=\"white\" fill-opacity=\"0.01\"></rect><rect width=\"48\" height=\"58\" fill=\"white\" fill-opacity=\"0.01\"></rect><path d=\"M34.0234 6.68921C31.0764 4.97912 27.6525 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44C35.0457 44 44 35.0457 44 24C44 20.3727 43.0344 16.9709 41.3461 14.0377\" stroke=\"#ffffff\" stroke-width=\"4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path><path d=\"M31.9498 16.0502C31.9498 16.0502 28.5621 25.0947 27.0001 26.6568C25.438 28.2189 22.9053 28.2189 21.3432 26.6568C19.7811 25.0947 19.7811 22.562 21.3432 20.9999C22.9053 19.4378 31.9498 16.0502 31.9498 16.0502Z\" fill=\"none\" stroke=\"#ffffff\" stroke-width=\"4\" stroke-linejoin=\"round\"></path></svg>\r\n            </div>\r\n            <span>{{otS.currentMapTime}}</span>\r\n            <el-input-number\r\n                    v-model=\"otS.timecontrolstrs.step\"\r\n                    :min=\"-10\"\r\n                    :max=\"10\"\r\n                    controls-position=\"right\"\r\n                    @change=\"otS.SetAniStep()\"\r\n            />\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n\timport { CesiumViewer  } from '../buss/maphandler';\r\n\timport {othersettings} from \"./Widgets/buss/widgets\";\r\n    import {ref,onMounted} from 'vue'\r\n\r\n    const otS=othersettings();\r\n\r\n    function getscalestyle(){\r\n    \tlet horizon='left:80px',vertical='bottom:30px';\r\n\r\n\t\tif(otS.scaleleft!=null&&otS.scaleleft!='') horizon=`left:${otS.scaleleft}`;\r\n        else if(otS.scaleright!=null&&otS.scaleright!='')horizon=`right:${otS.scaleright}`;\r\n\r\n\r\n\t\tif(otS.scaletop!=null&&otS.scaletop!='') vertical= `top:${otS.scaletop}`;\r\n\t\telse if(otS.scalebottom!=null&&otS.scalebottom!='') vertical= `bottom:${otS.scalebottom}`;\r\n\r\n\r\n    \treturn `${horizon};${vertical};`\r\n    }\r\n\r\n\r\n\r\n\r\n\tonMounted(() => {\r\n        debugger\r\n        CesiumViewer([], 'FySceneContainer');\r\n\t});\r\n\r\n\r\n</script>\r\n\r\n\r\n\r\n<style lang=\"less\">\r\n    #studio{\r\n        width:100%;height:100%;overflow:hidden;\r\n        position:relative;\r\n        #FySceneContainer{\r\n            width:100%;height:100%;\r\n            text-align: left;\r\n            .cesium-baseLayerPicker-choices{\r\n                /*display: flex;*/\r\n            }\r\n        }\r\n        #Statusbar{\r\n            padding: 3px 10px;\r\n            font-size: 13px;\r\n            color: #e9e9e9;\r\n            background-color: #0006;\r\n            min-height: 26px;\r\n            pointer-events: none;\r\n            /*width:50%;*/\r\n            position:absolute;\r\n            bottom:0;right:0;\r\n            /*left:50%;*/\r\n\r\n            text-align: right;\r\n        }\r\n        #Scalebar{\r\n            position:absolute;\r\n            width:65px;\r\n            height:25px;\r\n            pointer-events:none;\r\n            -webkit-user-select:none;\r\n            -webkit-user-select:none;\r\n            .scalelabel{\r\n                font-size: 13px;\r\n                color: #fff;\r\n                text-align: center;\r\n                width: 100%;\r\n            }\r\n            .scaleb{\r\n               width:100%;\r\n                left:0;\r\n                position: absolute;\r\n                height:10px;\r\n                top:10px;\r\n                border:1px solid white;\r\n                border-top:none;\r\n            }\r\n        }\r\n        #Animationbar{\r\n            position:absolute;left:0;bottom:0;height:27px;width:268px;\r\n            color:white;\r\n            z-index: 999;\r\n            background: linear-gradient(to bottom,#747577cc,#3a4452cc 11%,#2e3238cc,#353535cc 81%,#353535cc);\r\n            >div:not(.el-input-number){\r\n                display: inline-block;\r\n                vertical-align: middle;\r\n                /*padding: 1px 8px;*/\r\n                border: solid 1px #888;\r\n                color: #fff;\r\n                background-color: #3f4854b3;\r\n                border: none;\r\n                cursor: pointer;\r\n                width: 24px;\r\n            }\r\n            >span{\r\n                margin: 0 4px;\r\n                font-size: 13px;\r\n                -webkit-user-select: none;\r\n                -moz-user-select: none;\r\n                -ms-user-select: none;\r\n                user-select: none;\r\n            }\r\n            >div.el-input-number {\r\n                width: 80px;\r\n                height: 24px;\r\n\r\n                outline:none;\r\n                padding: 0 3px;\r\n                margin: 0;\r\n                color: #fff;\r\n                background: #181b24;\r\n                border: 1px solid #2d2f37;\r\n                .el-input{\r\n                    --el-input-border-color:transparent;\r\n                    --el-input-text-color:white;\r\n\r\n\r\n                }\r\n\r\n                .el-input__wrapper {\r\n                    background-color: transparent;\r\n                    padding-right: 22px;\r\n                    padding-left: 10px;\r\n                }\r\n            }\r\n            >div.el-input-number.is-controls-right .el-input-number__decrease, >div.el-input-number.is-controls-right .el-input-number__increase{\r\n                --el-input-number-controls-height: 10px;\r\n                --el-fill-color-light:transparent;\r\n                --color:white;\r\n                opacity: 0;\r\n                border:none;\r\n                width:20px;\r\n            }\r\n\r\n\r\n            >div.el-input-number.is-controls-right:hover .el-input-number__decrease,\r\n            >div.el-input-number.is-controls-right:hover .el-input-number__increase{\r\n\r\n                opacity:1;\r\n            }\r\n\r\n        }\r\n    }\r\n</style>\r\n","import script from \"./studio.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./studio.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./studio.vue?vue&type=style&index=0&id=3347f1bc&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","<!--\r\n * Created by wqy\r\n * Date 2024/1/5 10:18\r\n * Description\r\n-->\r\n<template>\r\n    <div id=\"Souce\">\r\n        <el-form label-width=\"6em\" label-position=\"left\">\r\n            <el-form-item label=\"标题\"\r\n                          :rules=\"[\r\n                                {\r\n                                  required: true,\r\n                                  trigger: 'blur',\r\n                                }]\">\r\n                <el-input v-model=\"souSt.title\"/>\r\n            </el-form-item>\r\n            <el-form-item label=\"描述\">\r\n                <el-input v-model=\"souSt.remark\" type=\"textarea\"/>\r\n            </el-form-item>\r\n            <el-form-item label=\"标签\">\r\n                <el-select v-model=\"souSt.dataTag\" placeholder=\"请选择\" popper-class=\"popper\">\r\n                    <el-option v-for=\"(item,index) in tags\" :label=\"item.name\" :value=\"item.configValue\"/>\r\n                </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"封面\">\r\n                <div class=\"imgcont\">\r\n                    <img ref=\"thumbnailImgref\" :src=\"souSt.thumbnailsrc\">\r\n                    <button type=\"button\" title=\"将地图调整到理想位置,点击将进行截图操作\" @click=\"onclickcapture\">\r\n                        <span>\r\n                        <svg width=\"14\" height=\"14\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path\r\n                                d=\"M16 6H8C6.89543 6 6 6.89543 6 8V16\" stroke=\"#FFFFFF\" stroke-width=\"4\"\r\n                                stroke-linecap=\"round\" stroke-linejoin=\"round\"></path><path\r\n                                d=\"M16 42H8C6.89543 42 6 41.1046 6 40V32\" stroke=\"#FFFFFF\" stroke-width=\"4\"\r\n                                stroke-linecap=\"round\" stroke-linejoin=\"round\"></path><path\r\n                                d=\"M32 42H40C41.1046 42 42 41.1046 42 40V32\" stroke=\"#FFFFFF\" stroke-width=\"4\"\r\n                                stroke-linecap=\"round\" stroke-linejoin=\"round\"></path><path\r\n                                d=\"M32 6H40C41.1046 6 42 6.89543 42 8V16\" stroke=\"#FFFFFF\" stroke-width=\"4\"\r\n                                stroke-linecap=\"round\" stroke-linejoin=\"round\"></path><rect x=\"14\" y=\"14\" width=\"20\"\r\n                                                                                            height=\"20\" rx=\"2\"\r\n                                                                                            fill=\"none\" stroke=\"#FFFFFF\"\r\n                                                                                            stroke-width=\"4\"></rect></svg>\r\n                     </span>\r\n                    </button>\r\n                </div>\r\n            </el-form-item>\r\n        </el-form>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    import {soucesettings,GetThumbnailImgUrl,CaptureUploadImg} from \"./buss/Source\";\r\n    import {ref,onMounted} from 'vue'\r\n\r\n\r\n    const souSt=soucesettings();\r\n\t// const { proxy } = getCurrentInstance();\r\n\r\n\r\n\tconst tags=ref([]);\r\n\tonMounted(()=>{\r\n\t    // debugger\r\n\t\t// proxy\r\n\t\t// \t.$get(FyConfig.IP+\"/admin/propsConfig/queryPropsConfigByCode?code=data_tag\")\r\n\t\t// \t.then((res) => {\r\n\t\t// \t\ttags.value=res.data;\r\n        //     });\r\n\r\n    });\r\n\r\n\r\n\r\n\tfunction onclickcapture() {\r\n\t\tCaptureUploadImg(function (filePath) {\r\n\t\t\tsouSt.setThumbnailUrl(filePath);\r\n\t\t})\r\n\r\n\r\n\t}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n    #Souce {\r\n        padding: 16px 20px;\r\n        color: white;\r\n        .imgcont {\r\n            > img {\r\n                width: 123px;\r\n                height: 123px;\r\n                border-radius: 4px;\r\n                object-fit: contain;\r\n                display:block;\r\n\r\n            }\r\n            > button {\r\n                display: inline-block;\r\n                height: 30px;\r\n                line-height: 30px;\r\n                background: #181b24;\r\n                border: 1px solid #2d2f37;\r\n                border-radius: 4px;\r\n                font-size: 12px;\r\n\r\n                font-weight: 500;\r\n                color: #fff;\r\n                padding: 0 5px;\r\n                cursor: pointer;\r\n                min-width: 30px;\r\n                text-align: center;\r\n                vertical-align: middle;\r\n\r\n                > span {\r\n                    font-size: 18px !important;\r\n                    line-height: 18px;\r\n                    vertical-align: middle !important;\r\n                    padding-left: 2px;\r\n                    padding-right: 2px;\r\n                }\r\n            }\r\n        }\r\n    }\r\n</style>\r\n<style lang=\"less\">\r\n    #Souce {\r\n        --el-text-color-regular: #b6bcc5;\r\n        --el-font-size-base: 12px;\r\n        .el-input, .el-textarea {\r\n            --el-input-bg-color: #181b24;\r\n            --el-input-border-color: #2d2f37;\r\n        }\r\n    }\r\n</style>\r\n","import script from \"./Souce.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Souce.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Souce.vue?vue&type=style&index=0&id=3be3cfeb&lang=less&scoped=true\"\nimport \"./Souce.vue?vue&type=style&index=1&id=3be3cfeb&lang=less\"\n\nimport exportComponent from \"C:\\\\work\\\\study\\\\demos\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3be3cfeb\"]])\n\nexport default __exports__","const SkyBoxFS =\r\n\t\"uniform samplerCube u_cubeMap;\\n\\\r\n\\n\\\r\nvarying vec3 v_texCoord;\\n\\\r\n\\n\\\r\nvoid main()\\n\\\r\n{\\n\\\r\n    vec4 color = textureCube(u_cubeMap, normalize(v_texCoord));\\n\\\r\n    gl_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);\\n\\\r\n}\\n\\\r\n\";\r\n// 顶点着色器 多乘了一个旋转矩阵(u_rotateMatrix)\r\nconst SkyBoxVS =\r\n\t`#define PI 3.141592653589793;\r\n\tattribute vec3 position;\r\nvarying vec3 v_texCoord;\r\nuniform mat3 u_rotateMatrix;\r\nuniform float u_speed;\r\nuniform float u_rotate;\r\nvoid main()\r\n{\r\n    float t = clamp(fract(czm_frameNumber * u_speed / 1000.0),0.0,1.0);\t\r\n\tfloat angle = t*2.*PI;\r\n\tmat3 rotate = mat3(cos(angle),-sin(angle),0.,sin(angle),cos(angle),0.,0.,0.,1.);\r\n\tvec3 p = vec3(1.);\r\n\tif(u_rotate == 1.0){\r\n\t\tp = czm_viewRotation  * u_rotateMatrix * rotate * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\r\n\t}else{\r\n\t\tp = czm_viewRotation  * u_rotateMatrix * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\r\n\t}\r\n\t\r\n\tgl_Position = czm_projection  * vec4(p, 1.0);\r\n\tv_texCoord = position.xyz;\r\n}\r\n\r\n`;\r\n\r\nif (!Cesium.defined(Cesium.Matrix4.getRotation)) {\r\n    Cesium.Matrix4.getRotation = Cesium.Matrix4.getMatrix3;\r\n  }\r\nconst skyboxMatrix3 = new  Cesium.Matrix3();\r\n/**\r\n * A sky box around the scene to draw stars.  The sky box is defined using the True Equator Mean Equinox (TEME) axes.\r\n * <p>\r\n * This is only supported in 3D.  The sky box is faded out when morphing to 2D or Columbus view.  The size of\r\n * the sky box must not exceed {@link Scene#maximumCubeMapSize}.\r\n * </p>\r\n *\r\n * @alias SkyBox\r\n * @constructor\r\n *\r\n * @param {object} options Object with the following properties:\r\n * @param {object} [options.sources] The source URL or <code>Image</code> object for each of the six cube map faces.  See the example below.\r\n * @param {boolean} [options.show=true] Determines if this primitive will be shown.\r\n *\r\n *\r\n * @example\r\n * scene.skyBox = new Cesium.SkyBox({\r\n *   sources : {\r\n *     positiveX : 'skybox_px.png',\r\n *     negativeX : 'skybox_nx.png',\r\n *     positiveY : 'skybox_py.png',\r\n *     negativeY : 'skybox_ny.png',\r\n *     positiveZ : 'skybox_pz.png',\r\n *     negativeZ : 'skybox_nz.png'\r\n *   }\r\n * });\r\n *\r\n * @see Scene#skyBox\r\n * @see Transforms.computeTemeToPseudoFixedMatrix\r\n */\r\nfunction SkyBox(options) {\r\n\t/**\r\n\t * The sources used to create the cube map faces: an object\r\n\t * with <code>positiveX</code>, <code>negativeX</code>, <code>positiveY</code>,\r\n\t * <code>negativeY</code>, <code>positiveZ</code>, and <code>negativeZ</code> properties.\r\n\t * These can be either URLs or <code>Image</code> objects.\r\n\t *\r\n\t * @type {object}\r\n\t * @default undefined\r\n\t */\r\n\tthis.sources = options.sources;\r\n\tthis._sources = undefined;\r\n\t// 是否旋转\r\n\t// this.isRotate = options?.rotate ?? false;\r\n\tthis.isRotate = options&&options.rotate?options.rotate:false;\r\n\t// 旋转速度\r\n\t// this.rotateSpeed = options?.speed ?? 0.01;\r\n\tif(options.speed>0){\r\n\t\tdebugger\r\n\t}\r\n\tthis.rotateSpeed = options&&options.speed?options.speed:0.01;\r\n\t/**\r\n\t * Determines if the sky box will be shown.\r\n\t *\r\n\t * @type {boolean}\r\n\t * @default true\r\n\t */\r\n\tthis.show = Cesium.defaultValue(options.show, true);\r\n\r\n\tthis._command = new Cesium.DrawCommand({\r\n\t\tmodelMatrix: Cesium.Matrix4.clone(Cesium.Matrix4.IDENTITY),\r\n\t\towner: this,\r\n\t});\r\n\tthis._cubeMap = undefined;\r\n\r\n\tthis._attributeLocations = undefined;\r\n\tthis._useHdr = undefined;\r\n}\r\n\r\n/**\r\n * Called when {@link Viewer} or {@link CesiumWidget} render the scene to\r\n * get the draw commands needed to render this primitive.\r\n * <p>\r\n * Do not call this function directly.  This is documented just to\r\n * list the exceptions that may be propagated when the scene is rendered:\r\n * </p>\r\n *\r\n * @exception {Cesium.DeveloperError} this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.\r\n * @exception {Cesium.DeveloperError} this.sources properties must all be the same type.\r\n */\r\nSkyBox.prototype.update = function (frameState, useHdr) {\r\n\tconst that = this;\r\n\r\n\tif (!this.show) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tif (frameState.mode !== Cesium.SceneMode.SCENE3D && frameState.mode !== Cesium.SceneMode.MORPHING) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t// The sky box is only rendered during the render pass; it is not pickable, it doesn't cast shadows, etc.\r\n\tif (!frameState.passes.render) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tconst context = frameState.context;\r\n\r\n\tif (this._sources !== this.sources) {\r\n\t\tthis._sources = this.sources;\r\n\t\tconst sources = this.sources;\r\n\r\n\t\t//>>includeStart('debug', pragmas.debug);\r\n\t\tif (\r\n\t\t\t!Cesium.defined(sources.positiveX) ||\r\n\t\t\t!Cesium.defined(sources.negativeX) ||\r\n\t\t\t!Cesium.defined(sources.positiveY) ||\r\n\t\t\t!Cesium.defined(sources.negativeY) ||\r\n\t\t\t!Cesium.defined(sources.positiveZ) ||\r\n\t\t\t!Cesium.defined(sources.negativeZ)\r\n\t\t) {\r\n\t\t\tthrow new Cesium.DeveloperError(\r\n\t\t\t\t\"this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.\",\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tif (\r\n\t\t\ttypeof sources.positiveX !== typeof sources.negativeX ||\r\n\t\t\ttypeof sources.positiveX !== typeof sources.positiveY ||\r\n\t\t\ttypeof sources.positiveX !== typeof sources.negativeY ||\r\n\t\t\ttypeof sources.positiveX !== typeof sources.positiveZ ||\r\n\t\t\ttypeof sources.positiveX !== typeof sources.negativeZ\r\n\t\t) {\r\n\t\t\tthrow new Cesium.DeveloperError(\"this.sources properties must all be the same type.\");\r\n\t\t}\r\n\t\t//>>includeEnd('debug');\r\n\r\n\t\tif (typeof sources.positiveX === \"string\") {\r\n\t\t\t// Given urls for cube-map images.  Load them.\r\n\t\t\tCesium.loadCubeMap(context, this._sources).then(function (cubeMap) {\r\n\t\t\t\tthat._cubeMap = that._cubeMap && that._cubeMap.destroy();\r\n\t\t\t\tthat._cubeMap = cubeMap;\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis._cubeMap = this._cubeMap && this._cubeMap.destroy();\r\n\t\t\tthis._cubeMap = new Cesium.CubeMap({\r\n\t\t\t\tcontext: context,\r\n\t\t\t\tsource: sources,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tconst command = this._command;\r\n\tcommand.modelMatrix = Cesium.Transforms.eastNorthUpToFixedFrame(frameState.camera._positionWC);\r\n\r\n\tif (!Cesium.defined(command.vertexArray)) {\r\n\t\tcommand.uniformMap = {\r\n\t\t\tu_cubeMap: function () {\r\n\t\t\t\treturn that._cubeMap;\r\n\t\t\t},\r\n\t\t\tu_rotateMatrix: function () {\r\n\t\t\t\treturn Cesium.Matrix4.getRotation(command.modelMatrix, skyboxMatrix3);\r\n\t\t\t},\r\n\t\t\tu_speed: function () {\r\n\t\t\t\treturn that.rotateSpeed;\r\n\t\t\t},\r\n\t\t\tu_rotate: function () {\r\n\t\t\t\treturn that.isRotate == false ? 0 : 1;\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tconst geometry = Cesium.BoxGeometry.createGeometry(\r\n\t\t\tCesium.BoxGeometry.fromDimensions({\r\n\t\t\t\tdimensions: new Cesium.Cartesian3(2.0, 2.0, 2.0),\r\n\t\t\t\tvertexFormat: Cesium.VertexFormat.POSITION_ONLY,\r\n\t\t\t}),\r\n\t\t);\r\n\t\tconst attributeLocations = (this._attributeLocations = Cesium.GeometryPipeline.createAttributeLocations(geometry));\r\n\r\n\t\tcommand.vertexArray = Cesium.VertexArray.fromGeometry({\r\n\t\t\tcontext: context,\r\n\t\t\tgeometry: geometry,\r\n\t\t\tattributeLocations: attributeLocations,\r\n\t\t\tbufferUsage: Cesium.BufferUsage.STATIC_DRAW,\r\n\t\t});\r\n\r\n\t\tcommand.renderState = Cesium.RenderState.fromCache({\r\n\t\t\tblending: Cesium.BlendingState.ALPHA_BLEND,\r\n\t\t});\r\n\t}\r\n\r\n\tif (!Cesium.defined(command.shaderProgram) || this._useHdr !== useHdr) {\r\n\t\tconst fs = new Cesium.ShaderSource({\r\n\t\t\tdefines: [useHdr ? \"HDR\" : \"\"],\r\n\t\t\tsources: [SkyBoxFS],\r\n\t\t});\r\n\t\tcommand.shaderProgram = Cesium.ShaderProgram.fromCache({\r\n\t\t\tcontext: context,\r\n\t\t\tvertexShaderSource: SkyBoxVS,\r\n\t\t\tfragmentShaderSource: fs,\r\n\t\t\tattributeLocations: this._attributeLocations,\r\n\t\t});\r\n\t\tthis._useHdr = useHdr;\r\n\t}\r\n\r\n\tif (!Cesium.defined(this._cubeMap)) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\treturn command;\r\n};\r\n\r\n/**\r\n * Returns true if this object was destroyed; otherwise, false.\r\n * <br /><br />\r\n * If this object was destroyed, it should not be used; calling any function other than\r\n * <code>isDestroyed</code> will result in a {@link Cesium.DeveloperError} exception.\r\n *\r\n * @returns {boolean} <code>true</code> if this object was destroyed; otherwise, <code>false</code>.\r\n *\r\n * @see SkyBox#destroy\r\n */\r\nSkyBox.prototype.isDestroyed = function () {\r\n\treturn false;\r\n};\r\n\r\n/**\r\n * Destroys the WebGL resources held by this object.  Destroying an object allows for deterministic\r\n * release of WebGL resources, instead of relying on the garbage collector to destroy this object.\r\n * <br /><br />\r\n * Once an object is destroyed, it should not be used; calling any function other than\r\n * <code>isDestroyed</code> will result in a {@link Cesium.DeveloperError} exception.  Therefore,\r\n * assign the return value (<code>undefined</code>) to the object as done in the example.\r\n *\r\n * @exception {Cesium.DeveloperError} This object was destroyed, i.e., destroy() was called.\r\n *\r\n *\r\n * @example\r\n * skyBox = skyBox && skyBox.destroy();\r\n *\r\n * @see SkyBox#isDestroyed\r\n */\r\nSkyBox.prototype.destroy = function () {\r\n\tconst command = this._command;\r\n\tcommand.vertexArray = command.vertexArray && command.vertexArray.destroy();\r\n\tcommand.shaderProgram = command.shaderProgram && command.shaderProgram.destroy();\r\n\tthis._cubeMap = this._cubeMap && this._cubeMap.destroy();\r\n\treturn Cesium.destroyObject(this);\r\n};\r\nexport default SkyBox;\r\n","/**\r\n * Created by wqy\r\n * Date 2024/1/18 17:48\r\n * Description\r\n */\r\n\r\nimport {defineStore} from \"pinia\";\r\nimport {GlobalState} from \"../../../buss/maphandler\";\r\n\r\n\r\nimport GroundSkyBox from \"@/modules/cesium/common/buss/GroundSkyBox.js\";\r\n\r\n\r\nlet sunsetting = {\r\n\t_sunPositionWC: new Cesium.Cartesian3(),\r\n\t_sunDirectionWC: new Cesium.Cartesian3(),\r\n\t_sunPositionColumbusView: new Cesium.Cartesian3()\r\n};\r\nexport const circumsettings=defineStore('circumsettings',{\r\n\tstate: () => {\r\n\t\treturn {\r\n\t\t\tscenemode:\"1\",\r\n\t\t\tshowSun:true,\r\n\t\t\tshowMoon:true,\r\n\t\t\tbackmode: '1',\r\n\t\t\tbackmodepars: {\r\n\t\t\t\tskyboxnum:\"1\",\r\n\t\t\t\tskyboxrotate:false,\r\n\t\t\t\tskyboxrs:0,\r\n\t\t\t\tcolorcss:'#5B86AA',\r\n\t\t\t},\r\n\r\n\t\t\toutatm:true,\r\n\t\t\tfog:true,\r\n\t\t\tearthatm:true,\r\n\t\t\thighdyren:false,\r\n\t\t\tglobalcol:'#0D4DB5',\r\n\r\n\t\t\tfixedlight:false,\r\n\t\t\tshadow:false,\r\n\t\t\tterrainsh:false,\r\n\t\t\tshowdaynight:false,\r\n\r\n\t\t\t// exciplityrend:true,\r\n\t\t\tfxaa:true,\r\n\t\t\tdepthtest:true,\r\n\t\t}\r\n\t},\r\n\tactions:{\r\n\t\tSetBackModes(){\r\n\t\t\t//state中已经更新成newval\r\n\t\t\tswitch (this.backmode) {\r\n\t\t\t\tcase \"1\":\r\n\t\t\t\t\tGlobalState.viewer.scene.skyBox.show=true;\r\n\t\t\t\t\tGlobalState.viewer.scene.skyBox = new GroundSkyBox({\r\n\t\t\t\t\t\tsources: {\r\n\t\t\t\t\t\t\tnegativeX: `/img/skybox/${this.backmodepars.skyboxnum}/nx.png`,\r\n\t\t\t\t\t\t\tpositiveX: `/img/skybox/${this.backmodepars.skyboxnum}/px.png`,\r\n\t\t\t\t\t\t\tnegativeY: `/img/skybox/${this.backmodepars.skyboxnum}/ny.png`,\r\n\t\t\t\t\t\t\tpositiveY: `/img/skybox/${this.backmodepars.skyboxnum}/py.png`,\r\n\t\t\t\t\t\t\tnegativeZ: `/img/skybox/${this.backmodepars.skyboxnum}/nz.png`,\r\n\t\t\t\t\t\t\tpositiveZ: `/img/skybox/${this.backmodepars.skyboxnum}/pz.png`,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\trotate: this.backmodepars.skyboxrotate,\r\n\t\t\t\t\t\tspeed: this.backmodepars.skyboxrs,\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"2\":\r\n\t\t\t\t\tGlobalState.viewer.scene.skyBox.show=false;\r\n\t\t\t\t\tGlobalState.viewer.scene.backgroundColor=Cesium.Color.fromCssColorString(this.backmodepars.colorcss);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\tSetSunShow(){\r\n\t\t\tGlobalState.viewer.scene.sun.show=this.showSun;\r\n\r\n\t\t},\r\n\t\tSetMoonShow(){\r\n\t\t\tGlobalState.viewer.scene.moon.show=this.showMoon;\r\n\t\t},\r\n\r\n\t\tSetSceneMode(){\r\n\t\t\tswitch (this.scenemode) {\r\n\t\t\t\tcase \"1\":\r\n\t\t\t\t\tGlobalState.viewer.scene.mode=Cesium.SceneMode.SCENE3D;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"2\":\r\n\t\t\t\t\tGlobalState.viewer.scene.mode=Cesium.SceneMode.SCENE2D;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"3\":\r\n\t\t\t\t\tGlobalState.viewer.scene.mode=Cesium.SceneMode.COLUMBUS_VIEW;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tSetOutAtmos(){\r\n\t\t\tGlobalState.viewer.scene.skyAtmosphere.show=this.outatm;\r\n\t\t},\r\n\t\tSetGoundAtmos(){\r\n\t\t\tGlobalState.viewer.scene.globe.showGroundAtmosphere=this.earthatm;\r\n\t\t},\r\n\t\tSetFog(){\r\n\t\t\tGlobalState.viewer.scene.fog.enabled=this.fog;\r\n\t\t},\r\n\t\tSetHdr(){\r\n\t\t\tGlobalState.viewer.scene.highDynamicRange=this.highdyren;\r\n\t\t},\r\n\t\tSetGlobeColor(){\r\n\t\t\tGlobalState.viewer.scene.globe.baseColor=Cesium.Color.fromCssColorString(this.globalcol);\r\n\t\t},\r\n\r\n\t\tSetFixLight(){\r\n\t\t\tif(this.fixedlight===true){\r\n\t\t\t\tsetSunAndMoonDirections(\r\n\t\t\t\t\tsunsetting, Cesium.JulianDate.fromDate(new Date()),\r\n\t\t\t\t\tGlobalState.viewer.scene._frameState.mapProjection);\r\n\r\n\t\t\t\tGlobalState.viewer.scene.light=new Cesium.DirectionalLight({\r\n\t\t\t\t\tdirection:sunsetting._sunDirectionWC\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tsetSunAndMoonDirections(\r\n\t\t\t\t\tsunsetting, GlobalState.viewer.clock.currentTime,\r\n\t\t\t\t\tGlobalState.viewer.scene._frameState.mapProjection);\r\n\t\t\t\tGlobalState.viewer.scene.light=new Cesium.SunLight();\r\n\t\t\t}\r\n\t\t},\r\n\t\tSetShadow(){\r\n\t\t\tGlobalState.viewer.shadows = this.shadow;\r\n\t\t},\r\n\t\tSetTerrainShadow(){\r\n\t\t\tGlobalState.viewer.terrainShadows= (this.terrainsh==true?Cesium.ShadowMode.ENABLED:Cesium.ShadowMode.DISABLED);\r\n\t\t},\r\n\t\tSetDayNight(){\r\n\t\t\tGlobalState.viewer.scene.globe.enableLighting=this.showdaynight;\r\n\t\t},\r\n\t\tSetFxaa(){\r\n\t\t\tGlobalState.viewer.scene.postProcessStages.fxaa.enabled = this.fxaa;\r\n\t\t},\r\n\t\tSetDepthTest(){\r\n\t\t\tGlobalState.viewer.scene.globe.depthTestAgainstTerrain = this.depthtest;\r\n\t\t}\r\n\r\n\r\n\r\n\r\n\t},\r\n\r\n\r\n})\r\n\r\n\r\nexport function InitCircumSt(settings) {\r\n\tif (settings) {\r\n\t\tfor (let key in settings) {\r\n\t\t\tcircumsettings()[key] =settings[key];\r\n\t\t}\r\n\t}\r\n\tcircumsettings().SetBackModes();\r\n\tcircumsettings().SetSunShow();\r\n\tcircumsettings().SetMoonShow();\r\n\tcircumsettings().SetSceneMode();\r\n\tcircumsettings().SetOutAtmos();\r\n\tcircumsettings().SetGoundAtmos();\r\n\tcircumsettings().SetFog();\r\n\tcircumsettings().SetHdr();\r\n\tcircumsettings().SetGlobeColor();\r\n\tcircumsettings().SetFixLight();\r\n\tcircumsettings().SetShadow();\r\n\tcircumsettings().SetTerrainShadow();\r\n\tcircumsettings().SetDayNight();\r\n\tcircumsettings().SetFxaa();\r\n\tcircumsettings().SetDepthTest();\r\n}\r\n\r\nexport function GetCircumSt() {\r\n\tconst result={};\r\n\tfor (let key in circumsettings().$state) {\r\n\t\tresult[key] =circumsettings()[key];\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nlet transformMatrix = new Cesium.Matrix3();\r\nconst sunCartographicScratch = new Cesium.Cartographic();\r\n\r\nfunction setSunAndMoonDirections(result, time, mapProjection) {\r\n\r\n\tif (\r\n\t\t!Cesium.defined(\r\n\t\t\tCesium.Transforms.computeIcrfToFixedMatrix(time, transformMatrix)\r\n\t\t)\r\n\t) {\r\n\t\ttransformMatrix = Cesium.Transforms.computeTemeToPseudoFixedMatrix(\r\n\t\t\ttime,\r\n\t\t\ttransformMatrix\r\n\t\t);\r\n\t}\r\n\r\n\tlet position = Cesium.Simon1994PlanetaryPositions.computeSunPositionInEarthInertialFrame(\r\n\t\ttime,\r\n\t\tresult._sunPositionWC\r\n\t);\r\n\tCesium.Matrix3.multiplyByVector(transformMatrix, position, position);\r\n\r\n\tCesium.Cartesian3.normalize(position, result._sunDirectionWC);\r\n\r\n\r\n\t// position = Cesium.Simon1994PlanetaryPositions.computeMoonPositionInEarthInertialFrame(\r\n\t//     time,\r\n\t//     uniformState._moonDirectionEC\r\n\t// );\r\n\t// Matrix3.multiplyByVector(transformMatrix, position, position);\r\n\t// Matrix3.multiplyByVector(uniformState.viewRotation3D, position, position);\r\n\t// Cartesian3.normalize(position, position);\r\n\r\n\tconst projection = mapProjection;\r\n\tconst ellipsoid = projection.ellipsoid;\r\n\tconst sunCartographic = ellipsoid.cartesianToCartographic(\r\n\t\tresult._sunPositionWC,\r\n\t\tsunCartographicScratch\r\n\t);\r\n\tprojection.project(sunCartographic, result._sunPositionColumbusView);\r\n}\r\n\r\n","<!--\r\n * Created by wqy\r\n * Date 2024/1/5 10:19\r\n * Description\r\n-->\r\n<template>\r\n    <div id=\"Circum\">\r\n        <el-collapse v-model=\"activeNames\">\r\n            <el-collapse-item title=\"二三维模式\" name=\"1\">\r\n                <div class=\"swichcontent\">\r\n                    <span>场景模式:</span>\r\n                    <el-select popper-class=\"popper\" v-model=\"crSt.scenemode\" placeholder=\"请选择\">\r\n                        <el-option label=\"三维视图\" value=\"1\"/>\r\n                        <el-option label=\"二维视图\" value=\"2\"/>\r\n                        <el-option label=\"哥伦布视图\" value=\"3\"/>\r\n                    </el-select>\r\n                </div>\r\n\r\n\r\n            </el-collapse-item>\r\n            <el-collapse-item title=\"太空背景\" name=\"2\">\r\n                <div class=\"swichcontent\">\r\n                    <span>显示太阳:</span>\r\n                    <el-switch v-model=\"crSt.showSun\"></el-switch>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>显示月亮:</span>\r\n                    <el-switch v-model=\"crSt.showMoon\"></el-switch>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>背景模式:</span>\r\n                    <el-select popper-class=\"popper\" v-model=\"crSt.backmode\" placeholder=\"请选择\">\r\n                        <el-option label=\"天空盒\" value=\"1\"/>\r\n                        <el-option label=\"纯色\" value=\"2\"/>\r\n                    </el-select>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"crSt.backmode==1\">\r\n                    <span>天空盒:</span>\r\n                    <el-select popper-class=\"popper\" v-model=\"crSt.backmodepars.skyboxnum\" placeholder=\"请选择\">\r\n                        <el-option label=\"红色宇宙\" value=\"1\"/>\r\n                        <el-option label=\"蓝色宇宙\" value=\"2\"/>\r\n                        <el-option label=\"星云\" value=\"3\"/>\r\n                        <el-option label=\"星系\" value=\"4\"/>\r\n                        <el-option label=\"星空\" value=\"5\"/>\r\n                        <el-option label=\"科幻蓝\" value=\"6\"/>\r\n                        <el-option label=\"多云\" value=\"7\"/>\r\n                        <el-option label=\"蓝黑色\" value=\"8\"/>\r\n                        <el-option label=\"默认黑\" value=\"9\"/>\r\n                    </el-select>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"crSt.backmode==1\">\r\n                    <span>是否旋转:</span>\r\n                    <el-switch v-model=\"crSt.backmodepars.skyboxrotate\" />\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"crSt.backmode==1\">\r\n                    <span>旋转速度:</span>\r\n                    <el-slider v-model=\"crSt.backmodepars.skyboxrs\" :min=\"-10\" :max=\"10\" :step=\"0.01\"/>\r\n                </div>\r\n\r\n                <div class=\"swichcontent\" v-if=\"crSt.backmode==2\">\r\n                    <span>颜色:</span>\r\n                    <el-color-picker v-model=\"crSt.backmodepars.colorcss\" />\r\n                </div>\r\n\r\n\r\n            </el-collapse-item>\r\n            <el-collapse-item title=\"地球效果\" name=\"3\">\r\n                <div class=\"swichcontent\">\r\n                    <span>大气外光圈:</span>\r\n                    <el-switch v-model=\"crSt.outatm\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>启用雾化效果:</span>\r\n                    <el-switch v-model=\"crSt.fog\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>绘制地面大气:</span>\r\n                    <el-switch v-model=\"crSt.earthatm\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>高动态渲染:</span>\r\n                    <el-switch v-model=\"crSt.highdyren\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>地球背景色:</span>\r\n                    <el-color-picker v-model=\"crSt.globalcol\" />\r\n                </div>\r\n\r\n            </el-collapse-item>\r\n            <el-collapse-item title=\"日照\" name=\"4\">\r\n                <div class=\"swichcontent\">\r\n                    <span>固定光照:</span>\r\n                    <el-switch v-model=\"crSt.fixedlight\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>日照阴影:</span>\r\n                    <el-switch v-model=\"crSt.shadow\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"crSt.shadow\">\r\n                    <span>地形阴影:</span>\r\n                    <el-switch v-model=\"crSt.terrainsh\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"!crSt.shadow\">\r\n                    <span>昼夜区域:</span>\r\n                    <el-switch v-model=\"crSt.showdaynight\"/>\r\n                </div>\r\n            </el-collapse-item>\r\n            <el-collapse-item title=\"渲染状态\" name=\"5\">\r\n                <!--<div class=\"swichcontent\">-->\r\n                    <!--<span>显示渲染:</span>-->\r\n                    <!--<el-switch v-model=\"crSt.exciplityrend\"/>-->\r\n                <!--</div>-->\r\n                <div class=\"swichcontent\">\r\n                    <span>抗锯齿:</span>\r\n                    <el-switch v-model=\"crSt.fxaa\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>深度检测:</span>\r\n                    <el-switch v-model=\"crSt.depthtest\"/>\r\n                </div>\r\n            </el-collapse-item>\r\n        </el-collapse>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    import {circumsettings} from \"./buss/circum\";\r\n    const crSt=circumsettings();\r\n    import {ref,onMounted,watch} from 'vue'\r\n\tconst activeNames = ref(['1', '2', '3', '4','5']);\r\n\r\n\twatch(() => crSt.backmode, (newval, oldval) => {\r\n\t\tcrSt.SetBackModes();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.backmodepars.colorcss, (newval, oldval) => {\r\n\t\tcrSt.SetBackModes();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.backmodepars.skyboxnum, (newval, oldval) => {\r\n\t\tcrSt.SetBackModes();\r\n\t}, {deep: true});\r\n\r\n\twatch(() => crSt.backmodepars.skyboxrotate, (newval, oldval) => {\r\n\t\tcrSt.SetBackModes();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.backmodepars.skyboxrs, (newval, oldval) => {\r\n\t\tcrSt.SetBackModes();\r\n\t}, {deep: true});\r\n\r\n\twatch(() => crSt.showSun, (newval, oldval) => {\r\n\t\tcrSt.SetSunShow();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.showMoon, (newval, oldval) => {\r\n\t\tcrSt.SetMoonShow();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.scenemode, (newval, oldval) => {\r\n\t\tcrSt.SetSceneMode();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.outatm, (newval, oldval) => {\r\n\t\tcrSt.SetOutAtmos();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.fog, (newval, oldval) => {\r\n\t\tcrSt.SetFog();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.earthatm, (newval, oldval) => {\r\n\t\tcrSt.SetGoundAtmos();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.highdyren, (newval, oldval) => {\r\n\t\tcrSt.SetHdr();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.globalcol, (newval, oldval) => {\r\n\t\tcrSt.SetGlobeColor();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.fixedlight, (newval, oldval) => {\r\n\t\tcrSt.SetFixLight();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.shadow, (newval, oldval) => {\r\n\t\tcrSt.SetShadow();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.terrainsh, (newval, oldval) => {\r\n\t\tcrSt.SetTerrainShadow();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.showdaynight, (newval, oldval) => {\r\n\t\tcrSt.SetDayNight();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.showdaynight, (newval, oldval) => {\r\n\t\tcrSt.SetFxaa();\r\n\t}, {deep: true});\r\n\twatch(() => crSt.depthtest, (newval, oldval) => {\r\n\t\tcrSt.SetDepthTest();\r\n\t}, {deep: true});\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import script from \"./Circum.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Circum.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","/**\r\n * Created by wqy\r\n * Date 2024/1/23 9:51\r\n * Description\r\n */\r\n\r\nimport {defineStore} from \"pinia\";\r\nimport {GlobalState} from \"../../../buss/maphandler\";\r\nimport {circumsettings} from \"./circum\";\r\nimport {othersettings} from \"./widgets\";\r\n\r\nexport const clocksettings=defineStore('clocksettings',{\r\n\tstate:()=>{\r\n\t\treturn {\r\n\t\t\tstarttime:null,\r\n\t\t\tendtime:null,\r\n\t\t\ttimemode:\"1\",\r\n\t\t\tcurtime:null,\r\n\t\t\tmultiply:1\r\n\t\t}\r\n\t},\r\n\tactions: {\r\n\t\tSetStartTime() {\r\n\t\t\tif(this.starttime)\t{\r\n\t\t\t\tGlobalState.viewer.clock.startTime=Cesium.JulianDate.fromDate(new Date(this.starttime));\r\n\t\t\t}\r\n\t\t},\r\n\t\tSetEndTime() {\r\n\t\t\tif(this.endtime) GlobalState.viewer.clock.stopTime=Cesium.JulianDate.fromDate(new Date(this.endtime));\r\n\t\t},\r\n\t\tSetTimeMode(){\r\n\t\t\tswitch (this.timemode) {\r\n\t\t\t\tcase \"1\":\r\n\t\t\t\t\tGlobalState.viewer.clock.clockRange=Cesium.ClockRange.UNBOUNDED;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"2\":\r\n\t\t\t\t\tGlobalState.viewer.clock.clockRange=Cesium.ClockRange.CLAMPED;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"3\":\r\n\t\t\t\t\tGlobalState.viewer.clock.clockRange=Cesium.ClockRange.LOOP_STOP;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\t\tSetCurTime(){\r\n\t\t\tif(this.curtime) {\r\n\t\t\t\tGlobalState.viewer.clock.currentTime=Cesium.JulianDate.fromDate(new Date(this.curtime));\r\n\t\t\t\tothersettings().timecontrolstrs.currenttime=this.curtime;\r\n\t\t\t}\r\n\t\t},\r\n\t\tSetMultiply()\r\n\t\t{\r\n\t\t\tGlobalState.viewer.clock.multiplier=this.multiply;\r\n\t\t\tothersettings().timecontrolstrs.step=this.multiply;\r\n\t\t}\r\n\t}\r\n\r\n})\r\n\r\nexport function InitClockSt(settings) {\r\n\tif (settings) {\r\n\t\tfor (let key in settings) {\r\n\t\t\tclocksettings()[key] =settings[key];\r\n\t\t}\r\n\t}\r\n\r\n\tclocksettings().SetStartTime();\r\n\tclocksettings().SetEndTime();\r\n\tclocksettings().SetTimeMode();\r\n\tclocksettings().SetCurTime();\r\n\tclocksettings().SetMultiply();\r\n\r\n}\r\n\r\nexport function GetClockSt() {\r\n\tconst result={};\r\n\tfor (let key in clocksettings().$state) {\r\n\t\tresult[key] =clocksettings()[key];\r\n\t}\r\n\treturn result;\r\n}\r\n","<!--\r\n * Created by wqy\r\n * Date 2024/1/5 16:31\r\n * Description\r\n-->\r\n<template>\r\n    <div id=\"clock\">\r\n        <el-collapse v-model=\"activeNames\">\r\n            <el-collapse-item title=\"范围\" name=\"1\">\r\n                <div class=\"swichcontent\">\r\n                    <span>开始时间:</span>\r\n                    <el-date-picker popper-class=\"popper\"\r\n                            v-model=\"clSt.starttime\"\r\n                            type=\"datetime\"\r\n                            placeholder=\"选择时间日期\"\r\n                            @change=\"clSt.SetStartTime()\"\r\n                    />\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>结束时间:</span>\r\n                    <el-date-picker popper-class=\"popper\"\r\n                            v-model=\"clSt.endtime\"\r\n                            type=\"datetime\"\r\n                            placeholder=\"选择时间日期\"\r\n                            @change=\"clSt.SetEndTime()\"\r\n                    />\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>运行模式:</span>\r\n                    <el-select popper-class=\"popper\" placeholder=\"请选择\" v-model=\"clSt.timemode\" @change=\"clSt.SetTimeMode()\">\r\n                        <el-option label=\"UNBOUND\" value=\"1\"/>\r\n                        <el-option label=\"CLAMPED\" value=\"2\"/>\r\n                        <el-option label=\"lOOPSTOP\" value=\"3\"/>\r\n                    </el-select>\r\n                </div>\r\n\r\n            </el-collapse-item>\r\n            <el-collapse-item title=\"时间\" name=\"2\">\r\n                <div class=\"swichcontent\">\r\n                    <span>当前时间:</span>\r\n                    <el-date-picker popper-class=\"popper\"\r\n                            v-model=\"clSt.curtime\"\r\n                            type=\"datetime\"\r\n                            placeholder=\"选择时间日期\"\r\n                            @change=\"clSt.SetCurTime()\"\r\n                    />\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>时钟倍数:</span>\r\n                    <el-input-number\r\n                            v-model=\"clSt.multiply\"\r\n                            :min=\"-10\"\r\n                            :max=\"10\"\r\n                            controls-position=\"right\"\r\n                            @change=\"clSt.SetMultiply()\"\r\n                    />\r\n                </div>\r\n            </el-collapse-item>\r\n\r\n        </el-collapse>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    import {clocksettings} from \"./buss/clock\";\r\n    import {ref,onMounted} from 'vue'\r\n    const clSt=clocksettings();\r\n\r\n\tconst activeNames = ref(['1', '2']);\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import script from \"./clock.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./clock.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","/**\r\n * Created by wqy\r\n * Date 2024/1/24 10:11\r\n * Description\r\n */\r\n\r\nimport {GetCamera,GetPickedRayPositionWGS84,GlobalState} from \"./maphandler\";\r\nimport coordinates from '@/common/util/Coordinates'\r\n\r\nfunction rotate2(x,y,anglerad) {\r\n\t// Rotate a point 45 degrees counterclockwise.\r\n\tconst p = new Cesium.Cartesian2(x, y);\r\n\tconst m = Cesium.Matrix2.fromRotation(anglerad);\r\n\tconst rotated = Cesium.Matrix2.multiplyByVector(m, p, new Cesium.Cartesian2());\r\n\treturn rotated;\r\n}\r\n\r\nexport class KeyBoardControl {\r\n\tconstructor() {\r\n\t\tthis.instance = null;\r\n\t\tvar flags = {\r\n\t\t\tmoveForward: false,\r\n\t\t\tmoveBackward: false,\r\n\t\t\tmoveUp: false,\r\n\t\t\tmoveDown: false,\r\n\t\t\tmoveLeft: false,\r\n\t\t\tmoveRight: false,\r\n\t\t\tcenterRotateFor: false,\r\n\t\t\tcenterRotateBak: false,\r\n\t\t\tcenterRotateUp: false,\r\n\t\t\tcenterRotateDown: false,\r\n\t\t\tcenterRotateClock: false,\r\n\t\t\tcenterRotateUnClock: false,\r\n\t\t\tcameraRotateUp: false,\r\n\t\t\tcameraRotateDown: false,\r\n\t\t\tcameraRotateLeft: false,\r\n\t\t\tcameraRotateRight: false,\r\n\t\t};\r\n\t\tthis.pars = {\r\n\t\t\tpanstep: 10,\r\n\t\t\tcenterrotatestep: 1,\r\n\t\t\tcamerarotatestep: 1,\r\n\t\t\tminpitch: -90,\r\n\t\t\tmaxpitch: 90,\r\n\t\t\tminhei: 0,\r\n\t\t}\r\n\r\n\t\tfunction getFlagForKeyCode(keyCode) {\r\n\t\t\tswitch (keyCode) {\r\n\t\t\t\tcase 'Q'.charCodeAt(0):\r\n\t\t\t\t\treturn 'moveUp';\r\n\t\t\t\tcase 'E'.charCodeAt(0):\r\n\t\t\t\t\treturn 'moveDown';\r\n\t\t\t\tcase 'W'.charCodeAt(0):\r\n\t\t\t\t\treturn 'moveForward';\r\n\t\t\t\tcase 'S'.charCodeAt(0):\r\n\t\t\t\t\treturn 'moveBackward';\r\n\t\t\t\tcase 'D'.charCodeAt(0):\r\n\t\t\t\t\treturn 'moveRight';\r\n\t\t\t\tcase 'A'.charCodeAt(0):\r\n\t\t\t\t\treturn 'moveLeft';\r\n\t\t\t\tcase 'I'.charCodeAt(0):\r\n\t\t\t\t\treturn 'centerRotateFor';\r\n\t\t\t\tcase 'K'.charCodeAt(0):\r\n\t\t\t\t\treturn 'centerRotateBak';\r\n\t\t\t\tcase 'U'.charCodeAt(0):\r\n\t\t\t\t\treturn 'centerRotateUp';\r\n\t\t\t\tcase 'O'.charCodeAt(0):\r\n\t\t\t\t\treturn 'centerRotateDown';\r\n\t\t\t\tcase 'J'.charCodeAt(0):\r\n\t\t\t\t\treturn 'centerRotateUnClock';\r\n\t\t\t\tcase 'L'.charCodeAt(0):\r\n\t\t\t\t\treturn 'centerRotateClock';\r\n\t\t\t\tcase 38:\r\n\t\t\t\t\treturn 'cameraRotateUp';\r\n\t\t\t\tcase 40:\r\n\t\t\t\t\treturn 'cameraRotateDown';\r\n\t\t\t\tcase 37:\r\n\t\t\t\t\treturn 'cameraRotateLeft';\r\n\t\t\t\tcase 39:\r\n\t\t\t\t\treturn 'cameraRotateRight';\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.keydown = function (e) {\r\n\t\t\tvar flagName = getFlagForKeyCode(e.keyCode);\r\n\t\t\tif (typeof flagName !== 'undefined') {\r\n\t\t\t\tflags[flagName] = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.keyup = function (e) {\r\n\t\t\tvar flagName = getFlagForKeyCode(e.keyCode);\r\n\t\t\tif (typeof flagName !== 'undefined') {\r\n\t\t\t\tflags[flagName] = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst scope=this;\r\n\t\tfunction rotatecamera(addheading,addpitch) {\r\n\t\t\tconst c=GlobalState.viewer.camera;\r\n\t\t\tGlobalState.viewer.camera.setView({\r\n\t\t\t\tdestination : c.position,\r\n\t\t\t\torientation: {\r\n\t\t\t\t\theading : c.heading+addheading,\r\n\t\t\t\t\tpitch : c.pitch+addpitch,    // default value (looking down)\r\n\t\t\t\t\troll : c.roll                             // default value\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\tfunction rotatecenter( addheading, addpitch) {\r\n\t\t\tconst centerwgs=GetPickedRayPositionWGS84(new Cesium.Cartesian2(\r\n\t\t\t\tGlobalState.viewer.scene.canvas.width/2,\r\n\t\t\t\tGlobalState.viewer.scene.canvas.height/2\r\n\t\t\t));\r\n\t\t\tif(centerwgs==null) return;\r\n\r\n\t\t\tconst c=GlobalState.viewer.camera;\r\n\t\t\tconst target=centerwgs.ToCartesian();\r\n\t\t\tlet lc=coordinates.CoordinateLocal.FromCartesian(c.position,target);\r\n\r\n\t\t\tlet heading=c.heading,pitch=c.pitch,roll=c.roll;\r\n\t\t\tif(addheading!=0){\r\n\t\t\t\tlet xyn=rotate2(lc.x,lc.y,addheading);\r\n\t\t\t\tlc.x=xyn.x;\r\n\t\t\t\tlc.y=xyn.y;\r\n\t\t\t\theading-=addheading;\r\n\t\t\t}\r\n\t\t\telse if(addpitch!=0){\r\n\t\t\t\tlet ty=Math.sqrt(lc.x*lc.x+lc.y*lc.y);\r\n\t\t\t\tlet pzn=rotate2(ty,lc.z,addpitch);\r\n\t\t\t\tlc.x=lc.x*pzn.x/ty;\r\n\t\t\t\tlc.y=lc.y*pzn.x/ty;\r\n\t\t\t\tlc.z=pzn.y;\r\n\t\t\t\tpitch-=addpitch;\r\n\t\t\t\tif(addpitch>0&&pitch<=Cesium.Math.toRadians(scope.pars.minpitch)) return;\r\n\t\t\t\telse if(addpitch<0&&pitch>=Cesium.Math.toRadians(scope.pars.maxpitch)) return;\r\n\t\t\t}\r\n\t\t\tconst position=coordinates.CoordinateLocal.ToCartesian(lc,target);\r\n\r\n\t\t\tGlobalState.viewer.camera.setView({\r\n\t\t\t\tdestination :position,\r\n\t\t\t\torientation: {\r\n\t\t\t\t\theading : heading,\r\n\t\t\t\t\tpitch : pitch,    // default value (looking down)\r\n\t\t\t\t\troll : roll                             // default value\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t}\r\n\r\n\r\n\t\tfunction panonplane(angle) {\r\n\t\t\tconst p=GlobalState.viewer.camera.position;\r\n\t\t\tconst d=GlobalState.viewer.camera.direction;\r\n\t\t\tconst d1=new Cesium.Cartesian3(p.x+d.x,p.y+d.y,p.z+d.z);\r\n\r\n\t\t\tconst l=coordinates.CoordinateLocal.FromCartesian(d1,p);\r\n\t\t\tl.z=0;\r\n\t\t\tconst xy=rotate2(l.x,l.y,angle);\r\n\t\t\tl.x=xy.x;\r\n\t\t\tl.y=xy.y;\r\n\t\t\tconst d2=coordinates.CoordinateLocal.ToCartesian(l,p);\r\n\t\t\td2.x-=p.x;\r\n\t\t\td2.y-=p.y;\r\n\t\t\td2.z-=p.z;\r\n\t\t\tGlobalState.viewer.camera.move(d2,scope.pars.panstep);\r\n\t\t}\r\n\r\n\r\n\t\tthis.ontick = function () {\r\n\r\n\t\t\t// // 根据高度来决定镜头移动的速度\r\n\t\t\t// var cameraHeight = ellipsoid.cartesianToCartographic(camera.position).height;\r\n\t\t\t// var moveRate = cameraHeight / 100.0;\r\n\t\t\tconst curcamera=GetCamera();\r\n\t\t\tif(curcamera.height<scope.pars.minhei) return;\r\n\t\t\tif (flags.moveForward) {\r\n\t\t\t\tpanonplane(0);\r\n\t\t\t}\r\n\t\t\tif(flags.moveBackward){\r\n\t\t\t\tpanonplane(Cesium.Math.PI);\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif(flags.moveUp){\r\n\t\t\t\tconst c=GetCamera();\r\n\t\t\t\tconst wgs=new coordinates.CoordinateWGS84(c.longitude,c.latitude,c.height+scope.pars.panstep);\r\n\t\t\t\tGlobalState.viewer.camera.position=wgs.ToCartesian();\r\n\r\n\t\t\t}\r\n\t\t\tif(flags.moveDown){\r\n\t\t\t\tconst c=GetCamera();\r\n\t\t\t\tconst h=c.height-scope.pars.panstep;\r\n\t\t\t\tif(h<=scope.pars.minhei) return;\r\n\t\t\t\tconst wgs=new coordinates.CoordinateWGS84(c.longitude,c.latitude,h);\r\n\t\t\t\tGlobalState.viewer.camera.position=wgs.ToCartesian();\r\n\t\t\t}\r\n\t\t\tif(flags.moveLeft){\r\n\t\t\t\tpanonplane(Cesium.Math.PI/2);\r\n\t\t\t}\r\n\t\t\tif(flags.moveRight){\r\n\t\t\t\tpanonplane(-Cesium.Math.PI/2);\r\n\t\t\t}\r\n\r\n\t\t\tif(flags.cameraRotateLeft){\r\n\t\t\t\trotatecamera(Cesium.Math.toRadians(scope.pars.camerarotatestep)/10,0);\r\n\t\t\t}\r\n\t\t\tif(flags.cameraRotateRight){\r\n\t\t\t\trotatecamera(Cesium.Math.toRadians(-scope.pars.camerarotatestep)/10,0);\r\n\t\t\t}\r\n\t\t\tif (flags.cameraRotateUp) {\r\n\t\t\t\tif(GlobalState.viewer.camera.pitch>=Cesium.Math.toRadians(scope.pars.maxpitch)) return;\r\n\t\t\t\trotatecamera(0,Cesium.Math.toRadians(scope.pars.camerarotatestep)/10,0);\r\n\t\t\t}\r\n\t\t\tif (flags.cameraRotateDown) {\r\n\t\t\t\tif(GlobalState.viewer.camera.pitch<=Cesium.Math.toRadians(scope.pars.minpitch)) return;\r\n\t\t\t\trotatecamera(0,Cesium.Math.toRadians(-scope.pars.camerarotatestep)/10,0);\r\n\t\t\t}\r\n\t\t\tif (flags.centerRotateFor) {\r\n\t\t\t\tGlobalState.viewer.camera.moveForward(scope.pars.panstep);\r\n\t\t\t}\r\n\t\t\tif(flags.centerRotateBak){\r\n\t\t\t\tGlobalState.viewer.camera.moveBackward(scope.pars.panstep);\r\n\t\t\t}\r\n\t\t\tif(flags.centerRotateClock){\r\n\t\t\t\trotatecenter(-Cesium.Math.toRadians(scope.pars.centerrotatestep)/10,0);\r\n\t\t\t}\r\n\t\t\tif(flags.centerRotateUnClock){\r\n\t\t\t\trotatecenter(Cesium.Math.toRadians(scope.pars.centerrotatestep)/10,0);\r\n\t\t\t}\r\n\t\t\tif(flags.centerRotateUp) {\r\n\r\n\t\t\t\trotatecenter(0, Cesium.Math.toRadians(scope.pars.centerrotatestep) / 10);\r\n\t\t\t}\r\n\t\t\tif(flags.centerRotateDown) {\r\n\r\n\t\t\t\trotatecenter(0, -Cesium.Math.toRadians(scope.pars.centerrotatestep) / 10);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tstatic getInstance() {\r\n\t\tif (!this.instance) {\r\n\t\t\tthis.instance = new KeyBoardControl();\r\n\t\t}\r\n\t\treturn this.instance;\r\n\t}\r\n\r\n\tSetControl(control) {\r\n\t\tdocument.removeEventListener('keydown', this.keydown);\r\n\t\tdocument.removeEventListener('keyup', this.keyup);\r\n\t\tGlobalState.viewer.clock.onTick.removeEventListener(this.ontick);\r\n\t\tif (control === true) {\r\n\t\t\tdocument.addEventListener('keydown', this.keydown, false);\r\n\t\t\tdocument.addEventListener('keyup', this.keyup, false);\r\n\t\t\tGlobalState.viewer.clock.onTick.addEventListener(this.ontick);\r\n\t\t}\r\n\t}\r\n\r\n\tSetParams(options) {\r\n\t\tthis.pars.panstep = options.panstep||this.pars.panstep;\r\n\t\tthis.pars.centerrotatestep = options.centerrotatestep||this.pars.centerrotatestep;\r\n\t\tthis.pars.camerarotatestep = options.camerarotatestep||this.pars.camerarotatestep;\r\n\t\tthis.pars.minpitch = options.minpitch||this.pars.minpitch;\r\n\t\tthis.pars.maxpitch = options.maxpitch||this.pars.maxpitch;\r\n\t\tthis.pars.minhei = options.minhei||this.pars.minhei;\r\n\t}\r\n}\r\n\r\n\r\n\r\n","/**\r\n * Created by wqy\r\n * Date 2024/1/23 11:28\r\n * Description\r\n */\r\nimport {defineStore} from \"pinia\";\r\n\r\nimport {circumsettings} from \"./circum\";\r\nimport {GetCamera,GlobalState} from \"../../../buss/maphandler\";\r\nimport {KeyBoardControl} from \"../../../buss/keyboardcontrol\";\r\n\r\nexport const camerasettings = defineStore('camerasettings', {\r\n\tstate: () => {\r\n\t\treturn {\r\n\t\t\toriginlon: 110.603252444485,\r\n\t\t\toriginlat: 27.941885505227617,\r\n\t\t\toriginhei: 9491663.9170652,\r\n\t\t\toriginheading: 0,\r\n\t\t\toriginpitch: -90,\r\n\t\t\toriginroll: 0,\r\n\r\n\t\t\tzoomF:5,\r\n\t\t\tminizoomdis:1,\r\n\t\t\tmaxizoomdis:9000000,\r\n\t\t\tminicolhei:15000,\r\n\r\n\t\t\tallowrotate:true,\r\n\t\t\tallowtranslate:true,\r\n\t\t\tallowtilt:true,\r\n\t\t\tallowzoom:true,\r\n\t\t\trightrotate:false,\r\n\r\n\t\t\tallowkeyboard:false,\r\n\t\t\tpanstep:10,\r\n\t\t\tcenterrotatestep:1,\r\n\t\t\tcamerarotatestep:1,\r\n\t\t\tminpitch:-90,\r\n\t\t\tmaxpitch:90,\r\n\t\t\tminhei:0,\r\n\r\n\t\t}\r\n\t},\r\n\tactions: {\r\n\t\tSetOriginCamera(zoomto = false) {\r\n\t\t\tconst scope=this;\r\n\t\t\tconst viewer=GlobalState.viewer;\r\n\t\t\tconst f = function () {\r\n\t\t\t\tviewer.camera.flyTo({\r\n\t\t\t\t\tdestination: Cesium.Cartesian3.fromDegrees(scope.originlon, scope.originlat, scope.originhei),\r\n\t\t\t\t\torientation: {\r\n\t\t\t\t\t\theading: Cesium.Math.toRadians(scope.originheading),\r\n\t\t\t\t\t\tpitch:Cesium.Math.toRadians(scope.originpitch),\r\n\t\t\t\t\t\troll: Cesium.Math.toRadians(scope.originroll)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (zoomto === true) {\r\n\t\t\t\tf();\r\n\t\t\t}\r\n\r\n\t\t\tviewer.homeButton.viewModel.command.beforeExecute._listeners=[\r\n\t\t\t\tfunction (e) {\r\n\t\t\t\tif(e){e.cancel = true;}\r\n\t\t\t\tf();\r\n\t\t\t}]\r\n\t\t},\r\n\r\n\t\tLocate(){\r\n\t\t\tGlobalState.viewer.homeButton.viewModel.command.beforeExecute._listeners[0]();\r\n\t\t},\r\n\r\n\t\tSetCurOrigin(){\r\n\t\t\tconst c=GetCamera();\r\n\t\t\tthis.originlon=c.longitude;\r\n\t\t\tthis.originlat=c.latitude;\r\n\t\t\tthis.originhei=c.height;\r\n\t\t\tthis.originheading=c.heading;\r\n\t\t\tthis.originpitch=c.pitch;\r\n\t\t\tthis.originroll=c.roll;\r\n\t\t},\r\n\r\n\t\tSetZoomF(){\r\n\t\t\tGlobalState.viewer.scene.screenSpaceCameraController._zoomFactor=this.zoomF;\r\n\t\t},\r\n\t\tSetMiniZoomDis(){\r\n\t\t\tGlobalState.viewer.scene.screenSpaceCameraController.minimumZoomDistance=this.minizoomdis;\r\n\t\t\tconst scope=this;\r\n\t\t\tGlobalState.viewer.mapcontainerbtns[2][0].onclick=function(){\r\n\t\t\t\tlet Camera = GetCamera();\r\n\r\n\t\t\t\tif(Camera.height<scope.minizoomdis) return;\r\n\t\t\t\t// const m=GlobalState.viewer.camera.getMagnitude();\r\n\t\t\t\t// if(m<scope.minizoomdis) return;\r\n\t\t\t\tGlobalState.viewer.camera.zoomIn(Camera.height/10);\r\n\t\t\t}\r\n\t\t},\r\n\t\tSetMaxiZoomDis(){\r\n\t\t\tGlobalState.viewer.scene.screenSpaceCameraController.maximumZoomDistance =this.maxizoomdis;\r\n\t\t\tconst scope=this;\r\n\t\t\tGlobalState.viewer.mapcontainerbtns[2][1].onclick=function(){\r\n\t\t\t\tlet Camera = GetCamera();\r\n\t\t\t\tif(Camera.height>scope.maxizoomdis) return;\r\n\t\t\t\t// const m=GlobalState.viewer.camera.getMagnitude();\r\n\t\t\t\t// if(m>scope.maxizoomdis) return;\r\n\t\t\t\tGlobalState.viewer.camera.zoomOut(Camera.height/10);\r\n\t\t\t}\r\n\t\t},\r\n\t\tSetMiniColHeight(){\r\n\t\t\tGlobalState.viewer.scene.screenSpaceCameraController.minimumCollisionTerrainHeight=this.minicolhei;\r\n\t\t},\r\n\t\tSetAllowRotate(){\r\n\t\t\tGlobalState.viewer.scene.screenSpaceCameraController.enableRotate=this.allowrotate;\r\n\t\t},\r\n\t\tSetAllowTranslate(){\r\n\t\t\tGlobalState.viewer.scene.screenSpaceCameraController.enableTranslate=this.allowtranslate;\r\n\t\t},\r\n\t\tSetAllowTilt(){\r\n\t\t\tGlobalState.viewer.scene.screenSpaceCameraController.enableTilt=this.allowtilt;\r\n\t\t},\r\n\t\tSetAllowZoom(){\r\n\t\t\tGlobalState.viewer.scene.screenSpaceCameraController.enableZoom=this.allowzoom;\r\n\t\t},\r\n\t\tSetRightRotate(){\r\n\t\t\tGlobalState.viewer.scene.screenSpaceCameraController.rotateEventTypes=\r\n\t\t\t\tthis.rightrotate==true?\r\n\t\t\t\t\t[Cesium.CameraEventType.LEFT_DRAG,Cesium.CameraEventType.RIGHT_DRAG]:\r\n\t\t\t\t\t[Cesium.CameraEventType.LEFT_DRAG];\r\n\t\t\tGlobalState.viewer.scene.screenSpaceCameraController.zoomEventTypes=\r\n\t\t\t\tthis.rightrotate==true?\r\n\t\t\t\t\t[Cesium.CameraEventType.WHEEL, Cesium.CameraEventType.PINCH]:\r\n\t\t\t\t\t[Cesium.CameraEventType.RIGHT_DRAG, Cesium.CameraEventType.WHEEL, Cesium.CameraEventType.PINCH]\r\n\t\t},\r\n\r\n\t\tSetAllowkeyboard(){\r\n\t\t\tif(this.allowkeyboard===true){\r\n\t\t\t\tKeyBoardControl.getInstance().SetParams(this);\r\n\t\t\t}\r\n\t\t\tKeyBoardControl.getInstance().SetControl(this.allowkeyboard);\r\n\t\t},\r\n\r\n\t\tSetPanStep(){\r\n\t\t\tKeyBoardControl.getInstance().SetParams({panstep:this.panstep});\r\n\t\t},\r\n\t\tSetMinHei(){\r\n\t\t\tKeyBoardControl.getInstance().SetParams({minhei:this.minhei});\r\n\t\t},\r\n\t\tSetCenterRotateStep(){\r\n\t\t\tKeyBoardControl.getInstance().SetParams({centerrotatestep:this.centerrotatestep});\r\n\t\t},\r\n\t\tSetCameraRotateStep(){\r\n\t\t\tKeyBoardControl.getInstance().SetParams({camerarotatestep:this.camerarotatestep});\r\n\t\t},\r\n\t\tSetMinPitch(){\r\n\t\t\tKeyBoardControl.getInstance().SetParams({minpitch:this.minpitch});\r\n\t\t},\r\n\t\tSetMaxPitch(){\r\n\t\t\tKeyBoardControl.getInstance().SetParams({maxpitch:this.maxpitch});\r\n\t\t}\r\n\r\n\r\n\r\n\r\n\t}\r\n});\r\n\r\nexport function InitCameraSt(settings) {\r\n\tif (settings) {\r\n\t\tfor (let key in settings) {\r\n\t\t\tcamerasettings()[key] = settings[key];\r\n\t\t}\r\n\t}\r\n\tcamerasettings().SetOriginCamera(true);\r\n\tcamerasettings().SetZoomF();\r\n\tcamerasettings().SetMiniZoomDis();\r\n\tcamerasettings().SetMaxiZoomDis();\r\n\tcamerasettings().SetMiniColHeight();\r\n\tcamerasettings().SetAllowRotate();\r\n\tcamerasettings().SetAllowTranslate();\r\n\tcamerasettings().SetAllowTilt();\r\n\tcamerasettings().SetAllowZoom();\r\n\tcamerasettings().SetRightRotate();\r\n\tcamerasettings().SetAllowkeyboard();\r\n}\r\n\r\nexport function GetCameraSt() {\r\n\tconst result = {};\r\n\tfor (let key in camerasettings().$state) {\r\n\t\tresult[key] = camerasettings()[key];\r\n\t}\r\n\treturn result;\r\n}\r\n","<!--\r\n * Created by wqy\r\n * Date 2024/1/5 16:31\r\n * Description\r\n-->\r\n<template>\r\n    <div id=\"camera\">\r\n        <el-collapse v-model=\"activeNames\">\r\n            <el-collapse-item title=\"默认视角\" name=\"1\">\r\n                <div class=\"swichcontent\">\r\n                    <span>经度值:</span>\r\n                    <el-input-number\r\n                            v-model=\"cmSt.originlon\"\r\n                            :min=\"-180\"\r\n                            :max=\"180\"\r\n                            :step=\"0.01\"\r\n                            controls-position=\"right\"\r\n                            @change=\"cmSt.SetOriginCamera()\"\r\n                    />\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>纬度值:</span>\r\n                    <el-input-number\r\n                            v-model=\"cmSt.originlat\"\r\n                            :min=\"-90\"\r\n                            :max=\"90\"\r\n                            :step=\"0.01\"\r\n                            controls-position=\"right\"\r\n                            @change=\"cmSt.SetOriginCamera()\"\r\n                    />\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>高度值:</span>\r\n                    <el-input-number\r\n                            v-model=\"cmSt.originhei\"\r\n                            :min=\"-100\"\r\n                            :max=\"100000000\"\r\n                            :step=\"1\"\r\n                            controls-position=\"right\"\r\n                            @change=\"cmSt.SetOriginCamera()\"\r\n                    />\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>方向角:</span>\r\n                    <el-slider v-model=\"cmSt.originheading\" :min=\"0\" :max=\"360\" :step=\"0.1\"\r\n                               @change=\"cmSt.SetOriginCamera()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>倾斜角:</span>\r\n                    <el-slider v-model=\"cmSt.originpitch\" :min=\"-90\" :max=\"90\" :step=\"0.1\"\r\n                               @change=\"cmSt.SetOriginCamera()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>翻滚角:</span>\r\n                    <el-slider v-model=\"cmSt.originroll\" :min=\"0\" :max=\"180\" :step=\"0.1\"\r\n                               @change=\"cmSt.SetOriginCamera()\"/>\r\n                </div>\r\n                <div class=\"btncontainer\">\r\n                    <div data-v-93aad95b=\"\" title=\"定位\" class=\"dark-sub-btn\" @click=\"cmSt.Locate()\">\r\n                        <span data-v-4a8d3699=\"\"\r\n                              data-v-93aad95b=\"\"\r\n                              class=\"icon-hover-color\">\r\n                            <svg\r\n                                    width=\"14\" height=\"14\" viewBox=\"0 0 48 48\" fill=\"none\"\r\n                                    xmlns=\"http://www.w3.org/2000/svg\">\r\n                                <path\r\n                                        d=\"M8 6L43 25L24 27L13.9948 44L8 6Z\" fill=\"none\" stroke=\"currentColor\"\r\n                                        stroke-width=\"4\"\r\n                                        stroke-linejoin=\"round\">\r\n                                </path>\r\n                            </svg>\r\n                        </span>\r\n                    </div>\r\n                    <div data-v-93aad95b=\"\" title=\"获取当前视角\" class=\"dark-sub-btn\" @click=\"cmSt.SetCurOrigin()\">\r\n                        <span data-v-4a8d3699=\"\" data-v-93aad95b=\"\" class=\"icon-hover-color\">\r\n                            <svg\r\n                                    width=\"14\" height=\"14\" viewBox=\"0 0 48 48\" fill=\"none\"\r\n                                    xmlns=\"http://www.w3.org/2000/svg\">\r\n                                <path\r\n                                        fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                                        d=\"M24 41C33.9411 41 42 32.678 42 27C42 21.322 33.9411 13 24 13C14.0589 13 6 21.3278 6 27C6 32.6722 14.0589 41 24 41Z\"\r\n                                        fill=\"none\" stroke=\"currentColor\" stroke-width=\"4\"\r\n                                        stroke-linejoin=\"round\"></path><path\r\n                                    d=\"M24 33C27.3137 33 30 30.3137 30 27C30 23.6863 27.3137 21 24 21C20.6863 21 18 23.6863 18 27C18 30.3137 20.6863 33 24 33Z\"\r\n                                    fill=\"none\" stroke=\"currentColor\" stroke-width=\"4\" stroke-linejoin=\"round\"></path><path\r\n                                    d=\"M13.2637 11.2661L15.8582 14.8863\" stroke=\"currentColor\" stroke-width=\"4\"\r\n                                    stroke-linecap=\"round\">\r\n                                </path>\r\n                                <path d=\"M35.625 11.7104L33.0304 15.3307\"\r\n                                      stroke=\"currentColor\" stroke-width=\"4\"\r\n                                      stroke-linecap=\"round\">\r\n                                </path>\r\n                                <path\r\n                                        d=\"M24.0088 7V13\"\r\n                                        stroke=\"currentColor\"\r\n                                        stroke-width=\"4\"\r\n                                        stroke-linecap=\"round\">\r\n                                </path>\r\n                            </svg>\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </el-collapse-item>\r\n            <el-collapse-item title=\"缩放控制\" name=\"2\">\r\n                <div class=\"swichcontent\">\r\n                    <span>滚轮倍数:</span>\r\n                    <el-slider v-model=\"cmSt.zoomF\" :min=\"0\" :max=\"20\" :step=\"0.1\"\r\n                               @change=\"cmSt.SetZoomF()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>相机最近视距:</span>\r\n                    <el-slider v-model=\"cmSt.minizoomdis\" :min=\"0\" :max=\"10000\" :step=\"10\"\r\n                               @change=\"cmSt.SetMiniZoomDis()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>相机最远视距:</span>\r\n                    <el-slider v-model=\"cmSt.maxizoomdis\" :min=\"0\" :max=\"900000000\" :step=\"100\"\r\n                               @change=\"cmSt.SetMaxiZoomDis()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>最小碰撞高度:</span>\r\n                    <el-slider v-model=\"cmSt.minicolhei\" :min=\"0\" :max=\"100000\" :step=\"10\"\r\n                               @change=\"cmSt.SetMiniColHeight()\"/>\r\n                </div>\r\n            </el-collapse-item>\r\n            <el-collapse-item title=\"交互控制\" name=\"3\">\r\n                <div class=\"swichcontent\">\r\n                    <span>允许旋转:</span>\r\n                    <el-switch v-model=\"cmSt.allowrotate\" @change=\"cmSt.SetAllowRotate()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" >\r\n                    <span>允许平移:</span>\r\n                    <el-switch v-model=\"cmSt.allowtranslate\" @change=\"cmSt.SetAllowTranslate()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" >\r\n                    <span>允许倾斜:</span>\r\n                    <el-switch v-model=\"cmSt.allowtilt\" @change=\"cmSt.SetAllowTilt()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" >\r\n                    <span>允许缩放:</span>\r\n                    <el-switch v-model=\"cmSt.allowzoom\" @change=\"cmSt.SetAllowZoom()\"/>\r\n                </div>\r\n                <!--<div class=\"swichcontent\" >-->\r\n                    <!--<span>南北极绕轴心旋转:</span>-->\r\n                    <!--<el-switch v-model=\"cmSt.allowrotate\" />-->\r\n                <!--</div>-->\r\n                <div class=\"swichcontent\" >\r\n                    <span>右键旋转:</span>\r\n                    <el-switch v-model=\"cmSt.rightrotate\" @change=\"cmSt.SetRightRotate()\"/>\r\n                </div>\r\n                <el-divider/>\r\n                <div class=\"swichcontent contentright\">\r\n                    <span>键盘漫游:</span>\r\n                    <div>\r\n                        <el-switch v-model=\"cmSt.allowkeyboard\" @change=\"cmSt.SetAllowkeyboard()\"/>\r\n                        <el-popover\r\n                                placement=\"top\"\r\n                                :width=\"470\"\r\n                                trigger=\"click\">\r\n                            <template #reference>\r\n                                <svg width=\"20px\" height=\"20px\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M24 44C29.5228 44 34.5228 41.7614 38.1421 38.1421C41.7614 34.5228 44 29.5228 44 24C44 18.4772 41.7614 13.4772 38.1421 9.85786C34.5228 6.23858 29.5228 4 24 4C18.4772 4 13.4772 6.23858 9.85786 9.85786C6.23858 13.4772 4 18.4772 4 24C4 29.5228 6.23858 34.5228 9.85786 38.1421C13.4772 41.7614 18.4772 44 24 44Z\" fill=\"none\" stroke=\"#707782\" stroke-width=\"4\" stroke-linejoin=\"round\"></path><path d=\"M24 28.6248V24.6248C27.3137 24.6248 30 21.9385 30 18.6248C30 15.3111 27.3137 12.6248 24 12.6248C20.6863 12.6248 18 15.3111 18 18.6248\" stroke=\"#707782\" stroke-width=\"4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path><path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M24 37.6248C25.3807 37.6248 26.5 36.5055 26.5 35.1248C26.5 33.7441 25.3807 32.6248 24 32.6248C22.6193 32.6248 21.5 33.7441 21.5 35.1248C21.5 36.5055 22.6193 37.6248 24 37.6248Z\" fill=\"#707782\"></path></svg>\r\n                            </template>\r\n                            <img src=\"../../assets/img/keyboard.png\" />\r\n                        </el-popover>\r\n                    </div>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"cmSt.allowkeyboard\">\r\n                    <span>平移步长:</span>\r\n                    <el-input-number\r\n                            v-model=\"cmSt.panstep\"\r\n                            :min=\"0\"\r\n                            :max=\"1000\"\r\n                            :step=\"1\"\r\n                            controls-position=\"right\"\r\n                            @change=\"cmSt.SetPanStep()\"\r\n                    />\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"cmSt.allowkeyboard\">\r\n                    <span>中心旋转步长:</span>\r\n                    <el-input-number\r\n                            v-model=\"cmSt.centerrotatestep\"\r\n                            :min=\"0\"\r\n                            :max=\"360\"\r\n                            :step=\"1\"\r\n                            controls-position=\"right\"\r\n                            @change=\"cmSt.SetCenterRotateStep()\"\r\n                    />\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"cmSt.allowkeyboard\">\r\n                    <span>相机旋转步长:</span>\r\n                    <el-input-number\r\n                            v-model=\"cmSt.camerarotatestep\"\r\n                            :min=\"0\"\r\n                            :max=\"360\"\r\n                            :step=\"1\"\r\n                            controls-position=\"right\"\r\n                            @change=\"cmSt.SetCameraRotateStep()\"\r\n                    />\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"cmSt.allowkeyboard\">\r\n                    <span>最小仰角:</span>\r\n                    <el-slider v-model=\"cmSt.minpitch\" :min=\"-90\" :max=\"cmSt.maxpitch\" :step=\"0.1\" @change=\"cmSt.SetMinPitch()\"\r\n                               />\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"cmSt.allowkeyboard\">\r\n                    <span>最大仰角:</span>\r\n                    <el-slider v-model=\"cmSt.maxpitch\" :min=\"-90\" :max=\"90\" :step=\"0.1\" @change=\"cmSt.SetMaxPitch()\"\r\n                    />\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"cmSt.allowkeyboard\">\r\n                    <span>最低高度:</span>\r\n                    <el-input-number\r\n                            v-model=\"cmSt.minhei\"\r\n                            :min=\"0\"\r\n                            :max=\"1000\"\r\n                            :step=\"1\"\r\n                            controls-position=\"right\"\r\n                            @change=\"cmSt.SetMinHei()\"\r\n                    />\r\n                </div>\r\n                <el-divider/>\r\n            </el-collapse-item>\r\n\r\n        </el-collapse>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n\timport {camerasettings} from \"./buss/camera\";\r\n    import {ref,onMounted} from 'vue'\r\n\tconst cmSt = camerasettings();\r\n\tconst activeNames = ref(['1', '2', '3']);\r\n\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import script from \"./camera.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./camera.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","/**\r\n * Created by wqy\r\n * Date 2024/1/29 11:22\r\n * Description\r\n */\r\nimport {defineStore} from \"pinia\";\r\nimport {GlobalState} from \"../../../buss/maphandler\";\r\n\r\nconst colorramps = [\r\n\t[\"#000000\", \"#2747E0\", \"#D33B7D\", \"#D33038\", \"#FF9742\", \"#ffd700\", \"#ffffff\"],\r\n];\r\n\r\nfunction getElevationContourMaterial() {\r\n\t// Creates a composite material with both elevation shading and contour lines\r\n\treturn new Cesium.Material({\r\n\t\tfabric: {\r\n\t\t\ttype: \"ElevationColorContour\",\r\n\t\t\tmaterials: {\r\n\t\t\t\tcontourMaterial: {\r\n\t\t\t\t\ttype: \"ElevationContour\",\r\n\t\t\t\t},\r\n\t\t\t\televationRampMaterial: {\r\n\t\t\t\t\ttype: \"ElevationRamp\",\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tcomponents: {\r\n\t\t\t\tdiffuse:\r\n\t\t\t\t\t\"contourMaterial.alpha == 0.0 ? elevationRampMaterial.diffuse : contourMaterial.diffuse\",\r\n\t\t\t\talpha:\r\n\t\t\t\t\t\"max(contourMaterial.alpha, elevationRampMaterial.alpha)\",\r\n\t\t\t},\r\n\t\t},\r\n\t\ttranslucent: false,\r\n\t});\r\n}\r\n\r\nfunction getSlopeContourMaterial() {\r\n\t// Creates a composite material with both slope shading and contour lines\r\n\treturn new Cesium.Material({\r\n\t\tfabric: {\r\n\t\t\ttype: \"SlopeColorContour\",\r\n\t\t\tmaterials: {\r\n\t\t\t\tcontourMaterial: {\r\n\t\t\t\t\ttype: \"ElevationContour\",\r\n\t\t\t\t},\r\n\t\t\t\tslopeRampMaterial: {\r\n\t\t\t\t\ttype: \"SlopeRamp\",\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tcomponents: {\r\n\t\t\t\tdiffuse:\r\n\t\t\t\t\t\"contourMaterial.alpha == 0.0 ? slopeRampMaterial.diffuse : contourMaterial.diffuse\",\r\n\t\t\t\talpha: \"max(contourMaterial.alpha, slopeRampMaterial.alpha)\",\r\n\t\t\t},\r\n\t\t},\r\n\t\ttranslucent: false,\r\n\t});\r\n}\r\n\r\nfunction getAspectContourMaterial() {\r\n\t// Creates a composite material with both aspect shading and contour lines\r\n\treturn new Cesium.Material({\r\n\t\tfabric: {\r\n\t\t\ttype: \"AspectColorContour\",\r\n\t\t\tmaterials: {\r\n\t\t\t\tcontourMaterial: {\r\n\t\t\t\t\ttype: \"ElevationContour\",\r\n\t\t\t\t},\r\n\t\t\t\taspectRampMaterial: {\r\n\t\t\t\t\ttype: \"AspectRamp\",\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tcomponents: {\r\n\t\t\t\tdiffuse:\r\n\t\t\t\t\t\"contourMaterial.alpha == 0.0 ? aspectRampMaterial.diffuse : contourMaterial.diffuse\",\r\n\t\t\t\talpha: \"max(contourMaterial.alpha, aspectRampMaterial.alpha)\",\r\n\t\t\t},\r\n\t\t},\r\n\t\ttranslucent: false,\r\n\t});\r\n}\r\n\r\nexport const terrainsettings = defineStore('terrainsettings', {\r\n\tstate: () => {\r\n\t\treturn {\r\n\t\t\tshowterrain: false,\r\n\t\t\tterrainname: '',\r\n\t\t\tshownetwork: false,\r\n\t\t\tterrainexa: 1,\r\n\t\t\tshowcontour: false,\r\n\t\t\tcontourstep: 10,\r\n\t\t\tcontourwidth: 1,\r\n\t\t\tcontourcss: '#ff0000',\r\n\t\t\tgroundrender: false,\r\n\t\t\trendertype: 1,//1:高程 2:坡度 3:坡向\r\n\t\t\timagestripe: 1,\r\n\t\t\tminranphei: 0,\r\n\t\t\tmaxranphei: 10000,\r\n\t\t\tcolorramps: [\r\n\t\t\t\t[\"#000000\", \"#2747E0\", \"#D33B7D\", \"#D33038\", \"#FF9742\", \"#ffd700\", \"#ffffff\"],\r\n\t\t\t\t[\"#0A5E1C\", \"#11711E\", \"#1B8D21\", \"#2AA827\", \"#45C436\", \"#7ADB64\", \"#A1ED86\", \"#C9F9B0\",\"#E7FCD7\"],\r\n\t\t\t\t[\"#09757A\", \"#10938D\", \"#19B79F\", \"#25DBAD\", \"#33FFB8\", \"#66FFBA\", \"#84FFBC\", \"#ADFFCA\",\"#D6FFE0\"],\r\n\t\t\t\t[\"#0E1478\", \"#171F92\", \"#2430B5\", \"#3544D8\", \"#495BFC\", \"#7685FD\", \"#919EFE\", \"#B6BFFE\"],\r\n\t\t\t\t[\"#7A5400\", \"#936900\", \"#B78600\", \"#DBA600\", \"#FFC700\", \"#FFD93F\", \"#FFE466\", \"#FFEF99\", \"#FFF8CC\"],\r\n\t\t\t\t[\"#7A0F0F\", \"#932219\", \"#B73C27\", \"#DB5B39\", \"#FF804F\", \"#FFA87A\", \"#FFC195\", \"#FFDAB8\", \"#FFEFDB\"]\r\n\t\t\t],\r\n\t\t\tenableunder:false,\r\n\t\t\tglobea:false,\r\n\t\t}\r\n\t},\r\n\tactions: {\r\n\t\tSetShowTerrain() {\r\n\t\t\tif (this.showterrain === false) {\r\n\t\t\t\tthis.SetTerrain('无');\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.SetTerrain(this.terrainname);\r\n\t\t\t}\r\n\t\t},\r\n\t\tSetTerrain(terrainname) {\r\n\t\t\tconst find = GlobalState.viewer.baseLayerPicker._viewModel.terrainProviderViewModels.find(item => item.name == terrainname);\r\n\t\t\tif (find == null) return;\r\n\t\t\tGlobalState.viewer.baseLayerPicker._viewModel.selectedTerrain = find;\r\n\t\t\tthis.terrainname = terrainname;\r\n\t\t\tthis.showterrain = (terrainname != '无');\r\n\t\t},\r\n\t\tSetShowNetWork() {\r\n\t\t\tGlobalState.viewer.scene.globe._surface.tileProvider._debug.wireframe = this.shownetwork;\r\n\t\t},\r\n\t\tSetTerrainExa() {\r\n\t\t\tGlobalState.viewer.scene.globe.terrainExaggeration = this.terrainexa;\r\n\t\t},\r\n\t\tgetcolorrampst(item) {\r\n\t\t\tconst duan = item.length - 1;\r\n\t\t\tconst per = 1 / duan;\r\n\t\t\tconst sets = [{color: item[0], per: 0}];\r\n\t\t\tfor (let i = 1; i < item.length - 1; i++) {\r\n\t\t\t\tsets.push({color: item[i], per: per * i})\r\n\t\t\t}\r\n\t\t\tsets.push({color: item[item.length - 1], per: 1});\r\n\t\t\treturn sets;\r\n\t\t},\r\n\t\tgetcolorrampimage(item) {\r\n\t\t\tconst ramp = document.createElement(\"canvas\");\r\n\t\t\tramp.width = 100;\r\n\t\t\tramp.height = 1;\r\n\t\t\tconst ctx = ramp.getContext(\"2d\");\r\n\t\t\tlet colorsts = this.getcolorrampst(item);\r\n\t\t\tconst grd = ctx.createLinearGradient(0, 0, 100, 0);\r\n\t\t\tcolorsts.forEach(colorst => {\r\n\t\t\t\tgrd.addColorStop(colorst.per, colorst.color);\r\n\t\t\t})\r\n\t\t\tctx.fillStyle = grd;\r\n\t\t\tctx.fillRect(0, 0, 100, 1);\r\n\t\t\treturn ramp;\r\n\t\t},\r\n\t\tSetGlobeMaterial() {\r\n\t\t\tlet material = null;\r\n\t\t\tlet contourUniforms = {};\r\n\t\t\tlet shadingUniforms = {};\r\n\t\t\tconst rendertype = (this.groundrender === true ? this.rendertype : 0);\r\n\t\t\tif (this.showcontour === true) {\r\n\t\t\t\tswitch (rendertype) {\r\n\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\tmaterial = Cesium.Material.fromType('ElevationContour');\r\n\t\t\t\t\t\tcontourUniforms = material.uniforms;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tmaterial = getElevationContourMaterial();\r\n\t\t\t\t\t\tmaterial.materials.elevationRampMaterial.uniforms.minimumHeight = this.minranphei;\r\n\t\t\t\t\t\tmaterial.materials.elevationRampMaterial.uniforms.maximumHeight = this.maxranphei;\r\n\t\t\t\t\t\tcontourUniforms = material.materials.contourMaterial.uniforms;\r\n\t\t\t\t\t\tshadingUniforms = material.materials.elevationRampMaterial.uniforms;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\tmaterial = getSlopeContourMaterial();\r\n\t\t\t\t\t\tcontourUniforms = material.materials.contourMaterial.uniforms;\r\n\t\t\t\t\t\tshadingUniforms = material.materials.slopeRampMaterial.uniforms;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\tmaterial = getAspectContourMaterial();\r\n\t\t\t\t\t\tcontourUniforms = material.materials.contourMaterial.uniforms;\r\n\t\t\t\t\t\tshadingUniforms = material.materials.aspectRampMaterial.uniforms;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcontourUniforms.width = this.contourwidth;\r\n\t\t\t\tcontourUniforms.spacing = this.contourstep;\r\n\t\t\t\tcontourUniforms.color = Cesium.Color.fromCssColorString(this.contourcss);\r\n\t\t\t\tGlobalState.viewer.scene.globe.material = material;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tswitch (rendertype) {\r\n\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tmaterial = Cesium.Material.fromType(\"ElevationRamp\");\r\n\t\t\t\t\t\tmaterial.uniforms.minimumHeight = this.minranphei;\r\n\t\t\t\t\t\tmaterial.uniforms.maximumHeight = this.maxranphei;\r\n\t\t\t\t\t\tshadingUniforms = material.uniforms;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\tmaterial = Cesium.Material.fromType(\"SlopeRamp\");\r\n\t\t\t\t\t\tshadingUniforms = material.uniforms;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\tmaterial = Cesium.Material.fromType(\"AspectRamp\");\r\n\t\t\t\t\t\tshadingUniforms = material.uniforms;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.imagestripe != null && this.imagestripe > 0 && this.groundrender === true) {\r\n\t\t\t\tshadingUniforms.image = this.getcolorrampimage(this.colorramps[this.imagestripe - 1]);\r\n\t\t\t}\r\n\t\t\tGlobalState.viewer.scene.globe.material = material;\r\n\t\t},\r\n\t\tSetGroundA(){\r\n\t\t\tGlobalState.viewer.scene.globe.translucency.enabled = this.globea;\r\n\t\t\tGlobalState.viewer.scene.globe.translucency.frontFaceAlpha = this.globea===true?0.2:1;\r\n\t\t},\r\n\t\tSetEnableUnder(){\r\n\t\t\tGlobalState.viewer.scene.screenSpaceCameraController.enableCollisionDetection = this.enableunder;\r\n\t\t}\r\n\t}\r\n});\r\n\r\nexport function InitTerrainSettigns(settings) {\r\n\tif (settings) {\r\n\t\tfor (let key in settings) {\r\n\t\t\tterrainsettings()[key] = settings[key];\r\n\t\t}\r\n\t}\r\n\tterrainsettings().SetShowTerrain();\r\n\tterrainsettings().SetShowNetWork();\r\n\tterrainsettings().SetTerrainExa();\r\n\tterrainsettings().SetGlobeMaterial();\r\n\tterrainsettings().SetGroundA();\r\n\tterrainsettings().SetEnableUnder();\r\n}\r\n\r\nexport function GetTerrainSettings() {\r\n\tconst result = {};\r\n\tfor (let key in terrainsettings().$state) {\r\n\t\tif (key != 'colorramps') {\r\n\t\t\tresult[key] = terrainsettings()[key];\r\n\t\t}\r\n\t}\r\n\treturn result;\r\n}\r\n","<!--\r\n * Created by wqy\r\n * Date 2024/1/5 16:32\r\n * Description\r\n-->\r\n<template>\r\n    <div id=\"terrainmap\">\r\n        <el-collapse v-model=\"activeNames\">\r\n            <el-collapse-item title=\"TerrainSettings\" name=\"1\">\r\n                <div class=\"swichcontent contentright\">\r\n                    <span>TerrainEnable:</span>\r\n                    <el-switch v-model=\"trSt.showterrain\" @change=\"trSt.SetShowTerrain()\"/>\r\n                </div>\r\n                <div class=\"swichcontent contentright\">\r\n                    <span>TerrainSelect:</span>\r\n                    <div>\r\n                        <span>{{trSt.terrainname}}</span>\r\n                        <!--<span>{{curterrainname}}</span>-->\r\n                        <el-button @click=\"opendia\">Select</el-button>\r\n                    </div>\r\n                </div>\r\n            </el-collapse-item>\r\n            <el-collapse-item title=\"RenderEffect\" name=\"2\">\r\n                <div class=\"swichcontent\">\r\n                    <span>Triangle Network:</span>\r\n                    <el-switch v-model=\"trSt.shownetwork\" @change=\"trSt.SetShowNetWork()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>exaggerate:</span>\r\n                    <el-input-number\r\n                            v-model=\"trSt.terrainexa\"\r\n                            @change=\"trSt.SetTerrainExa()\"\r\n                            :min=\"-100\"\r\n                            :max=\"100\"\r\n                            :step=\"0.1\"\r\n                            controls-position=\"right\"\r\n                    />\r\n                </div>\r\n                <el-divider></el-divider>\r\n                <div class=\"swichcontent\">\r\n                    <span>Contour:</span>\r\n                    <el-switch v-model=\"trSt.showcontour\" @change=\"trSt.SetGlobeMaterial()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"trSt.showcontour\">\r\n                    <span>LineWidth:</span>\r\n                    <el-slider v-model=\"trSt.contourwidth\" :min=\"0\" :max=\"15\" :step=\"1\"\r\n                               @change=\"trSt.SetGlobeMaterial()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"trSt.showcontour\">\r\n                    <span>Step(m):</span>\r\n                    <el-slider v-model=\"trSt.contourstep\" :min=\"0\" :max=\"1000\" :step=\"10\"\r\n                               @change=\"trSt.SetGlobeMaterial()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"trSt.showcontour\">\r\n                    <span>Color:</span>\r\n                    <el-color-picker v-model=\"trSt.contourcss\" @change=\"trSt.SetGlobeMaterial()\"/>\r\n                </div>\r\n                <el-divider></el-divider>\r\n                <div class=\"swichcontent\">\r\n                    <span>GroundRender:</span>\r\n                    <el-switch v-model=\"trSt.groundrender\" @change=\"trSt.SetGlobeMaterial()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"trSt.groundrender\">\r\n                    <span>Type:</span>\r\n                    <el-select popper-class=\"popper\" v-model=\"trSt.rendertype\" placeholder=\"请选择\" @change=\"trSt.SetGlobeMaterial()\">\r\n                        <el-option label=\"高程\" :value=\"1\"/>\r\n                        <el-option label=\"坡度\" :value=\"2\"/>\r\n                        <el-option label=\"坡向\" :value=\"3\"/>\r\n                    </el-select>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"trSt.groundrender\">\r\n                    <span>Colors:</span>\r\n                    <el-select popper-class=\"popper colorpopper\" class=\"colorselect\" v-model=\"trSt.imagestripe\"\r\n                               :style=\"getcolorrampstyle(trSt.colorramps[trSt.imagestripe-1],false)\" @change=\"trSt.SetGlobeMaterial()\">\r\n                        <el-option v-for=\"(item,index) in trSt.colorramps\" :value=\"(index+1)\" :label=\"' '\">\r\n                            <span :style=\"getcolorrampstyle(item)\"></span>\r\n                        </el-option>\r\n                    </el-select>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"trSt.groundrender&&trSt.rendertype==1\">\r\n                    <span>MinHeight:</span>\r\n                    <el-slider v-model=\"trSt.minranphei\" :min=\"0\" :max=\"10000\" :step=\"10\"\r\n                               @change=\"trSt.SetGlobeMaterial()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"trSt.groundrender&&trSt.rendertype==1\">\r\n                    <span>MaxHeight:</span>\r\n                    <el-slider v-model=\"trSt.maxranphei\" :min=\"0\" :max=\"10000\" :step=\"10\"\r\n                               @change=\"trSt.SetGlobeMaterial()\"/>\r\n                </div>\r\n            </el-collapse-item>\r\n            <el-collapse-item title=\"UnderGround\" name=\"3\">\r\n                <div class=\"swichcontent\">\r\n                    <span>UnableUnderGround:</span>\r\n                    <el-switch v-model=\"trSt.enableunder\" @change=\"trSt.SetEnableUnder()\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>GlobeTransparent:</span>\r\n                    <el-switch v-model=\"trSt.globea\" @change=\"trSt.SetGroundA()\"/>\r\n                </div>\r\n            </el-collapse-item>\r\n        </el-collapse>\r\n        <div id=\"selectlayerterrain\">\r\n            <el-dialog v-model=\"showselectlayerdialog\" title=\"SelectTerrain\">\r\n                <el-tabs v-model=\"dialogactivename\" class=\"demo-tabs\" @tab-click=\"handleDialogTabClick\">\r\n                    <el-tab-pane label=\"OnlineTerrain\" name=\"onlineterrain\">\r\n                        <div v-for=\"(item,index) in onlineterrains\">\r\n                            <div>\r\n                                <div>\r\n                                    <img :src=\"item.iconUrl\">\r\n                                    <div :class=\"'check-cont'+(item.name===selectedterrainname?' selected':'')\" @click=\"handleselectedclick(item)\"></div>\r\n                                </div>\r\n                                <div>{{item.name}}</div>\r\n                            </div>\r\n                        </div>\r\n                    </el-tab-pane>\r\n                    <el-tab-pane label=\"内置地形\" name=\"interterrain\">内置地形</el-tab-pane>\r\n                </el-tabs>\r\n                <el-footer>\r\n                    <el-button @click=\"showselectlayerdialog.value=false\">取消</el-button>\r\n                    <el-button type=\"primary\" @click=\"onterrainchanged\">确定</el-button>\r\n                </el-footer>\r\n            </el-dialog>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    import {ref,onMounted} from 'vue'\r\n\timport {GlobalState} from \"../../buss/maphandler\";\r\n    import {terrainsettings} from \"./buss/terrainMap\";\r\n\tconst trSt=terrainsettings();\r\n\r\n\tconst activeNames = ref(['1', '2', '3']);\r\n\tconst dialogactivename=ref('onlineterrain');\r\n\r\n    const showselectlayerdialog=ref(false);\r\n\tconst selectedterrainname=ref('onlineterrain');\r\n\r\n\tconst onlineterrains=ref([]);\r\n\tconst colorramps=ref([\r\n\r\n\t\t[ \"#000000\",\"#2747E0\", \"#D33B7D\",\"#D33038\",\"#FF9742\",\"#ffd700\",\"#ffffff\"],\r\n\r\n    ]);\r\n\r\n\tfunction getcolorrampstyle(item,dropdown=true) {\r\n\t\t// const duan=item.length-1;\r\n\t\t// const per=100/duan;\r\n\t\t// const sets=[{color:item[0],per:'0%'}];\r\n\t\t// for(let i=1;i<item.length-1;i++){\r\n\t\t// \tsets.push({color:item[i],per:(per*i).toString()+\"%\"})\r\n        // }\r\n        // sets.push({color:item[item.length-1],per:'100%'});\r\n        const sets=trSt.getcolorrampst(item);\r\n\r\n\t\tconst re= `${dropdown===true?'height:20px;width:100%;':''}display:inline-block;background: linear-gradient(to right,${sets.map(item=>{\r\n\t\t\treturn item.color+\" \"+(item.per*100).toString()+\"%\";\r\n        }).join(',')})`;\r\n\r\n\t\t//return \"background-image: linear-gradient(to right,rgba(0, 0, 255, 0.5), rgba(255, 255, 0, 0.5));width:100%;display:inline-block;\";\r\n\t\treturn re;\r\n\t}\r\n    function opendia() {\r\n\t\tshowselectlayerdialog.value=true;\r\n\t}\r\n\r\n\r\n\tfunction handleDialogTabClick() {\r\n\r\n\t}\r\n\tfunction handleselectedclick(item) {\r\n\t\tif(selectedterrainname.value==item.name){\r\n\t\t\tselectedterrainname.value='';\r\n\t\t}\r\n\t\telse{\r\n\t\t\tselectedterrainname.value=item.name;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onterrainchanged(){\r\n    \ttrSt.SetTerrain(selectedterrainname.value);\r\n\t\tshowselectlayerdialog.value=false;\r\n    }\r\n\r\n\tonMounted(()=>{\r\n\t\tconst len=GlobalState.viewer.baseLayerPicker._viewModel.terrainProviderViewModels.length;\r\n\r\n\t\tfor(let i=0;i<len;i++){\r\n\t\t\tonlineterrains.value.push(GlobalState.viewer.baseLayerPicker._viewModel.terrainProviderViewModels[i]);\r\n\t\t}\r\n\r\n\t\tselectedterrainname.value=trSt.terrainname;\r\n\t})\r\n\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n<style lang=\"less\">\r\n    @import url('../../assets/css/scene.less');\r\n\r\n    #selectlayerterrain{\r\n        .el-dialog{\r\n            --el-dialog-bg-color:transparent;\r\n            border-radius:4px;\r\n            .el-dialog__header{\r\n                background-color: #2d2f38;\r\n                border-radius: 4px 4px 0 0;\r\n                margin-right:0;\r\n\r\n                .el-dialog__title{\r\n                    color:white;\r\n                }\r\n            }\r\n            .el-dialog__body{\r\n                background-color: #232630;\r\n                .el-tabs__item{\r\n                    color:white;\r\n                }\r\n                .el-tabs__content{\r\n                    .el-tab-pane{\r\n                        display:flex;\r\n                        >div{\r\n\r\n                            width:180px;\r\n                            height:200px;\r\n                            /*padding:12px 0px;*/\r\n                            >div{\r\n                                padding:10px;\r\n\r\n                                >div:first-child{\r\n                                    position: relative;\r\n                                    width: 100%;\r\n                                    background: black;\r\n                                    img{\r\n                                        margin:0 auto;\r\n                                        width:100px;height:100px;\r\n                                        display: block;\r\n                                    }\r\n                                    .check-cont{\r\n                                        top:8px;\r\n                                        right:6px;\r\n                                        display:none;\r\n                                    }\r\n                                    .check-cont.selected{\r\n                                        display:block;\r\n                                    }\r\n                                }\r\n                                >div:last-child{\r\n                                    text-align: center;\r\n                                    width:100%;\r\n                                    height:40px;\r\n                                    line-height: 40px;\r\n                                    color:white;\r\n                                    background-color: #2d2f38;\r\n                                }\r\n                            }\r\n                            >div:hover{\r\n                                >div:first-child{\r\n                                    .check-cont{\r\n                                        display:block;\r\n                                    }\r\n                                }\r\n\r\n\r\n                            }\r\n\r\n\r\n                        }\r\n                    }\r\n\r\n                }\r\n                .el-tabs__nav-wrap::after{\r\n                    display: none;}\r\n            }\r\n        }\r\n\r\n    }\r\n</style>\r\n<style lang=\"less\">\r\n    @import url('./css/style.less');\r\n</style>\r\n","import script from \"./terrainmap.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./terrainmap.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./terrainmap.vue?vue&type=style&index=0&id=4e3e751e&lang=less\"\nimport \"./terrainmap.vue?vue&type=style&index=1&id=4e3e751e&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","/**\r\n * Created by wqy\r\n * Date 2024/1/31 14:55\r\n * Description\r\n */\r\nimport {defineStore} from \"pinia\";\r\nimport {GlobalState} from \"../../../buss/maphandler\";\r\nimport {camerasettings} from \"./camera\";\r\n\r\nexport const maptreesettings=defineStore('maptreesettings',{\r\n\tstate:()=>{\r\n\t\treturn {\r\n\t\t\ttreedata:[\r\n\t\t\t\t{\r\n\t\t\t\t\tid:\"1\",\r\n\t\t\t\t\tlabel:\"默认图层\",\r\n\t\t\t\t\tchildren:[]\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\t},\r\n\tactions:{\r\n\t\tInitTreeData(){\r\n\t\t\tif(this.treedata.length==1&&this.treedata[0].label==\"默认图层\"&&this.treedata[0].children.length==0){\r\n\t\t\t\t//加载默认的\r\n\t\t\t\tGlobalState.viewer.baseLayerPicker._viewModel.imageryProviderViewModels.forEach((item,index)=>{\r\n\t\t\t\t\tthis.treedata[0].children.push({\r\n\t\t\t\t\t\tid:\"1\"+index.toString(),\r\n\t\t\t\t\t\tlabel:item.name,\r\n\t\t\t\t\t\t// f:item.creationFunction,\r\n\t\t\t\t\t\ttype:0,//前端内置\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t}\r\n})\r\n\r\n\r\nexport function InitMaptreeSt(settings) {\r\n\tif (settings) {\r\n\t\tfor (let key in settings) {\r\n\t\t\tmaptreesettings()[key] = settings[key];\r\n\t\t}\r\n\t}\r\n\tmaptreesettings().InitTreeData();\r\n}\r\n\r\nexport function GetMaptreeSt() {\r\n\tconst result = {};\r\n\tfor (let key in maptreesettings().$state) {\r\n\t\tresult[key] = maptreesettings()[key];\r\n\t}\r\n\treturn result;\r\n}\r\n\r\n","<!--\r\n * Created by wqy\r\n * Date 2024/1/5 16:32\r\n * Description\r\n-->\r\n<template>\r\n    <div id=\"maptree\">\r\n        <div class=\"scene-tree-header\">\r\n            图层\r\n            <div>\r\n                <div class=\"imgcont\">\r\n                    <button title=\"新建目录\" type=\"button\" @click=\"shf(true)\">\r\n                        <span>\r\n                            <svg\r\n                                    width=\"14\" height=\"14\" viewBox=\"0 0 48 48\" fill=\"none\"\r\n                                    xmlns=\"http://www.w3.org/2000/svg\">\r\n                                <path d=\"M5 8C5 6.89543 5.89543 6 7 6H19L24 12H41C42.1046 12 43 12.8954 43 14V40C43 41.1046 42.1046 42 41 42H7C5.89543 42 5 41.1046 5 40V8Z\"\r\n                                      fill=\"none\" stroke=\"#FFFFFF\" stroke-width=\"4\" stroke-linejoin=\"round\"></path><path\r\n                                    d=\"M43 22H5\" stroke=\"#FFFFFF\" stroke-width=\"4\" stroke-linejoin=\"round\"></path><path\r\n                                    d=\"M5 16V28\" stroke=\"#FFFFFF\" stroke-width=\"4\" stroke-linecap=\"round\"\r\n                                    stroke-linejoin=\"round\"></path><path d=\"M43 16V28\" stroke=\"#FFFFFF\" stroke-width=\"4\"\r\n                                                                         stroke-linecap=\"round\"\r\n                                                                         stroke-linejoin=\"round\"></path>\r\n                            </svg>\r\n                        </span>\r\n                    </button>\r\n                </div>\r\n                <div class=\"imgcont\">\r\n                    <button title=\"批量导入图层\" type=\"button\" @click=\"opendia\"><span>\r\n                        <svg\r\n                                width=\"14\" height=\"14\" viewBox=\"0 0 48 48\" fill=\"none\"\r\n                                xmlns=\"http://www.w3.org/2000/svg\"><rect\r\n                                x=\"6\" y=\"6\" width=\"36\" height=\"36\" rx=\"3\" fill=\"none\" stroke=\"#FFFFFF\" stroke-width=\"4\"\r\n                                stroke-linejoin=\"round\"></rect><path d=\"M24 16V32\" stroke=\"#FFFFFF\" stroke-width=\"4\"\r\n                                                                     stroke-linecap=\"round\"\r\n                                                                     stroke-linejoin=\"round\"></path><path\r\n                                d=\"M16 24L32 24\" stroke=\"#FFFFFF\" stroke-width=\"4\" stroke-linecap=\"round\"\r\n                                stroke-linejoin=\"round\"></path></svg></span></button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"scene-tree-folder\" v-if=\"showfolder\">\r\n            <el-input></el-input>\r\n            <span>\r\n                <svg width=\"14\" height=\"14\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path\r\n                        d=\"M43 11L16.875 37L5 25.1818\" stroke=\"#FFFFFF\" stroke-width=\"4\" stroke-linecap=\"round\"\r\n                        stroke-linejoin=\"round\"></path></svg>\r\n            </span>\r\n            <span @click=\"shf(false)\">\r\n                <svg width=\"14\" height=\"14\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path\r\n                        d=\"M8 8L40 40\" stroke=\"#FFFFFF\" stroke-width=\"4\" stroke-linecap=\"round\"\r\n                        stroke-linejoin=\"round\"></path><path d=\"M8 40L40 8\" stroke=\"#FFFFFF\" stroke-width=\"4\"\r\n                                                             stroke-linecap=\"round\"\r\n                                                             stroke-linejoin=\"round\"></path></svg>\r\n            </span>\r\n        </div>\r\n        <el-tree :data=\"mtSt.treedata\"\r\n                 show-checkbox\r\n                 default-expand-all\r\n                 node-key=\"id\"\r\n                 highlight-current >\r\n        </el-tree>\r\n        <div id=\"selectlayer\">\r\n            <el-dialog v-model=\"showselectlayerdialog\" title=\"选择图层\">\r\n                <div>\r\n                    <div v-for=\"(item,index) in onlineterrains\">\r\n                        <div>\r\n                            <div>\r\n                                <img :src=\"item.iconUrl\">\r\n                                <div :class=\"'check-cont'+(item.name===selectedterrainname?' selected':'')\" @click=\"handleselectedclick(item)\"></div>\r\n                            </div>\r\n                            <div>{{item.name}}</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <!-- 分页 -->\r\n                <div class=\"pageChange\" v-if=\"layernum>0\">\r\n                    <div class=\"prevButton\" @click=\"prevClick\" v-show=\"pageno > 1\">上一页</div>\r\n                    <el-pagination\r\n                            :page-size=\"pagesize\"\r\n                            :pager-count=\"5\"\r\n                            :current-page=\"pageno\"\r\n                            layout=\"pager\"\r\n                            :total=\"layernum\"\r\n                            @current-change=\"querylayers\"\r\n                            :small=\"true\"\r\n                    />\r\n                    <!-- <div class=\"extra\" v-show=\"searchParams.total < searchParams.realTotal\">...</div> -->\r\n                    <div class=\"nextButton\" @click=\"nextClick\" v-show=\"Math.ceil(scenenum/pagesize)>pageno\">下一页</div>\r\n                </div>\r\n\r\n                <el-footer>\r\n                    <el-button @click=\"showselectlayerdialog.value=false\">取消</el-button>\r\n                    <el-button type=\"primary\" @click=\"onterrainchanged\">确定</el-button>\r\n                </el-footer>\r\n            </el-dialog>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n\r\n\timport {maptreesettings } from \"./buss/maptree\";\r\n\r\n    import {ref,onMounted} from 'vue'\r\n\tconst mtSt=maptreesettings();\r\n\r\n\tconst showfolder=ref(false);\r\n\tconst showselectlayerdialog=ref(false);\r\n\tconst layers=ref([]);\r\n\t// const {proxy} = getCurrentInstance();\r\n\tconst pagesize = ref(12);\r\n\tconst pageno = ref(1);\r\n\tconst layernum = ref(0);\r\n\r\n    function shf(show) {\r\n        showfolder.value=show;\r\n\t}\r\n\tfunction opendia() {\r\n\t\tshowselectlayerdialog.value=true;\r\n\t}\r\n\r\n\tfunction resetlistchecked() {\r\n\t\tlayers.value.forEach(item => {\r\n\t\t\titem.checked = false;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction querylayers(){\r\n\t\t// proxy\r\n\t\t// \t.$post(FyConfig.IP+\"/resource/layerAccess/queryUserPage\", {\r\n\t\t// \t\tpageSize: pagesize.value,\r\n\t\t// \t\tpageNo: pageno.value,\r\n\t\t// \t\tuserId: getSession('UserID', true)\r\n\t\t// \t})\r\n\t\t// \t.then((res) => {\r\n\t\t// \t\tdebugger\r\n\t\t// \t\tlayernum.value = Number(res.data.total);\r\n\t\t// \t\tlayers.value = res.data.records;\r\n\t\t// \t\tresetlistchecked();\r\n        //\r\n\t\t// \t});\r\n    }\r\n\r\n\tonMounted(()=>{\r\n\r\n    })\r\n\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n    #maptree {\r\n        color: white;\r\n        .scene-tree-header {\r\n            height: 44px;\r\n            line-height: 44px;\r\n            padding: 0 13px;\r\n            margin-bottom: 12px;\r\n            border-top: 1px solid #42444c;\r\n            border-bottom: 1px solid #42444c;\r\n            font-size: 14px;\r\n            display: flex;\r\n            justify-content: space-between;\r\n            > div {\r\n                display: inline-flex;\r\n                .imgcont {\r\n                    > img {\r\n                        width: 123px;\r\n                        height: 123px;\r\n                        border-radius: 4px;\r\n                        object-fit: contain;\r\n                        display: block;\r\n\r\n                    }\r\n                    > button {\r\n                        display: inline-block;\r\n                        height: 30px;\r\n                        line-height: 30px;\r\n                        background: #181b24;\r\n                        border: 1px solid #2d2f37;\r\n                        border-radius: 4px;\r\n                        font-size: 12px;\r\n\r\n                        font-weight: 500;\r\n                        color: #fff;\r\n                        padding: 0 5px;\r\n                        cursor: pointer;\r\n                        min-width: 30px;\r\n                        text-align: center;\r\n                        vertical-align: middle;\r\n\r\n                        > span {\r\n                            font-size: 18px !important;\r\n                            line-height: 18px;\r\n                            vertical-align: middle !important;\r\n                            padding-left: 2px;\r\n                            padding-right: 2px;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n        }\r\n        .scene-tree-folder{\r\n            padding-left: 13px;\r\n            padding-right: 13px;\r\n            margin-bottom: 12px;\r\n            display: flex;\r\n            align-items: center;\r\n            box-sizing: border-box;\r\n            .el-input{\r\n                width: 100%;\r\n                height: 32px;\r\n                font-size: 12px;\r\n                color: #fff;\r\n                line-height: 32px;\r\n                text-align: left;\r\n                background: #181b24;\r\n                border: 1px solid #2d2f37;\r\n                border-radius: 4px;\r\n            }\r\n            >span{\r\n                display: inline-block;\r\n                margin-left: 8px;\r\n            }\r\n        }\r\n        .pageChange {\r\n            position: sticky;\r\n            background: transparent;\r\n\r\n            margin: auto;\r\n            width: 240px;\r\n            height: 50px;\r\n            display: flex;\r\n            justify-content: space-around;\r\n            flex-direction: row;\r\n            font-size: 20px;\r\n            .prevButton, .nextButton {\r\n                line-height: 50px;\r\n            }\r\n        }\r\n    }\r\n</style>\r\n<style lang=\"less\">\r\n    @import url('../../assets/css/scene.less');\r\n\r\n    #selectlayer{\r\n        .el-dialog{\r\n            --el-dialog-bg-color:transparent;\r\n            border-radius:4px;\r\n            .el-dialog__header{\r\n                background-color: #2d2f38;\r\n                border-radius: 4px 4px 0 0;\r\n                margin-right:0;\r\n\r\n                .el-dialog__title{\r\n                    color:white;\r\n                }\r\n            }\r\n            .el-dialog__body{\r\n                background-color: #232630;\r\n                min-height:400px;\r\n                .el-tabs__item{\r\n                    color:white;\r\n                }\r\n                .el-tabs__content{\r\n                    .el-tab-pane{\r\n                        display:flex;\r\n                        >div{\r\n                            width:180px;\r\n                            height:200px;\r\n                            /*padding:12px 0px;*/\r\n                            >div{\r\n                                padding:10px;\r\n                                >div:first-child{\r\n                                    position: relative;\r\n                                    width: 100%;\r\n                                    background: black;\r\n                                    img{\r\n                                        margin:0 auto;\r\n                                        width:100px;height:100px;\r\n                                        display: block;\r\n                                    }\r\n                                    .check-cont{\r\n                                        top:8px;\r\n                                        right:6px;\r\n                                        display:none;\r\n                                    }\r\n                                    .check-cont.selected{\r\n                                        display:block;\r\n                                    }\r\n                                }\r\n                                >div:last-child{\r\n                                    text-align: center;\r\n                                    width:100%;\r\n                                    height:40px;\r\n                                    line-height: 40px;\r\n                                    color:white;\r\n                                    background-color: #2d2f38;\r\n                                }\r\n                            }\r\n                            >div:hover{\r\n                                >div:first-child{\r\n                                    .check-cont{\r\n                                        display:block;\r\n                                    }\r\n                                }\r\n\r\n\r\n                            }\r\n\r\n\r\n                        }\r\n                    }\r\n\r\n                }\r\n                .el-tabs__nav-wrap::after{\r\n                    display: none;}\r\n            }\r\n        }\r\n\r\n    }\r\n</style>\r\n","import script from \"./maptree.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./maptree.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./maptree.vue?vue&type=style&index=0&id=19ef4bc7&lang=less&scoped=true\"\nimport \"./maptree.vue?vue&type=style&index=1&id=19ef4bc7&lang=less\"\n\nimport exportComponent from \"C:\\\\work\\\\study\\\\demos\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-19ef4bc7\"]])\n\nexport default __exports__","<!--\r\n * Created by wqy\r\n * Date 2024/1/5 16:40\r\n * Description\r\n-->\r\n<template>\r\n    <div id=\"widgets\">\r\n        <el-collapse v-model=\"activeNames\">\r\n            <el-collapse-item title=\"Widgets Tools\" name=\"1\">\r\n                <div>\r\n                    Consistent with real life: in line with the process and logic of real\r\n                    life, and comply with languages and habits that the users are used to;\r\n                </div>\r\n                <div>\r\n                    Consistent within interface: all elements should be consistent, such\r\n                    as: design style, icons and texts, position of elements, etc.\r\n                </div>\r\n            </el-collapse-item>\r\n            <el-collapse-item title=\"Toolbar\" name=\"2\">\r\n                <div class=\"swichcontent\">\r\n                    <span>Home:</span>\r\n                    <el-switch v-model=\"settings.home\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>Compass:</span>\r\n                    <el-switch v-model=\"settings.compass\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>Zoom:</span>\r\n                    <el-switch v-model=\"settings.zoominout\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>2D/3D:</span>\r\n                    <el-switch v-model=\"settings.scenemode\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>ImagePicker:</span>\r\n                    <el-switch v-model=\"settings.imapk\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>FullScreen:</span>\r\n                    <el-switch v-model=\"settings.fullsize\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>Navigation:</span>\r\n                    <el-switch v-model=\"settings.navi\"/>\r\n                </div>\r\n            </el-collapse-item>\r\n            <el-collapse-item title=\"Statusbar\" name=\"3\">\r\n                <div class=\"swichcontent\">\r\n                    <span>Enable:</span>\r\n                    <el-switch v-model=\"settings.statusbar\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.statusbar\">\r\n                    <span>Longitude/Latitude:</span>\r\n                    <el-switch v-model=\"settings.lonlat\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.statusbar\">\r\n                    <span>Height:</span>\r\n                    <el-switch v-model=\"settings.height\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.statusbar\">\r\n                    <span>Level:</span>\r\n                    <el-switch v-model=\"settings.lod\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.statusbar\">\r\n                    <span>Heading:</span>\r\n                    <el-switch v-model=\"settings.heading\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.statusbar\">\r\n                    <span>Pitch:</span>\r\n                    <el-switch v-model=\"settings.pitch\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.statusbar\">\r\n                    <span>Roll:</span>\r\n                    <el-switch v-model=\"settings.roll\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.statusbar\">\r\n                    <span>CameraHeight:</span>\r\n                    <el-switch v-model=\"settings.cameraheight\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.statusbar\">\r\n                    <span>FPS:</span>\r\n                    <el-switch v-model=\"settings.fps\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.statusbar\">\r\n                    <span>Precision Lon/Lat:</span>\r\n                    <el-input v-model=\"settings.lonlatpre\"></el-input>\r\n                </div>\r\n            </el-collapse-item>\r\n            <el-collapse-item title=\"Scalebar\" name=\"4\">\r\n                <div class=\"swichcontent\">\r\n                    <span>Enable:</span>\r\n                    <el-switch v-model=\"settings.scale\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.scale\">\r\n                    <span>Top:</span>\r\n                    <el-input v-model=\"settings.scaletop\"></el-input>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.scale\">\r\n                    <span>Bottom:</span>\r\n                    <el-input v-model=\"settings.scalebottom\"></el-input>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.scale\">\r\n                    <span>Left:</span>\r\n                    <el-input v-model=\"settings.scaleleft\"></el-input>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.scale\">\r\n                    <span>Right:</span>\r\n                    <el-input v-model=\"settings.scaleright\"></el-input>\r\n                </div>\r\n            </el-collapse-item>\r\n            <el-collapse-item title=\"TimeControl\" name=\"4\">\r\n                <div class=\"swichcontent\">\r\n                    <span>TimeScale:</span>\r\n                    <el-switch v-model=\"settings.timeline\"/>\r\n                </div>\r\n                <div class=\"swichcontent\">\r\n                    <span>Animation:</span>\r\n                    <el-switch v-model=\"settings.animation\"/>\r\n                </div>\r\n                <div class=\"swichcontent\" v-if=\"settings.animation\">\r\n                    <span>Format:</span>\r\n                    <el-input v-model=\"otS.timecontrolstrs.timeformat\"></el-input>\r\n                </div>\r\n            </el-collapse-item>\r\n        </el-collapse>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tothersettings,\r\n\t\tSetToolbarBtnShow,\r\n\t\tGetSettings,\r\n\t\tSetScaleBarShow,\r\n\t} from \"./buss/widgets\";\r\n    import {ref,onMounted,watch} from 'vue'\r\n\r\n\tconst otS = othersettings();\r\n\r\n\r\n\tconst activeNames = ref(['1', '2', '3', '4']);\r\n\tconst settings = ref({\r\n\t\t// home: true,\r\n\t\t// compass: true,\r\n\t\t// zoominout: true,\r\n\t\t// scenemode: true,\r\n\t\t// imapk: true,\r\n\t\t// fullsize: true,\r\n\t\t// navi: true,\r\n\t\t//\r\n\t\t//\r\n\t\t//\r\n\t\t//\r\n\t\t// statusbar: true,\r\n\t\t// lonlat: true,\r\n\t\t// lonlatpre: 6,\r\n\t\t//\r\n\t\t// timeline:true,\r\n\t})\r\n\r\n\r\n\r\n\tonMounted(() => {\r\n\t\t//如果这个组件是默认加载就需要放到Bus.VM.$on里面\r\n\t\t//Bus.VM.$on(Bus.SignalType.SCENEBUILDINIT, function () {\r\n\t\t\tsettings.value = GetSettings();\r\n\t\t//});\r\n\t});\r\n\twatch(() => settings.value.home, (newval, oldval) => {\r\n\t\tSetToolbarBtnShow('home', newval);\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.compass, (newval, oldval) => {\r\n\t\tSetToolbarBtnShow('compass', newval);\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.zoominout, (newval, oldval) => {\r\n\t\tSetToolbarBtnShow('zoominout', newval);\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.scenemode, (newval, oldval) => {\r\n\t\tSetToolbarBtnShow('scenemode', newval);\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.imapk, (newval, oldval) => {\r\n\t\tSetToolbarBtnShow('imapk', newval);\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.fullsize, (newval, oldval) => {\r\n\t\tSetToolbarBtnShow('fullsize', newval);\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.navi, (newval, oldval) => {\r\n\t\tSetToolbarBtnShow('navi', newval);\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.timeline, (newval, oldval) => {\r\n\t\totS.SetTimelineShow(newval);\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.statusbar, (newval, oldval) => {\r\n\t\totS.SetStatusBarShow(newval)\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.lonlat, (newval, oldval) => {\r\n\t\totS.lonlat = newval;\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.height, (newval, oldval) => {\r\n\t\totS.height = newval;\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.lod, (newval, oldval) => {\r\n\t\totS.lod = newval;\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.heading, (newval, oldval) => {\r\n\t\totS.heading = newval;\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.pitch, (newval, oldval) => {\r\n\t\totS.pitch = newval;\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.roll, (newval, oldval) => {\r\n\t\totS.roll = newval;\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.cameraheight, (newval, oldval) => {\r\n\t\totS.cameraheight = newval;\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.fps, (newval, oldval) => {\r\n\t\totS.fps = newval;\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.lonlatpre, (newval, oldval) => {\r\n\t\totS.lonlatpre = newval;\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.scale, (newval, oldval) => {\r\n\t\tSetScaleBarShow(newval);\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.scaleleft, (newval, oldval) => {\r\n\t\totS.scaleleft = newval;\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.scaleright, (newval, oldval) => {\r\n\t\totS.scaleright = newval;\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.scaletop, (newval, oldval) => {\r\n\t\totS.scaletop = newval;\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.scalebottom, (newval, oldval) => {\r\n\t\totS.scalebottom = newval;\r\n\t}, {deep: true});\r\n\twatch(() => settings.value.animation, (newval, oldval) => {\r\n\t\totS.SetAnimationBarShow(newval);\r\n\t}, {deep: true});\r\n\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n<style lang=\"less\">\r\n    @import url('./css/style.less');\r\n</style>\r\n","import script from \"./widgets.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./widgets.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./widgets.vue?vue&type=style&index=0&id=4049545a&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","<!--\r\n * Created by wqy\r\n * Date 2024/1/5 16:40\r\n * Description\r\n-->\r\n<template>\r\n    <div id=\"effects\">\r\n        特效\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import { render } from \"./effects.vue?vue&type=template&id=5480a8d6\"\nconst script = {}\n\nimport exportComponent from \"C:\\\\work\\\\study\\\\demos\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","/**\r\n * Created by wqy\r\n * Date 2024/1/10 14:55\r\n * Description\r\n */\r\nimport {InitBtns as WidgetInit,GetSettings as WidgetGetSettings, othersettings} from \"../components/Widgets/buss/widgets\";\r\nimport {InitSouceSt as SouceInit} from \"../components/Widgets/buss/Source\";\r\nimport {InitCircumSt as CircumInit, GetCircumSt as CircumGetSettings} from \"../components/Widgets/buss/circum\";\r\nimport {InitClockSt as ClockInit, GetClockSt as ClockGetSettings,clocksettings } from \"../components/Widgets/buss/clock\";\r\nimport {InitCameraSt as CameraInit, GetCameraSt as CameraGetSettings} from \"../components/Widgets/buss/camera\";\r\nimport {InitTerrainSettigns as TerrainInit,GetTerrainSettings as TerrainGetSettings} from \"../components/Widgets/buss/terrainMap\";\r\nimport {InitMaptreeSt as MaptreeInit, GetMaptreeSt as MaptreeGetSettings} from \"../components/Widgets/buss/maptree\";\r\n\r\nimport Bus from '@/common/buss/Bus'\r\nexport function Init(settings) {\r\n\t// if(settings)\r\n\t{\r\n\t\tWidgetInit(settings?settings.widgetst:null);\r\n\t\tSouceInit(settings);\r\n\t\tCircumInit(settings?settings.circumst:null);\r\n\t\tClockInit(settings?settings.clockst:null);\r\n\t\tCameraInit(settings?settings.camerast:null);\r\n\t\tTerrainInit(settings?settings.terrainst:null);\r\n\t\tMaptreeInit(settings?settings.maptreest:null)\r\n\t}\r\n\r\n\tothersettings().timecontrolstrs.currenttime=clocksettings().curtime;\r\n\tothersettings().timecontrolstrs.step=clocksettings().multiply;\r\n\r\n\tBus.VM.$emit(Bus.SignalType.SCENEBUILDINIT);\r\n}\r\n\r\nexport function GetTotalSettings() {\r\n\treturn {\r\n\t\twidgetst:WidgetGetSettings(),\r\n\t\tcircumst:CircumGetSettings(),\r\n\t\tclockst:ClockGetSettings(),\r\n\t\tcamerast:CameraGetSettings(),\r\n\t\tterrainst:TerrainGetSettings(),\r\n\t\tmaptreest:MaptreeGetSettings(),\r\n\t}\r\n}\r\n\r\n\r\n\r\n","<!--\r\n * Created by wqy\r\n * Date 2024/1/3 9:57\r\n * Description\r\n-->\r\n<template>\r\n    <div id=\"sceneedit\">\r\n        <menus :settingdt=\"menuprop\" :curmenu=\"curmenu\"\r\n               @menuchange=\"handlemenuchange\"\r\n               @save=\"save()\"\r\n               @preview=\"preview\"\r\n        ></menus>\r\n        <div id=\"editmain\">\r\n            <div id=\"studiocontainer\">\r\n                <studio></studio>\r\n\r\n            </div>\r\n            <div id=\"studioLeftCon\" class=\"invisible_scrollheight\">\r\n                <div class=\"invisible_scrollheight\">\r\n                    <souce v-if=\"curmenu=='1-1'\"></souce>\r\n                    <circum v-if=\"curmenu=='1-2'\"></circum>\r\n                    <clock v-if=\"curmenu=='1-3'\"></clock>\r\n                    <camera v-if=\"curmenu=='1-4'\"></camera>\r\n                    <!--<basemap v-if=\"curmenu=='2-1'\"></basemap>-->\r\n                    <terrainmap v-if=\"curmenu=='2-2'\"></terrainmap>\r\n                    <maptree v-if=\"curmenu=='2-3'\"></maptree>\r\n                    <widgets v-if=\"curmenu=='3'\" ></widgets>\r\n                    <effects v-if=\"curmenu=='4'\"></effects>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n\timport menus from './menu.vue'\r\n\timport studio from './studio.vue'\r\n\r\n    import souce from './Widgets/Souce.vue'\r\n    import circum from './Widgets/Circum.vue'\r\n    import clock from './Widgets/clock.vue'\r\n    import camera from './Widgets/camera.vue'\r\n\t// import basemap from './Widgets/basemap.vue'\r\n\timport terrainmap from './Widgets/terrainmap.vue'\r\n    import maptree from './Widgets/maptree.vue'\r\n    import widgets from './Widgets/widgets.vue'\r\n    import effects from './Widgets/effects.vue'\r\n\r\n    import {Init,GetTotalSettings} from \"../buss/studio\";\r\n\timport {soucesettings,GetThumbnailImgUrl,CaptureUploadImg} from \"./Widgets/buss/Source\";\r\n    import msgUtil from '@/common/util/MessageUtil'\r\n    import {ref,onMounted} from 'vue'\r\n\r\n\t// const souSt=soucesettings();\r\n    //\r\n\t// const { proxy } = getCurrentInstance();\r\n\t// const router = useRouter();\r\n\r\n    const menuprop=ref({\r\n\t\ttype: 'edit',\r\n\t\tlogourl: './images/logl.png',\r\n\t\ttitle: \"\",\r\n\t\t// widgetst:{\r\n\t\t// \t//tooltip:\r\n\t\t// \thome: true,\r\n\t\t// \tcompass: true,\r\n\t\t// \tzoominout: true,\r\n\t\t// \tscenemode: true,\r\n\t\t// \timapk: true,\r\n\t\t// \tfullsize: true,\r\n\t\t// \tnavi: true,\r\n        //\r\n\t\t// \t//statusbar\r\n        //     statusbar:true,\r\n        //     lonlat:true,\r\n        //     height:true,\r\n        //     lod:true,\r\n        //     heading:true,\r\n        //     pitch:true,\r\n        //     roll:true,\r\n        //     cameraheight:true,\r\n        //     fps:true,\r\n        //     lonlatpre:6,\r\n\t\t// \t//timecontrol\r\n\t\t// \ttimeline:true,\r\n\t\t// }\r\n\r\n\r\n\r\n    });\r\n\tconst curmenu=ref('1-1');\r\n\r\n\tonMounted(()=>{\r\n\t    // debugger\r\n        document.title='时空大数据平台-新增场景';\r\n        menuprop.value.id=null;\r\n        Init();\r\n\t\t// document.title='时空大数据平台-编辑场景';\r\n\t\t// if(router.currentRoute.value.query.id==null){\r\n\t\t// \tdocument.title='时空大数据平台-新增场景';\r\n\t\t// \tmenuprop.value.id=null;\r\n\t\t// \tInit();\r\n        // }\r\n        // else{\r\n\t\t// \tproxy\r\n\t\t// \t\t.$get(FyConfig.IP+\"/resource/scence/queryById?id=\"+router.currentRoute.value.query.id)\r\n\t\t// \t\t.then((res) => {\r\n\t\t// \t\t\tmenuprop.value=JSON.parse(res.data.config);\r\n\t\t// \t\t\tfor(let key in res.data){\r\n\t\t// \t\t\t\tif(key!='config'){\r\n\t\t// \t\t\t\t\tmenuprop.value[key]=res.data[key];\r\n        //                 }\r\n        //             }\r\n\t\t// \t\t\tmenuprop.value.type='edit';\r\n\t\t// \t\t\tmenuprop.value.logourl='/img/logo.svg'\r\n        //\r\n\t\t// \t\t\tInit(menuprop.value);\r\n\t\t// \t\t});\r\n        // }\r\n\r\n    })\r\n\r\n    function handlemenuchange(val) {\r\n\t\tcurmenu.value=val;\r\n\r\n\t}\r\n\r\n\tfunction save() {\r\n\t\t// if(souSt.title==null||souSt.title==''){\r\n\t\t// \tmsgUtil.messagePrompt('warning','请输入标题');\r\n\t\t// \treturn;\r\n        // }\r\n        // const requestfn=function () {\r\n\t\t// \tconst userID = getSession('UserID', true);\r\n\t\t// \tproxy.$post(FyConfig.IP+'/resource/scence/saveOrUpdate',{\r\n\t\t// \t\tid:menuprop.value.id,\r\n\t\t// \t\ttitle:souSt.title,\r\n\t\t// \t\tremark:souSt.remark,\r\n\t\t// \t\tdataTag:souSt.dataTag,\r\n\t\t// \t\tthumbnailUrl:souSt.thumbnailUrl,\r\n\t\t// \t\tuserId:userID,\r\n\t\t// \t\tconfig:JSON.stringify(GetTotalSettings())\r\n\t\t// \t}).then((res)=>{\r\n\t\t// \t\tmenuprop.value.id=res.data.id;\r\n\t\t// \t\tmsgUtil.messagePrompt('success','保存成功');\r\n\t\t// \t})\r\n\t\t// }\r\n        //\r\n\t\t// if(souSt.thumbnailUrl==null||souSt.thumbnailUrl==''){\r\n\t\t// \tCaptureUploadImg(function (filePath) {\r\n\t\t// \t\tsouSt.setThumbnailUrl(filePath);\r\n\t\t// \t\trequestfn();\r\n\t\t// \t})\r\n        // }\r\n        // else{\r\n        // \trequestfn();\r\n        // }\r\n\t}\r\n\r\n\tfunction preview() {\r\n\t\t// if(menuprop.value.id==null) {\r\n\t\t// \tmsgUtil.messagePrompt('warning','请先保存');\r\n\t\t// \treturn;\r\n        // }\r\n\t\t// const { href } = router.resolve({\r\n\t\t// \tpath: '/Service/scene-preview',\r\n\t\t// \tquery:{\r\n\t\t// \t\tid:menuprop.value.id,\r\n\t\t// \t},\r\n\t\t// });\r\n\t\t// window.open(href, \"_blank\");\r\n\t}\r\n\r\n\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n    #sceneedit{\r\n        width:100%;height:100%;\r\n        #editmain{\r\n            padding-left:305px;\r\n            width:100%;\r\n            height:calc(100% - 60px);\r\n            position:relative;\r\n            #studioLeftCon{\r\n                padding-bottom:18px;\r\n                overflow: hidden;\r\n                width:305px;\r\n                height:100%;\r\n                position:absolute;\r\n                left:0;\r\n                top:0;\r\n                background: #232630;\r\n                color:white;\r\n                overflow-x:hidden;\r\n                overflow-y:scroll;\r\n                >div{\r\n                    width:100%;\r\n                    height:100%;\r\n                    --el-fill-color-blank:transparent;\r\n                    --el-border-color-lighter:transparent;\r\n                }\r\n            }\r\n            #studiocontainer{\r\n                width:100%;\r\n                height:100%;\r\n            }\r\n        }\r\n\r\n    }\r\n</style>\r\n<style lang=\"less\">\r\n    @import url('../assets/css/scene.less');\r\n</style>\r\n","import script from \"./sceneedit.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./sceneedit.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./sceneedit.vue?vue&type=style&index=0&id=62e018df&lang=less&scoped=true\"\nimport \"./sceneedit.vue?vue&type=style&index=1&id=62e018df&lang=less\"\n\nimport exportComponent from \"C:\\\\work\\\\study\\\\demos\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-62e018df\"]])\n\nexport default __exports__","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./sceneedit.vue?vue&type=style&index=1&id=62e018df&lang=less\"","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./terrainmap.vue?vue&type=style&index=1&id=4e3e751e&lang=less\"","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./maptree.vue?vue&type=style&index=1&id=19ef4bc7&lang=less\"","module.exports = __webpack_public_path__ + \"img/keyboard.5697696b.png\";","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./maptree.vue?vue&type=style&index=0&id=19ef4bc7&lang=less&scoped=true\"","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Souce.vue?vue&type=style&index=1&id=3be3cfeb&lang=less\"","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./sceneedit.vue?vue&type=style&index=0&id=62e018df&lang=less&scoped=true\"","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./terrainmap.vue?vue&type=style&index=0&id=4e3e751e&lang=less\"","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Souce.vue?vue&type=style&index=0&id=3be3cfeb&lang=less&scoped=true\"","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./studio.vue?vue&type=style&index=0&id=3347f1bc&lang=less\"","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./widgets.vue?vue&type=style&index=0&id=4049545a&lang=less\""],"sourceRoot":""}